<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.7.1 -->
<title>Héritage corrigé | cours d’informatique</title>
<meta name="generator" content="Jekyll v4.2.0" />
<meta property="og:title" content="Héritage corrigé" />
<meta name="author" content="Célia Châtel" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Support de cours/td d’informatique à l’école centrale marseille." />
<meta property="og:description" content="Support de cours/td d’informatique à l’école centrale marseille." />
<link rel="canonical" href="/cours_informatique/cours/mie/developpement_objet/heritage_corrige.html" />
<meta property="og:url" content="/cours_informatique/cours/mie/developpement_objet/heritage_corrige.html" />
<meta property="og:site_name" content="cours d’informatique" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Héritage corrigé" />
<script type="application/ld+json">
{"description":"Support de cours/td d’informatique à l’école centrale marseille.","@type":"WebPage","url":"/cours_informatique/cours/mie/developpement_objet/heritage_corrige.html","headline":"Héritage corrigé","author":{"@type":"Person","name":"Célia Châtel"},"@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/cours_informatique/assets/main.css"><link type="application/atom+xml" rel="alternate" href="/cours_informatique/feed.xml" title="cours d'informatique" /><!-- Mathjax Support -->
  <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"] ],
        processEscapes: true
      }
    });
  </script>
  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
</head>

<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/cours_informatique/">cours d&#39;informatique</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger">
            <a class="page-link" href="/cours_informatique/about"> about </a>
        </div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post">

  <header class="post-header">
    <h1 class="post-title">Héritage corrigé</h1>Auteurs :
      <ul>
      
        <li><span itemprop="author" itemscope itemtype="http://schema.org/Person"><span class="p-author h-card" itemprop="name">Célia Châtel</span></span></li>
      
        <li><span itemprop="author" itemscope itemtype="http://schema.org/Person"><span class="p-author h-card" itemprop="name">François Brucker</span></span></li>
      
      </ul></p></p>
  </header>

  <div class="post-content">
    <h2 id="but">But</h2>

<p>Éléments de corrigé de la séance  <a href="/cours_informatique/cours/mie/developpement_objet/heritage.html">héritage</a>.</p>

<h2 id="séance-tableau">Séance tableau</h2>

<h3 id="exercice-1">Exercice 1</h3>

<p>L’idée est juste de présenter avec quelque chose de simple et facile à se représenter la notion d’héritage. On donnera l’UML des classes dans tous les cas et le code seulement s’il est lié à l’héritage.</p>

<p>Classe <code class="language-plaintext highlighter-rouge">Point</code> :</p>

<p><img src="img/point.png" alt="point" /></p>

<p>Rien de particulier, pour la classe <code class="language-plaintext highlighter-rouge">Polygon</code> qui est une agrégation avec points :</p>

<p><img src="img/polygon.png" alt="polygon" /></p>

<p>C’est bien une agrégation puisque utilise des objets <code class="language-plaintext highlighter-rouge">Point</code> comme attribut mais ces points existent indépendamment du polygone et on les ajoute dans l’attribut <code class="language-plaintext highlighter-rouge">vertices</code> lors de la création de l’objet.</p>

<p>Classe <code class="language-plaintext highlighter-rouge">Triangle</code>:</p>

<p><img src="img/triangle.png" alt="triangle" /></p>

<p>L’héritage arrive ici. On fait une version restreinte du polygone très simple. La classe <code class="language-plaintext highlighter-rouge">Triangle</code> hérite de <code class="language-plaintext highlighter-rouge">Polygon</code>, on appelle donc le constructeur de ce dernier lors de la création d’un <code class="language-plaintext highlighter-rouge">Triangle</code>.</p>

<p>Ceci est explicite en python :</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">Triangle</span><span class="p">(</span><span class="n">Polygon</span><span class="p">):</span>
  <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">point1</span><span class="p">,</span> <span class="n">point2</span><span class="p">,</span> <span class="n">point3</span><span class="p">):</span>
    <span class="nb">super</span><span class="p">().</span><span class="n">__init__</span><span class="p">([</span><span class="n">point1</span><span class="p">,</span> <span class="n">point2</span><span class="p">,</span> <span class="n">point3</span><span class="p">])</span>
</code></pre></div></div>

<p>Le mot clé <code class="language-plaintext highlighter-rouge">super()</code> désigne la classe parente, ici <code class="language-plaintext highlighter-rouge">Polygon</code>.Ce mot clé permet d’utiliser toutes les méthodes de la classe parente, ici <code class="language-plaintext highlighter-rouge">__init__</code>. Remarquez que l’on utilise la méthode <code class="language-plaintext highlighter-rouge">__init__</code> sans utiliser le premier paramètre (<code class="language-plaintext highlighter-rouge">self</code>) qui est implicitement l’objet courant.</p>

<p>L’UML complet donne donc :</p>

<p><img src="img/polygone_uml_entier.png" alt="polygone_uml_entier" /></p>

<h3 id="exercice-2">Exercice 2</h3>

<p>La classe <code class="language-plaintext highlighter-rouge">Personnage</code> ne pose normalement pas de problèmes :</p>

<p><img src="img/personnage.png" alt="personnage" /></p>

<p>On précise le code de <code class="language-plaintext highlighter-rouge">taper</code> et <code class="language-plaintext highlighter-rouge">se_faire_taper</code> qui permet à chacun de se faire taper comme il l’entend :</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">taper</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">personnage</span><span class="p">):</span>
    <span class="n">personnage</span><span class="p">.</span><span class="n">se_faire_taper</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">se_faire_taper</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">personnage</span><span class="p">):</span>
    <span class="bp">self</span><span class="p">.</span><span class="n">set_vie</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">get_vie</span><span class="p">()</span> <span class="o">-</span> <span class="n">personnage</span><span class="p">.</span><span class="n">get_attaque</span><span class="p">())</span>
</code></pre></div></div>

<p>On ajoute la guerrière :</p>

<p><img src="img/guerriere.png" alt="guerriere" /></p>

<p>On donne ci-après une partie du code de la guerrière  (on a en particulier pas écrit la méthode <code class="language-plaintext highlighter-rouge">bloque</code> qui fait le tirage pour savoir si on bloque ou pas). Faites attention et comprenez bien :</p>

<ul>
  <li>l’appel à <code class="language-plaintext highlighter-rouge">super().__init__()</code> au début du constructeur de la classe fille,</li>
  <li>qu’on ajoute un attribut à la guerrière par rapport au personnage normal,</li>
  <li>la méthode <code class="language-plaintext highlighter-rouge">se_faire_taper(personnage)</code> utilise la méthode <code class="language-plaintext highlighter-rouge">se_faire_taper</code> de la classe <code class="language-plaintext highlighter-rouge">Personnage</code> seulement si la guerrière ne bloque pas le coup. Le <code class="language-plaintext highlighter-rouge">super().methode_de_la_mere()</code> permet d’accéder à la méthode de la classe mère même de même nom qu’une méthode (différente) de la classe fille.</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">Guerriere</span><span class="p">(</span><span class="n">Personnage</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vie</span><span class="p">,</span> <span class="n">attaque</span><span class="p">,</span> <span class="n">blocage</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">().</span><span class="n">__init__</span><span class="p">(</span><span class="n">vie</span><span class="p">,</span> <span class="n">attaque</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">blocage</span> <span class="o">=</span> <span class="n">blocage</span>

    <span class="k">def</span> <span class="nf">se_faire_taper</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">personnage</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="p">.</span><span class="n">bloque</span><span class="p">(</span><span class="n">personnage</span><span class="p">):</span>
            <span class="nb">super</span><span class="p">().</span><span class="n">se_faire_taper</span><span class="p">(</span><span class="n">personnage</span><span class="p">)</span>
</code></pre></div></div>

<p>Prenez le temps de faire des exemples d’utilisation et de vérifier que tous les cas marchent. En particulier qu’est-ce qui est appelé quand on fait <code class="language-plaintext highlighter-rouge">guerriere.se_faire_taper(bonhomme)</code> avec un objet <code class="language-plaintext highlighter-rouge">guerriere</code> de la classe <code class="language-plaintext highlighter-rouge">Guerriere</code> ?</p>

<p>Le magicien permet de montrer l’ajout d’une méthode qui n’était pas du tout dans la classe mère :</p>

<p><img src="img/magicien.png" alt="magicien" /></p>

<p>Le code n’est pas difficile, on se passera donc de l’écrire complètement. Il faut :</p>

<ul>
  <li>ajouter une méthode <code class="language-plaintext highlighter-rouge">lancer_sort</code></li>
  <li>ajouter un paramètre et son attribut associé <code class="language-plaintext highlighter-rouge">attaque_magique</code> au constructeur</li>
  <li>ajouter une méthode <code class="language-plaintext highlighter-rouge">se_faire_toucher_par_un_sort(magicien)</code> avec un paramètre de type Magicien dans la classe Personnage.</li>
</ul>

<blockquote>
  <p><strong>Nota Bene :</strong> Ces exemples sur l’héritage sont un peu forcés. C’est parce que l’héritage n’est que très peu utilisé en code pure. Il est même considéré comme préjudiciable dans la plupart des cas (voir )<a href="https://codeburst.io/inheritance-is-evil-stop-using-it-6c4f1caf5117">là</a> ou encore <a href="http://neethack.com/2017/04/Why-inheritance-is-bad/">là</a>).</p>
  <blockquote>
    <p>Un cas d’utilisation reconnu est cependant lorsque l’on veut utiliser des classes définies dans un module quelconque et la mettre un peu à notre sauce. Comme dans des bibliothèques graphiques par exemple.</p>
  </blockquote>
</blockquote>

<h2 id="séance-code">séance code</h2>

<h3 id="les-bases-de-lhéritage">Les bases de l’héritage</h3>

<p>N’oubliez pas l’appel du <code class="language-plaintext highlighter-rouge">super().__init__()</code>. Si vous avez du mal à comprendre le code, n’hésitez pas à revenir aux <em>namespaces</em>.</p>

<h3 id="statdice">StatDice</h3>

<p>On réécrit uniquement la fonction <code class="language-plaintext highlighter-rouge">set_position</code> car on l’utilise dans le <code class="language-plaintext highlighter-rouge">roll</code> de <code class="language-plaintext highlighter-rouge">Dice</code> du corrigé des dés. Faites attention et comprenez 
le <code class="language-plaintext highlighter-rouge">super().set_position(new_position)</code> qui  permet de réutiliser les choses écrites dans la classe mère même si on définit une méthode du même nom.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">StatDice</span><span class="p">(</span><span class="n">Dice</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">().</span><span class="n">__init__</span><span class="p">(</span><span class="n">position</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">memory</span> <span class="o">=</span> <span class="p">{</span><span class="n">value</span><span class="p">:</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="p">.</span><span class="n">NUMBER_FACES</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)}</span>

    <span class="k">def</span> <span class="nf">get_memory</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="p">.</span><span class="n">memory</span>

    <span class="k">def</span> <span class="nf">set_position</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_position</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">().</span><span class="n">set_position</span><span class="p">(</span><span class="n">new_position</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">memory</span><span class="p">[</span><span class="n">new_position</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="k">def</span> <span class="nf">stats</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">n_roll</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">memory</span><span class="p">.</span><span class="n">values</span><span class="p">())</span>
        <span class="k">return</span> <span class="p">{</span><span class="n">value</span><span class="p">:</span> <span class="bp">self</span><span class="p">.</span><span class="n">memory</span><span class="p">[</span><span class="n">value</span><span class="p">]</span> <span class="o">/</span> <span class="n">n_roll</span> <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">.</span><span class="n">memory</span><span class="p">}</span>

    <span class="k">def</span> <span class="nf">mean</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">n_roll</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">memory</span><span class="p">.</span><span class="n">values</span><span class="p">())</span>
        <span class="k">return</span> <span class="nb">sum</span><span class="p">(</span><span class="n">value</span> <span class="o">*</span> <span class="bp">self</span><span class="p">.</span><span class="n">memory</span><span class="p">[</span><span class="n">value</span><span class="p">]</span> <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">.</span><span class="n">memory</span><span class="p">)</span> <span class="o">/</span> <span class="n">n_roll</span>
</code></pre></div></div>

<h2 id="plantuml">PlantUML</h2>

<p>Pour https://www.planttext.com/</p>

<pre><code class="language-uml">@startuml

class Point { 
    ___attributes
    - x: float
    - y: float
    
    __methods__
    
    +__init__(float, float)
    +get_x(): float
    +set_x(float)
    +get_y(): float
    +set_y(float)
    +distance(Point): float
}


class Polygon { 
  __attributes__
  - vertices: list of Point

  __methods__

  +__init__(list of Point)
  +area(): float
  +perimeter(): float
}


class Triangle { 
    __methods__
    + __init__(Point, Point, Point)
}

Polygon &lt;|-- Triangle
Polygon o-- Point

@enduml

@startuml

class Personnage { 
    ___attributes__
    - vie: int
    - attaque: int
    
    __methods__
    
    +__init__(vie, attaque)
    +get_vie(): int
    +set_vie(int)
    +get_attaque(): int
    +set_attaque(int)
    +taper(Personnage)
    +se_faire_taper(Personnage)
}

class Guerriere { 
  __attributes__
  - blocage: int

  __methods__

  +__init__(vie, attaque, blocage)
  +se_faire_taper(Personage)
}

class Magicien {
    __attributes__
  - attaque_magique: int

  __methods__

  +__init__(vie, attaque, attaque_magique)
  +lancer_sort()
}

Personnage &lt;|-- Guerriere
Personnage &lt;|-- Magicien
@enduml
</code></pre>


  </div>

</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/cours_informatique/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">cours d&#39;informatique</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">cours d&#39;informatique</li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/FrancoisBrucker"><svg class="svg-icon"><use xlink:href="/cours_informatique/assets/minima-social-icons.svg#github"></use></svg> <span class="username">FrancoisBrucker</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>Support de cours/td d&#39;informatique à l&#39;école centrale marseille.</p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
