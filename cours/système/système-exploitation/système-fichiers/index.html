<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Système de fichiers</title>

    <link href="/cours_informatique/assets/node_modules/prismjs/themes/prism-solarizedlight.min.css" rel="stylesheet">
    <link href="/cours_informatique/assets/node_modules/prismjs/plugins/line-numbers/prism-line-numbers.min.css" rel="stylesheet">

    <link href="/cours_informatique/assets/stylesheets/main.css" rel="stylesheet">

  </head>
  <body>
    <script>
      window.MathJax = {
        tex: {
          inlineMath: [
            [
              '$', '$'
            ],
            [
              '\\(', '\\)'
            ]
          ]
        },
        svg: {
          fontCache: 'global'
        }
      };

      function goTop() {
        window.scrollTo({top: 0});
      }
      function goBottom() {
        window.scrollTo({top: document.body.scrollHeight});
      }
    </script>
    <script type="text/javascript" id="MathJax-script" src="/cours_informatique/assets/node_modules/mathjax/es5/tex-svg-full.js"></script>

    <header class="border-b-2 border-gray-200 mb-4">
      <div class="max-w-[1200px] mx-auto px-4 relative">
        <div class="min-h-[50px] flex justify-between items-center">
          <a class="mx-2" href="/cours_informatique/">Home</a>
        </div>

        <div class="min-h-[50px] flex justify-center items-center absolute right-0 top-0">
          <a class="mx-2" href="/cours_informatique/about">About</a>
          <button onclick="goTop()" id="myBtn" title="Go to top">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
              <path stroke-linecap="round" stroke-linejoin="round" d="M15 11.25l-3-3m0 0l-3 3m3-3v7.5M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
            </svg>
          </button>

          <button onclick="goBottom()" id="myBtn" title="Go to top">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
              <path stroke-linecap="round" stroke-linejoin="round" d="M9 12.75l3 3m0 0l3-3m-3 3v-7.5M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
            </svg>
          </button>
        </div>

      </div>
    </header>

    <main class="max-w-[1200px] mx-auto px-4">
      
<article>

  <h1>Système de fichiers</h1>
  <div>
    

    
  </div>

  

    
<div class="quote relative  py-2 drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-purple-500 bg-purple-100">
<svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 text-purple-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
  <path stroke-linecap="round" stroke-linejoin="round" d="M5 19a2 2 0 01-2-2V7a2 2 0 012-2h4l2 2h4a2 2 0 012 2v1M5 19h14a2 2 0 002-2v-5a2 2 0 00-2-2H9a2 2 0 00-2 2v5a2 2 0 01-2 2z"></path>
</svg>
<div class="pl-8 mr-8">

<a class="interne" href="/cours_informatique/cours/">Cours</a><span class="px-1">/</span><a class="interne" href="/cours_informatique/cours/système/">Système</a><span class="px-1">/</span><a class="interne" href="/cours_informatique/cours/système/système-exploitation/">Système d&#39;exploitation</a><span class="px-1">/</span><a class="interne" href="/cours_informatique/cours/système/système-exploitation/système-fichiers/">Système de fichiers</a>

</div>
</div>


    
  

  <blockquote>
<p>TBD : en super chantier.</p>
</blockquote>
<blockquote>
<p>Plan de <a href="https://www.youtube.com/watch?v=jpKpbyYjAWU&amp;list=PL2Yggtk_pK6-R9ehjj0AoTnWrNOLChuld&amp;index=66">https://www.youtube.com/watch?v=jpKpbyYjAWU&amp;list=PL2Yggtk_pK6-R9ehjj0AoTnWrNOLChuld&amp;index=66</a></p>
</blockquote>
<ul>
<li>fichier = ensemble de byte sur le disque dur</li>
<li>le système ajoute des métas data :
<ul>
<li>nom</li>
<li>propriétaire</li>
<li>son groupe</li>
<li>permissions</li>
<li>dernière fois que le fichier a été ouvert</li>
<li>...</li>
<li>extension :
<ul>
<li>(attention, c'est juste une convention Ca n'a aucune incidence sur le fichier en lui-même. Ca permet juste à l'OS de chercher des applications par défaut à exécuter. Mais rien ne vous empêche d'appeler vos images <code>mon_image.py</code>, ça ne la transformera pas par magie un fichier python)</li>
<li>pour les fichiers qui ne sont pas du texte, le créateur du format va ajouter une <a href="https://en.wikipedia.org/wiki/List_of_file_signatures">signature</a> en début de fichier (on appelle ça des <em>magic number</em>) pour caractériser son format. C'est encore une fois une convention, seule la négative est assurée (si cela ne commence pas par les 5 bytes <code>25 50 44 46 2D</code> c'est sur que ce n'est pas un fichier pdf)</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>lien : faire ça après les inodes</p>
<ul>
<li>symbolique</li>
<li>physique</li>
</ul>
<p>Un système de fichier est organisée en arbre :</p>
<ul>
<li>fichiers sont les feuilles</li>
<li>les nœuds internes sont des dossiers : les enfants d'un nœud interne ont tous des noms différents</li>
<li>un nœud interne a toujours au moins deux enfants :
<ul>
<li>lui-même (.)</li>
<li>son parent (..) (le parent est lui-même pour la racine)</li>
</ul>
</li>
</ul>
<p>Cette structure permet de voyager dans tout l'arbre en descendant les enfant ou en remontant les parent et ce de la même manière (avec ..)</p>
<p>Opérations que l'on peut faire sur les fichiers, selon les permissions :</p>
<ul>
<li>créer / supprimer : dépend des droits du dossier parent</li>
<li>ouvrir / fermer / seek</li>
<li>lire en seek</li>
<li>écrire (remplacer) / append (écrit à la fin)</li>
<li>changer des méta-datas</li>
</ul>
<p>Opérations que l'on peut faire sur les dossiers, selon les permissions :</p>
<ul>
<li>créer / supprimer : dépend des droits du dossier parent</li>
<li>ouvrir / fermer</li>
<li>lire</li>
<li>changer des méta-datas</li>
</ul>
<p>Le système doit connaître tous les fichiers utilisés. C'est une liste où chaque entrée est un <a href="https://en.wikipedia.org/wiki/File_descriptor">descripteur de fichier</a> qui contient :</p>
<ul>
<li>quel fichier est concerné</li>
<li>type d'accès lecture, écriture, etc.</li>
<li>le nombre de threads qui utilisent cette entrée</li>
<li>la position dans le fichier</li>
</ul>
<p>Un même fichier peut apparaître plusieurs fois, mais si c'est deux accès en écriture, ou un accès en lecture et un autre en écriture, il peut se passer des choses bizarres. Ouvrir un fichier en écriture commençant par créer un nouveau fichier.</p>
<p>Plusieurs thread peuvent se partager la même entrée.</p>
<p>Le disque est séparé en bloc (pages) de taille 8 KiB, un fichier est une liste chaînée de ces blocs.</p>
<p>Taille min d'un fichier = 1 bloc logique</p>
<p>Il faut avoir sur le disque dur à la fois les fichiers, leurs méta-data et l'organisations (dossier/ fichier, mais aussi la liste chaînée des blocs de chaque fichier).</p>
<p>On réserve des blocs pour la gestions et d'autres pour le contenu de chaque fichier.</p>
<p>On a une table de taille le nombre de bloc et chaque entrée possède le bloc suivant dans le fichier.</p>
<p>Une fois qu'on a le premier bloc d'un fichier, on a les suivants. On a un disque dur de 8 blocs (codé sur 3b).</p>
<p>Si on sait que le fichier commence en 4, on connaît ses 3 blocs.</p>
<pre><code>0 :
1 :  X       ; avec un flag
2 :
3 :
4 :  7
5 :
6 :
7 :  1
</code></pre>
<p>Cette liste est un bloc (opu plusieurs blocs) du disque dur. Que l'on peut garder en mémoire, ce qui rend les accès plus rapide.</p>
<p>Ex :</p>
<ul>
<li>disque dur de 1 TiB</li>
<li>taille d'un bloc 8 KiB</li>
<li>il y a : $2^{40} / ( 8 \cdot 2^{10}) = 137438953472$ pages</li>
<li>il faut 37b pour encoder les nombres allant de 0 à 137438953472</li>
<li>la taille de la table vaut $37 \cdot 137438953472 = 600 GiB$</li>
</ul>
<blockquote>
<p>TBD : semble beaucoup de trop.</p>
</blockquote>
<p><a href="https://ext4.wiki.kernel.org/index.php/Ext4_Disk_Layout">https://ext4.wiki.kernel.org/index.php/Ext4_Disk_Layout</a></p>
<blockquote>
<p>logique. Physique = 512B ?</p>
</blockquote>
<p><a href="https://tldp.org/LDP/sag/html/filesystems.html">https://tldp.org/LDP/sag/html/filesystems.html</a></p>
<p>un fichier peut être un dossier ou un vra<br>
i fichier</p>
<p>Fichiers et liens :</p>
<ul>
<li>fichier sur le disque dur</li>
<li>lien est un</li>
</ul>
<blockquote>
<p>TBD disque dur/ partitions<br>
notion de fichier, et de système de fichier (avec table)<br>
il y en a plein.</p>
</blockquote>
<blockquote>
<p>TBD disque dur/ partitions<br>
notion de fichier, et de système de fichier (avec table)<br>
il y en a plein.</p>
</blockquote>
<blockquote>
<p>TBD : Disques dur, USB<br>
TBD : Formatage et accès. Tout un tas (FAT, NTFS windows, zfs, btrfs)...<br>
copy on write<br>
journalisé<br>
partitions</p>
<p><a href="https://wiki.debian.org/ZFS">https://wiki.debian.org/ZFS</a><br>
<a href="https://ext4.wiki.kernel.org/index.php/Ext4_Disk_Layout">https://ext4.wiki.kernel.org/index.php/Ext4_Disk_Layout</a></p>
<p><a href="https://blogs.oracle.com/linux/post/understanding-ext4-disk-layout-part-1">https://blogs.oracle.com/linux/post/understanding-ext4-disk-layout-part-1</a></p>
<p>zfs : <a href="https://opensolaris-discuss.opensolaris.narkive.com/86NkhwTm/inode-numbers-on-zfs">https://opensolaris-discuss.opensolaris.narkive.com/86NkhwTm/inode-numbers-on-zfs</a> ?</p>
</blockquote>
<p><a href="https://medium.com/@boutnaru/linux-what-is-an-inode-7ba47a519940">https://medium.com/@boutnaru/linux-what-is-an-inode-7ba47a519940</a></p>
<p><a href="https://tldp.org/LDP/tlk/fs/filesystem.html">https://tldp.org/LDP/tlk/fs/filesystem.html</a><br>
diff entre ext2, 3 et 4 : <a href="https://www.easeus.fr/partition-manager-tips/systeme-de-fichiers-ext2-ext3-ext4.html">https://www.easeus.fr/partition-manager-tips/systeme-de-fichiers-ext2-ext3-ext4.html</a></p>


</article>
    </main>

    <footer class="min-h-[50px] border-t-2 border-gray-200 mt-4">
      <div class="max-w-[1200px] mx-auto px-4 relative">
        <div class="min-h-[50px] flex justify-center items-center">
          <p>
            Cours d'informatique à l'école centrale Marseille
          </p>
        </div>
        <div class="min-h-[50px] flex justify-center items-center absolute right-0 top-0">
          <button onclick="goTop()" id="myBtn" title="Go to top">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
              <path stroke-linecap="round" stroke-linejoin="round" d="M15 11.25l-3-3m0 0l-3 3m3-3v7.5M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
            </svg>
          </button>

          <button onclick="goBottom()" id="myBtn" title="Go to top">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
              <path stroke-linecap="round" stroke-linejoin="round" d="M9 12.75l3 3m0 0l3-3m-3 3v-7.5M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
            </svg>
          </button>
        </div>

      </div>
    </footer>

    <script>
      MathJax
        .startup
        .document
        .getMathItemsWithin(document.body);
    </script>

  </body>
</html>