<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Fichiers</title>

    <link href="/cours_informatique/assets/node_modules/prismjs/themes/prism-solarizedlight.min.css" rel="stylesheet">
    <link href="/cours_informatique/assets/node_modules/prismjs/plugins/line-numbers/prism-line-numbers.min.css" rel="stylesheet">

    <link href="/cours_informatique/assets/stylesheets/main.css" rel="stylesheet">

  </head>
  <body>
    <script>
      window.MathJax = {
        tex: {
          inlineMath: [
            [
              '$', '$'
            ],
            [
              '\\(', '\\)'
            ]
          ]
        },
        svg: {
          fontCache: 'global'
        }
      };

      function goTop() {
        window.scrollTo({top: 0});
      }
      function goBottom() {
        window.scrollTo({top: document.body.scrollHeight});
      }
    </script>
    <script type="text/javascript" id="MathJax-script" src="/cours_informatique/assets/node_modules/mathjax/es5/tex-svg-full.js"></script>

    <header class="border-b-2 border-gray-200 mb-4">
      <div class="max-w-[1200px] mx-auto px-4 relative">
        <div class="min-h-[50px] flex justify-between items-center">
          <a class="mx-2" href="/cours_informatique/">Home</a>
        </div>

        <div class="min-h-[50px] flex justify-center items-center absolute right-0 top-0">
          <a class="mx-2" href="/cours_informatique/about">About</a>
          <button onclick="goTop()" id="myBtn" title="Go to top">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
              <path stroke-linecap="round" stroke-linejoin="round" d="M15 11.25l-3-3m0 0l-3 3m3-3v7.5M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
            </svg>
          </button>

          <button onclick="goBottom()" id="myBtn" title="Go to top">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
              <path stroke-linecap="round" stroke-linejoin="round" d="M9 12.75l3 3m0 0l3-3m-3 3v-7.5M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
            </svg>
          </button>
        </div>

      </div>
    </header>

    <main class="max-w-[1200px] mx-auto px-4">
      
<article>

  <h1>Fichiers</h1>
  <div>
    

    
  </div>

  

    
<div class="quote relative  py-2 drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-purple-500 bg-purple-100">
<svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 text-purple-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
  <path stroke-linecap="round" stroke-linejoin="round" d="M5 19a2 2 0 01-2-2V7a2 2 0 012-2h4l2 2h4a2 2 0 012 2v1M5 19h14a2 2 0 002-2v-5a2 2 0 00-2-2H9a2 2 0 00-2 2v5a2 2 0 01-2 2z"></path>
</svg>
<div class="pl-8 mr-8">

<a href="/cours_informatique/cours/">Cours</a><span class="px-1">/</span><a href="/cours_informatique/cours/algorithme-code-théorie/">Algorithme, code et théorie</a><span class="px-1">/</span><a href="/cours_informatique/cours/algorithme-code-théorie/code/">Code</a><span class="px-1">/</span><a href="/cours_informatique/cours/algorithme-code-théorie/code/fichiers/">Fichiers</a>

</div>
</div>

  

  
    
<div class="quote relative  py-2 drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-pink-500 bg-pink-100">
<svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 text-pink-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
  <path stroke-linecap="round" stroke-linejoin="round" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"></path>
</svg>
<div class="pl-8  mb-2 mr-8">

<b>Prérequis :</b>

</div><div class="pl-8 mr-8">


    <ul>
            
            <li>
              <a href="/cours_informatique/cours/algorithme-code-théorie/algorithme/structure-chaîne-de-caractères/">Structure : chaîne de caractères</a>
            </li>
            
            <li>
              <a href="/cours_informatique/tutoriels/fichiers-navigation/">Naviguer dans un système de fichiers</a>
            </li>
            
            <li>
              <a href="/cours_informatique/cours/algorithme-code-théorie/algorithme/structure-dictionnaire/">Structure : dictionnaire</a>
            </li></ul>
    

</div>
</div>

  

  <!-- début résumé -->
<p>Stocker des données est une préoccupation depuis les origines de l'informatique : d'abord sur cartes perforée, puis sur bandes magnétiques et jusqu'aux disques durs et clés actuelles. Un <a href="https://fr.wikipedia.org/wiki/Fichier_informatique">fichier</a> est ainsi un ensemble de données que l'on peut lire ou écrire pour le sauvegarder. Nous n'entrerons cependant pas dans les détails des <a href="https://fr.wikipedia.org/wiki/Syst%C3%A8me_de_fichiers">systèmes de fichiers</a> (comment sont effectivement stockés les fichiers sur le disque dur), car c'est une affaire (très) compliquée. Nous n'aborderons que le strict nécessaire pour les manipuler en python.</p>
<!-- end résumé -->
<p>Toutes les manipulations spécifiques des fichiers (buffer, impossibilité de modifier, etc) sont issues des origines de l'informatique où stocker et charger des données était une chose compliquée <em>physiquement</em> (voir par exemple le <a href="https://youtu.be/HQyckYYT3_8?t=1120">chargement d'un programme depuis une cassette sur un TO7</a> qui prenait plus d'un quart d'heure... Et c'est du vécu, le TO7 a été ma première machine)</p>
<h2>Système de fichiers</h2>
<p>Un fichier est constitué d'une suite de blocs sur le disque dur, chaque bloc ayant une adresse contenant le bloc suivant. C'est une <a href="https://fr.wikipedia.org/wiki/Liste_cha%C3%AEn%C3%A9e">liste chaînée</a> de tableaux de même taille contenant les données (des octets).</p>
<p>Ce format a été choisi parce que :</p>
<ul>
<li>des fichiers de tailles différentes doivent pouvoir être ajoutés et supprimés du disque dur. La place y est donc <a href="https://fr.wikipedia.org/wiki/D%C3%A9fragmentation_(informatique)">fragmentée</a>, et il n'est pas sûr de pouvoir avoir la taille requise pour un fichier.</li>
<li>on doit pouvoir ajouter des choses à un fichier sans avoir à tout re-écrire</li>
</ul>
<p>Les limitations sont donc :</p>
<ul>
<li>on accède au fichier petit à petit. Il faut une <em>tête de lecture</em> qui voyage de bloc en bloc.</li>
<li>il est impossible d'insérer des choses dans un fichier. On peut juste ajouter des éléments à la fin de celui-ci.</li>
<li>le système de fichier dépend du système d'exploitation.</li>
<li>écrire/lire sur un disque est coûteux en temps. Il est nécessaire d'avoir une <a href="https://fr.wikipedia.org/wiki/M%C3%A9moire_tampon">mémoire tampon</a> ce qui rend asynchrone la lecture et l'écriture d'un fichier.</li>
</ul>
<div class="quote relative drop-shadow  py-2 pr-2 rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-amber-800 bg-amber-100">
<svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 text-amber-800" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
  <path stroke-linecap="round" stroke-linejoin="round" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
</svg>
<div class="pl-8 mr-8">
<p>Ce qu'on peut faire avec un fichier :</p>
<ul>
<li><strong>ouvrir</strong> le fichier : c'est se préparer à l'utiliser. Cette étape  crée un <em>buffer</em> (mémoire tampon), un pointeur de bloc, une tête de lecture, etc.</li>
<li><strong>fermer</strong> un fichier : arrêter de s'en servir. Il est <strong>indispensable</strong> de toujours fermer un fichier après s'en être servi. On écrit en effet à cette étape les dernières instruction non encore passées du <em>buffer</em> au disque dur (c'est comme démonter une clé USB proprement).</li>
<li><strong>lire</strong> un fichier : on fait avancer la <em>tête de lecture</em> du fichier, d'une ligne ou d'un nombre donné d'octets</li>
<li><strong>écrire</strong> un fichier : on ajoute des données à la fin d'un fichier (qui peut être initialement vide). Souvent on écrit pas tout de suite sur le disque dur, on attend d'avoir un nombre suffisant de données dans la mémoire tampon.</li>
</ul>
</div>
</div>
<p>Au niveau de l'ordinateur, utiliser un fichier, c'est compliqué.</p>
<h3>Types de fichiers</h3>
<p>On a coutume de séparer les fichiers en deux grandes familles : les <a href="https://fr.wikipedia.org/wiki/Fichier_texte">fichiers texte</a> et les <a href="https://fr.wikipedia.org/wiki/Fichier_binaire">fichiers binaires</a>. Cette séparation, essentiellement historique, est un peu artificielle mais vous trouverez encore souvent cette distinction :</p>
<ul>
<li>Les fichiers binaires sont les plus nombreux puisque c'est presque tous les fichiers : les images, vidéos, programmes, etc. Il faut un  outil spécial pour les utiliser, c'est à dire un moyen de passer de l'octet à sa signification. On peut aider l'utilisateur en mettant une extension à son nom correspondant au type de fichier, mais ce n'est pas obligatoire.</li>
<li>Les fichiers textes sont eux aussi constitués de nombres (un ordinateur ne connaît que ça), mais on peut leur faire correspondre des caractères via un code (voir partie format).</li>
</ul>
<p>Passer des octets à leurs significations pour un fichier se fait via un <a href="https://fr.wikipedia.org/wiki/Codec">codec</a> (codeur/décodeur). Il y en a pour les fichiers binaire codec MPEG4 par exemple, mais aussi pour les fichiers texte même si dans ce cas là on parlera plutôt d'encodage (comme utf-8).</p>
<h3>Voir un fichier</h3>
<p>Savoir comment interpréter les données d'un fichier n'est pas une chose facile. L'<a href="https://fr.wikipedia.org/wiki/Extension_de_nom_de_fichier">extension</a> permet au système d'exploitation d'associer une application spécifique (un visualiseur d'image si le fichier fini par <em>&quot;.jpg&quot;</em> par exemple). Mais ce n'est qu'une indication. Un fichier python ne se transforme pas par magie en image si on ajoute une extension <em>&quot;.jpg&quot;</em> au fichier...</p>
<div class="quote relative drop-shadow  py-2 pr-2 rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-amber-800 bg-amber-100">
<svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 text-amber-800" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
  <path stroke-linecap="round" stroke-linejoin="round" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
</svg>
<div class="pl-8 mr-8">
<p>Utilisez <strong>toujours</strong> une extension à vos fichiers. Cela permet de gagner beaucoup de temps pour ouvrir directement la bonne application pour lire votre fichier.</p>
</div>
</div>
<p>Sans extension ou sans idée de ce que contient un fichier, ce n'est qu'une suite d'octets. Pour s'en rendre compte :</p>
<div class="quote relative  py-2 drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-yellow-500 bg-yellow-100">
<svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 text-yellow-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
  <path stroke-linecap="round" stroke-linejoin="round" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"></path>
  <path stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
</svg>
<div class="pl-8 mr-8">
<p>Installez l'extension <a href="https://marketplace.visualstudio.com/items?itemName=ms-vscode.hexeditor">Hex Editor</a> pour vscode.</p>
<p>Vous pourrez la trouver dans le menu <em>menu Affichage &gt; extension</em> puis recherchez <strong>Hex Editor</strong> dans la barre de recherche pour l'installer.</p>
</div>
</div>
<p>Cette extension permet d'ouvrir tout fichier comme la suite d'octet qu'il est réellement. Pour cela :</p>
<div class="quote relative  py-2 drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-yellow-500 bg-yellow-100">
<svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 text-yellow-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
  <path stroke-linecap="round" stroke-linejoin="round" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"></path>
  <path stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
</svg>
<div class="pl-8 mr-8">
<ol>
<li>ouvrez une nouvelle fenêtre avec vscode : <em>menu Fichier &gt; nouvelle fenêtre</em></li>
<li>dans cette nouvelle fenêtre : <em>menu Affichage &gt; explorateur</em> puis cliquez sur <em>open folder</em> pour choisir un dossier contenant des images, des pdf et d'autres types de de fichiers (souvent le dossier téléchargement est un bon candidat)</li>
<li>cliquez droit sur un fichier et choisissez <em>ouvrir avec...</em><br>
<img src="fichiers-ouvrir-avec.png" alt="ouvrir avec"></li>
<li>choisissez &quot;Hex editor&quot;<br>
<img src="fichiers-hex-editor.png" alt="hex editor"></li>
<li>on obtient quelque chose en 3 parties : les octets, l'interprétation ascii de chaque octet et des informations ;<br>
<img src="fichiers-panel.png" alt="panel"></li>
</ol>
</div>
</div>
<p>Certains type de fichiers sont reconnaissables par leurs premiers octets. On appelle ça des <a href="https://en.wikipedia.org/wiki/List_of_file_signatures"><em>magic number</em> ou des <em>signatures</em></a>. Si vous ouvrez un fichier pdf par exemple, vous remarquerez qu'il commence par les caractères ASCII : <code>%PDF-</code>. Mais ce n'est pas la norme. Donc pour vous éviter des soucis, pensez à bien bien les extensions de fichier pour aider votre système d'exploitation à trouver la bonne application à ouvrir.</p>
<h2>Python</h2>
<div class="quote relative  py-2 drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-yellow-500 bg-yellow-100">
<svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 text-yellow-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
  <path stroke-linecap="round" stroke-linejoin="round" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"></path>
  <path stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
</svg>
<div class="pl-8 mr-8">
<p>Lisez la doc : <a href="https://docs.python.org/fr/3/tutorial/inputoutput.html#reading-and-writing-files">https://docs.python.org/fr/3/tutorial/inputoutput.html#reading-and-writing-files</a></p>
</div>
</div>
<p>En python, on utilise les fichiers <em>via</em> un objet <code>file</code>. On manipule les fichiers en 3 temps :</p>
<ol>
<li>
<p>ouverture : <code>f = open(&quot;mon_fichier.txt&quot;, &quot;r&quot;)</code><br>
Ces objets sont créés par la commande <a href="https://docs.python.org/fr/3/library/functions.html#open"><code>open</code></a> qui ouvre un fichier. Elle a deux paramètres obligatoires :</p>
<ul>
<li>le nom du fichier,</li>
<li>la façon dont on veut l'ouvrir :
<ul>
<li><code>'r'</code> : en lecture. La tête de lecture est placée au début du fichier</li>
<li><code>'w'</code> : en écriture. La tête d'écriture est placée au début du fichier. Donc <strong>si le fichier contenait déjà des choses elles sont supprimées</strong></li>
<li><code>'a'</code> : en écriture à la fin du fichier. La tête d'écriture est placée à la fin du fichier. Donc si le fichier contenait déjà des choses elles ne sont <strong>pas</strong> supprimées</li>
</ul>
</li>
</ul>
<p>Par défaut, les fichiers sont considérés comme étant du texte écrit en <a href="../../algorithme/structure-cha%C3%AEne-de-caract%C3%A8res#utf8">utf-8</a>. Si vous voulez ouvrir/écrire un fichier binaire, il faut ajouter <code>'b'</code> au paramètre. Par exemple : <code>f = open(&quot;mon_image.jpg&quot;, &quot;br&quot;)</code> ouvre un fichier binaire en lecture.</p>
</li>
<li>
<p>On manipule ensuite le fichier grâce aux méthodes de la classe <code>file</code> :</p>
<ul>
<li>en lecture avec les méthodes :
<ul>
<li><code>read</code>: <code>texte = f.read()</code> qui lit tout le fichier sous la forme d'une chaîne de caractères</li>
<li><code>readline</code> qui lit la ligne suivante d'un fichier</li>
</ul>
</li>
<li>en écriture avec <code>write</code> :</li>
</ul>
</li>
<li>
<p>enfin, on ferme le fichier : <code>f.close()</code></p>
</li>
</ol>
<div class="quote relative py-2 drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-red-500 bg-red-100">
<svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 text-red-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
  <path stroke-linecap="round" stroke-linejoin="round" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path>
</svg>
<div class="pl-8 mr-8">
<p>Si vous ouvrez un fichier en écriture alors qu'il existait déjà, son contenu <strong>disparaît immédiatement et pour toujours</strong>. Il n'y a aucun moyen de récupérer son contenu.</p>
</div>
</div>
<h3>Exemple</h3>
<div class="quote relative  py-2 drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-yellow-500 bg-yellow-100">
<svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 text-yellow-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
  <path stroke-linecap="round" stroke-linejoin="round" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"></path>
  <path stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
</svg>
<div class="pl-8 mr-8">
<p>Créez un fichier texte que vous nommerez <em>&quot;haiku.txt&quot;</em> et qui contient :</p>
<pre class="language-text " style="counter-reset: linenumber 0"><code class="language-text">dans le vieil étang,
une grenouille saute,
un ploc dans l'eau.

Bashô.
</code></pre>
</div>
</div>
<h4>Lecture du fichier en entier</h4>
<div class="quote relative  py-2 drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-yellow-500 bg-yellow-100">
<svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 text-yellow-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
  <path stroke-linecap="round" stroke-linejoin="round" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"></path>
  <path stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
</svg>
<div class="pl-8 mr-8">
<p>Exécutez le code suivant pour lire le fichier qui doit être dans le même dossier que votre fichier python :</p>
</div>
</div>
<pre class="language-python " style="counter-reset: linenumber 0"><code class="language-python">f <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"haiku.txt"</span><span class="token punctuation">,</span> <span class="token string">"r"</span><span class="token punctuation">)</span>  <span class="token comment"># ouverture d'un fichier texte en lecture  dans le même dossier que le fichier python</span>
poeme <span class="token operator">=</span> f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>
f<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>poeme<span class="token punctuation">)</span>
</code></pre>
<div class="quote relative  py-2 drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-cyan-500 bg-cyan-100">
<svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 text-cyan-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
  <path stroke-linecap="round" stroke-linejoin="round" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"></path>
</svg>
<div class="pl-8 mr-8">
<p>Ne confondez pas le nom du fichier et son contenu. Le nom du fichier, ici <em>&quot;haiku.txt&quot;</em>, nous permet de l'ouvrir en lecture grâce à la commande <code>open</code>. Son contenu est ensuite mis dans la variable <code>poeme</code> grâce à la méthode <code>read</code>.</p>
</div>
</div>
<h4>Lecture ligne à ligne</h4>
<div class="quote relative  py-2 drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-yellow-500 bg-yellow-100">
<svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 text-yellow-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
  <path stroke-linecap="round" stroke-linejoin="round" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"></path>
  <path stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
</svg>
<div class="pl-8 mr-8">
<blockquote>
<p>Exécutez le code suivant pour lire le fichier ligne à ligne :</p>
</blockquote>
</div>
</div>
<pre class="language-python " style="counter-reset: linenumber 0"><code class="language-python">f <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"haiku.txt"</span><span class="token punctuation">,</span> <span class="token string">"r"</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> ligne <span class="token keyword">in</span> f<span class="token punctuation">:</span>  <span class="token comment"># boucle sur les lignes</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>ligne<span class="token punctuation">)</span>
f<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
<div class="quote relative  py-2 drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-cyan-500 bg-cyan-100">
<svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 text-cyan-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
  <path stroke-linecap="round" stroke-linejoin="round" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"></path>
</svg>
<div class="pl-8 mr-8">
<p>Notez la ligne vide vide entre deux affichages. Ceci est du au fait que chaque ligne du fichier contient déjà un retour à la ligne. Plus celui qui est ajouté automatiquement à la fin de l'instruction <code>python</code>.</p>
</div>
</div>
<h4>Ajout au fichier</h4>
<div class="quote relative  py-2 drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-yellow-500 bg-yellow-100">
<svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 text-yellow-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
  <path stroke-linecap="round" stroke-linejoin="round" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"></path>
  <path stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
</svg>
<div class="pl-8 mr-8">
<p>Exécutez le code suivant pour ajouter quelque chose à la fin d'un fichier :</p>
</div>
</div>
<pre class="language-python " style="counter-reset: linenumber 0"><code class="language-python">f <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"haiku.txt"</span><span class="token punctuation">,</span> <span class="token string">"a"</span><span class="token punctuation">)</span>
f<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">)</span>
f<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">"1644-1694"</span><span class="token punctuation">)</span>
f<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
<p>On ajoute un retour à la ligne, puis les dates de naissance et de mort de Bashô.</p>
<p>Notez qu'aller à la ligne est un caractère comme un autre (il s'écrit <code>\n</code> et vaut U+0010). Il fait parti des <a href="https://fr.wikipedia.org/wiki/Caract%C3%A8re_de_contr%C3%B4le">caractères de contrôles</a> comme la tabulation ou le bip (essayez par exemple <code>print(chr(0x7))</code>).</p>
<h4>Écriture du fichier</h4>
<div class="quote relative  py-2 drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-yellow-500 bg-yellow-100">
<svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 text-yellow-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
  <path stroke-linecap="round" stroke-linejoin="round" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"></path>
  <path stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
</svg>
<div class="pl-8 mr-8">
<blockquote>
<p>Exécutez le code suivant pour remplacer le contenu du fichier :</p>
</blockquote>
</div>
</div>
<pre class="language-python " style="counter-reset: linenumber 0"><code class="language-python">f <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"haiku.txt"</span><span class="token punctuation">,</span> <span class="token string">"w"</span><span class="token punctuation">)</span>
f<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">"Noël est aux portes\n"</span><span class="token punctuation">)</span>
f<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">"les dindes et les pintades\n"</span><span class="token punctuation">)</span>
f<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">"rentrent dans les fours"</span><span class="token punctuation">)</span>
f<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">)</span>
f<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">"Salim Bellen"</span><span class="token punctuation">)</span>
f<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
<div class="quote relative py-2 drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-red-500 bg-red-100">
<svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 text-red-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
  <path stroke-linecap="round" stroke-linejoin="round" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path>
</svg>
<div class="pl-8 mr-8">
<p>Une fois ouvert le fichier en écriture tout son contenu précédent est perdu.</p>
</div>
</div>
<h4>Utilisation de <code>with</code></h4>
<p>Vous verrez parfois l'utilisation du mot clé python <code>with</code> qui permet d'écrire :</p>
<pre class="language-python " style="counter-reset: linenumber 0"><code class="language-python"><span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"haiku.txt"</span><span class="token punctuation">,</span> <span class="token string">"a"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span> 
    f<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">)</span>
    f<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">"1644-1694"</span><span class="token punctuation">)</span>
</code></pre>
<ul>
<li>au début du bloc <code>with</code> le résultat de l'ouverture du fichier est appelé <code>f</code></li>
<li>A la fin du bloc <code>with</code> on ferme <code>f</code></li>
<li>s'il y a des erreurs, c'est également le bloc <code>with</code> qui s'en occupe pour nous.</li>
</ul>
<h4>Fichier binaire</h4>
<p>Pour ouvrir un fichier binaire sous python, on utilise le caractère <code>'b'</code> suivi de ce que l'on veut faire avec.</p>
<p>L'exemple suivant ouvre le fichier <code>haiku.txt</code> en lecture sous la forme d'un fichier binaire, puis place le contenu de celui-ci dans la variable <code>x</code></p>
<pre class="language-python " style="counter-reset: linenumber 0"><code class="language-python"><span class="token operator">>></span><span class="token operator">></span> f <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"haiku.txt"</span><span class="token punctuation">,</span> <span class="token string">"br"</span><span class="token punctuation">)</span>
<span class="token operator">>></span><span class="token operator">></span> x <span class="token operator">=</span> f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
<p>En regardant le type de <code>x</code> (avec la commande <code>type(x)</code>) :</p>
<pre class="language-text " style="counter-reset: linenumber 0"><code class="language-text">>>> type(x)
<class 'bytes'="">
</class></code></pre>
<p>On se rend compte que ce n'est pas une chaîne de caractères, mais un <code>bytes</code> (une suite d'octets). En l'affichant on voit que les accents ne passent pas :</p>
<pre class="language-text " style="counter-reset: linenumber 0"><code class="language-text">>>> print(x)
b"dans le vieil \xc3\xa9tang,\nune grenouille saute,\nun ploc dans l'eau.\n\nBash\xc3\xb4.\n"
</code></pre>
<p>Quand python affiche des suites d'octets, il essaie de les écrire en ascii et pour tous les caractères qu'il ne comprend pas (ici les accents car ils sont codés sur 2 octets en utf-8), il écrit juste le nombre sous format hexadécimal <code>\xc3</code> par exemple. De plus, il fait commencer l'affichage par un <code>b</code>  pour bien montrer que ce n'est <strong>PAS</strong> une chaîne de caractère.</p>
<p>On peut ensuite transformer les bytes <code>x</code> en autre chose, ici en <code>utf-8</code> puisque c'était l'encodage :</p>
<pre class="language-python " style="counter-reset: linenumber 0"><code class="language-python"><span class="token operator">>></span><span class="token operator">></span> texte <span class="token operator">=</span> x<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span>
</code></pre>
<p>En affichant le texte, on voit que c'est bien notre poème (car c'est notre poème !) :</p>
<pre class="language-python " style="counter-reset: linenumber 0"><code class="language-python"><span class="token operator">>></span><span class="token operator">></span> <span class="token keyword">print</span><span class="token punctuation">(</span>texte<span class="token punctuation">)</span>
dans le vieil étang<span class="token punctuation">,</span>
une grenouille saute<span class="token punctuation">,</span>
un ploc dans l'eau<span class="token punctuation">.</span>

Bashô<span class="token punctuation">.</span>

</code></pre>
<h3>Manipulation des dossiers et des fichiers</h3>
<p>Par défaut python va chercher les fichiers à ouvrir dans le dossier du fichier python en train d'être exécuté. On peut facilement chercher un fichier dans un dossier spécifique en python.</p>
<p>Commencez par intégrer la règle d'or :</p>
<div class="quote relative drop-shadow  py-2 pr-2 rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-amber-800 bg-amber-100">
<svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 text-amber-800" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
  <path stroke-linecap="round" stroke-linejoin="round" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
</svg>
<div class="pl-8 mr-8">
<p>On ne présuppose jamais de l'endroit où un fichier est stocké sur un ordinateur.</p>
</div>
</div>
<p>Supposons  que vous ayez un fichier python dans le dossier <code class="fichier">/Users/fbrucker/Documents/mon_projet/main.py</code> et que ce programme python utilise le fichier <code class="fichier">/Users/fbrucker/Documents/mon_projet/donnees.txt</code>.</p>
<p>Si votre programme <code class="fichier">main.py</code> utilise le fichier <code class="fichier">donnees.txt</code> de cette façon :</p>
<pre class="language-python " style="counter-reset: linenumber 0"><code class="language-python">donnees <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"/Users/fbrucker/Documents/mon_projet/donnees.txt"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
<p>Il ne pourra fonctionner <strong>que</strong> sur votre ordinateur ! En effet, si vous copiez le dossier <em>&quot;mon_projet&quot;</em>  et tout son contenu  de l'ordinateur A à l'ordinateur B, il est très peu probable qu'il soit placé au même endroit sur le disque dur.</p>
<p>Une première solution est d'utiliser un chemin relatif :</p>
<pre class="language-python " style="counter-reset: linenumber 0"><code class="language-python">donnees <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"donnees.txt"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
<p>On voit que le chemin utilisé est <em>relatif</em> car il ne commence pas par un <em>&quot;/&quot;</em>. On cherche le fichier <code class="fichier">donnees.txt</code> par rapport au dossier courant du terminal qui a exécuté le fichier python. De là, si vous êtes dans le dossier <em>&quot;mon_projet&quot;</em> lorsque vous tapez la commande <code>python main.py</code> votre programme marchera sur tous les ordinateurs.</p>
<p>Si cette technique fonctionne souvent, elle n'est cependant pas optimale car vous ne pouvez pas garantir que votre programme sera <strong>toujours</strong> exécuté depuis le dossier <em>&quot;mon_projet&quot;</em>. S'il est par exemple exécuté depuis le parent de <em>&quot;mon_projet&quot;</em> : <code>python mon_projet/main.py</code> ; votre code ne fonctionnera plus puisque le dossier par défaut ne sera plus le bon...</p>
<p>La solution qui fonctionne tout le temps est de déterminer à l'exécution l'emplacement du fichier*&quot;<a href="http://main.py">main.py</a>&quot;*. Ceci se fait grâce à la variable spéciale : <code>__file__</code>.</p>
<div class="quote relative  py-2 drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-yellow-500 bg-yellow-100">
<svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 text-yellow-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
  <path stroke-linecap="round" stroke-linejoin="round" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"></path>
  <path stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
</svg>
<div class="pl-8 mr-8">
<p>Copiez le code suivant dans un fichier et exécutez le pour voir le fonctionnement de la variable <code>__file__</code> :</p>
<pre class="language-python " style="counter-reset: linenumber 0"><code class="language-python"><span class="token keyword">print</span><span class="token punctuation">(</span>__file__<span class="token punctuation">)</span>
</code></pre>
</div>
</div>
<p>On a fait que la moitié du chemin, puisque l'on a l'emplacement du fichier, mais pas le dossier. Ceci peut se faire en utilisant le module <a href="https://docs.python.org/fr/3/library/os.path.html"><code>os.path</code> de python</a> :</p>
<div class="quote relative  py-2 drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-yellow-500 bg-yellow-100">
<svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 text-yellow-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
  <path stroke-linecap="round" stroke-linejoin="round" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"></path>
  <path stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
</svg>
<div class="pl-8 mr-8">
<p>Copiez le code suivant dans un fichier et exécutez le pour voir comment récupérer le dossier à partir de <code>__file__</code> :</p>
<pre class="language-python " style="counter-reset: linenumber 0"><code class="language-python"><span class="token keyword">import</span> os

<span class="token keyword">print</span><span class="token punctuation">(</span>__file__<span class="token punctuation">)</span> <span class="token comment"># le chemin absolu jusqu'au fichier</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>dirname<span class="token punctuation">(</span>__file__<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># le dossier</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>basename<span class="token punctuation">(</span>__file__<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># le nom du fichier                                     </span>
</code></pre>
</div>
</div>
<p>Cette méthode permet d'obtenir un chemin absolu de référence pour garantir l'accès aux fichiers de données sur toutes les machines où votre projet sera copié.</p>
<p>Un fois un dossier de référence trouvé, on pourra l'utiliser pour accéder à nos données. Mais <strong>jamais</strong> à la main :</p>
<div class="quote relative drop-shadow  py-2 pr-2 rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-amber-800 bg-amber-100">
<svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 text-amber-800" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
  <path stroke-linecap="round" stroke-linejoin="round" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
</svg>
<div class="pl-8 mr-8">
<p>Lorsque l'on manipule des fichiers ou que l'on combine des dossiers on utilise <strong>toujours</strong> une bibliothèque dédiée pour cela, on ne manipule <strong>jamais</strong> les noms de fichiers et de dossiers en utilisant des méthodes de chaines de caractères</p>
</div>
</div>
<p>On va voir deux façon de faire en python, l'une classique avec le module <a href="https://docs.python.org/fr/3/library/os.path.html">os.path</a>, l'autre plus moderne qui utilise le module <a href="https://docs.python.org/fr/3/library/pathlib.html">pathlib</a>.</p>
<h4>Module os.path</h4>
<p>On suppose que la variable <code>__file__</code> corresponde au chemin <em>&quot;/Users/fbrucker/Documents/mon_projet/main.py&quot;</em> sur le disque dur. On suppose aussi que le module <code>os</code> a été importé.</p>
<ul>
<li>rendre le dossier où est <code>__file__</code> avec <a href="https://docs.python.org/fr/3/library/os.path.html#os.path.dirname">dirname</a> : <code>dossier = os.path.dirname(__file__)</code>.</li>
<li>rendre le nom du fichier pointé par <code>__file__</code> avec <a href="https://docs.python.org/fr/3/library/os.path.html#os.path.basename">basename</a> : <code>nom_fichier = os.path.basename(__file__)</code></li>
<li>concaténer deux chemins avec <a href="https://docs.python.org/fr/3/library/os.path.html#os.path.join">join</a> : <code>os.path.join(&quot;/Users/fbrucker&quot;, &quot;Documents/mon_projet&quot;)</code> rendra : <code>/Users/fbrucker/Documents/mon_projet</code></li>
<li>rendre le dossier parent : <code>os.path.join(dossier, &quot;..&quot;)</code>.</li>
<li>rendre le chemin absolu à partir d'un chemin relatif : <code>os.path.abspath(&quot;.&quot;)</code></li>
</ul>
<h4>Module pathlib</h4>
<p>Le module <a href="https://docs.python.org/fr/3/library/pathlib.html">pathlib</a> permet d'avoir une approche objet de la manipulation des fichiers. Le tuto suivant est parfait pour vous montrer comment l'utiliser : <a href="https://jefftriplett.com/2017/pathlib-is-wonderful/">https://jefftriplett.com/2017/pathlib-is-wonderful/</a>.</p>
<h3>Fichiers distants</h3>
<p>Les fichiers stockés sur internet peuvent aussi être récupérés en python <em>via</em> leur <a href="https://fr.wikipedia.org/wiki/Uniform_Resource_Locator">url</a>. On utilise la bibliothèque <a href="https://requests-fr.readthedocs.io/en/latest/">requests</a> (<code>python -m pip install requests</code>).</p>
<p>Par exemple, le site <a href="https://www.gutenberg.org">https://www.gutenberg.org</a> possède de nombreux livres au format utf-8 à télécharger. Par exemple <a href="https://www.gutenberg.org/ebooks/14155">https://www.gutenberg.org/ebooks/14155</a> :</p>
<pre class="language-python " style="counter-reset: linenumber 0"><code class="language-python"><span class="token keyword">import</span> requests
page <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"https://www.gutenberg.org/ebooks/14155.txt.utf-8"</span><span class="token punctuation">)</span>

texte <span class="token operator">=</span> page<span class="token punctuation">.</span>text  

</code></pre>
<p>Une fois téléchargé, le fichier est décodé selon le format donné dans la requête (ici <code>utf-8</code>), voir <code>page.encoding</code>.</p>
<div class="quote relative  py-2 drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-cyan-500 bg-cyan-100">
<svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 text-cyan-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
  <path stroke-linecap="round" stroke-linejoin="round" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"></path>
</svg>
<div class="pl-8 mr-8">
<p>Un petit tuto vous montrant quelques paramètres du module requests :<br>
<a href="https://www.tutorialspoint.com/downloading-files-from-web-using-python">https://www.tutorialspoint.com/downloading-files-from-web-using-python</a></p>
</div>
</div>
<h2>Données au format texte</h2>
<p>Lorsque l'on manipule des données, On essaye toujours :</p>
<ul>
<li>d'enregistrer ses données dans un fichier texte que l'on peu simplement consulter avec un éditeur de texte</li>
<li>on utilise un format de stockage connu plutôt que d'inventer son format, cela permet d'utiliser des bibliothèque de traitement de données classiques.</li>
</ul>
<div class="quote relative drop-shadow  py-2 pr-2 rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-amber-800 bg-amber-100">
<svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 text-amber-800" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
  <path stroke-linecap="round" stroke-linejoin="round" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
</svg>
<div class="pl-8 mr-8">
<p>Plutôt que d'écrire simplement un fichier texte contenant nos données, on préférera les structurer dans un format permettant de les relire simplement. On en conseille deux :</p>
<ul>
<li>les <a href="https://fr.wikipedia.org/wiki/Comma-separated_values">fichiers csv</a> pour des données de type tableaux excel</li>
<li>les <a href="https://www.json.org/json-fr.html">fichiers json</a> pour des données structurées en fiches.</li>
</ul>
</div>
</div>
<p>Nous ne l'étudierons pas ici, mais la plupart du temps, lorsque l'on utilise des données on ne le fait pas  la main, mais en utilisant une bibliothèque. En analyse des données, on utilise intensivement la bibliothèque <a href="https://pandas.pydata.org/">pandas</a>.</p>


</article>
    </main>

    <footer class="min-h-[50px] border-t-2 border-gray-200 mt-4">
      <div class="max-w-[1200px] mx-auto px-4 relative">
        <div class="min-h-[50px] flex justify-center items-center">
          <p>
            Cours d'informatique à l'école centrale Marseille
          </p>
        </div>
        <div class="min-h-[50px] flex justify-center items-center absolute right-0 top-0">
          <button onclick="goTop()" id="myBtn" title="Go to top">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
              <path stroke-linecap="round" stroke-linejoin="round" d="M15 11.25l-3-3m0 0l-3 3m3-3v7.5M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
            </svg>
          </button>

          <button onclick="goBottom()" id="myBtn" title="Go to top">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
              <path stroke-linecap="round" stroke-linejoin="round" d="M9 12.75l3 3m0 0l3-3m-3 3v-7.5M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
            </svg>
          </button>
        </div>

      </div>
    </footer>

    <script>
      MathJax
        .startup
        .document
        .getMathItemsWithin(document.body);
    </script>

  </body>
</html>