<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
<!-- Begin Jekyll SEO tag v2.8.0 -->
<title>étude / alignement de séquences | cours d’informatique</title>
<meta name="generator" content="Jekyll v4.2.0">
<meta property="og:title" content="étude / alignement de séquences">
<meta name="author" content="François Brucker">
<meta property="og:locale" content="en_US">
<meta name="description" content="Support de cours/td d’informatique de François Brucker.">
<meta property="og:description" content="Support de cours/td d’informatique de François Brucker.">
<link rel="canonical" href="/cours_informatique/cours/algorithme-code-theorie/algorithme/etude-alignement-sequences.html">
<meta property="og:url" content="/cours_informatique/cours/algorithme-code-theorie/algorithme/etude-alignement-sequences.html">
<meta property="og:site_name" content="cours d’informatique">
<meta property="og:type" content="website">
<meta name="twitter:card" content="summary">
<meta property="twitter:title" content="étude / alignement de séquences">
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","author":{"@type":"Person","name":"François Brucker"},"description":"Support de cours/td d’informatique de François Brucker.","headline":"étude / alignement de séquences","url":"/cours_informatique/cours/algorithme-code-theorie/algorithme/etude-alignement-sequences.html"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/cours_informatique/assets/main.css">

  <link rel="stylesheet" href="/cours_informatique/assets/custom.css">

  <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet">
<link type="application/atom+xml" rel="alternate" href="/cours_informatique/feed.xml" title="cours d'informatique">
<script>MathJax={"tex":{"inlineMath":[["$","$"],["\\(","\\)"]],"displayMath":[["\\[","\\]"]]},"svg":{"fontCache":"global"},"svg":{"fontCache":"global"}}</script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
</head>

<body>
<header class="site-header" role="banner">

  <div class="wrapper">
<a class="site-title" rel="author" href="/cours_informatique/">cours d'informatique</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger">
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewbox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"></path>
            </svg>
          </span>
        </label>

        <div class="trigger">
            <a class="page-link" href="/cours_informatique/about"> about </a>
        </div>
      </nav>
</div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post">

  <header class="post-header">
    <h1 class="post-title">étude / alignement de séquences</h1>Auteur : <span itemprop="author" itemscope itemtype="http://schema.org/Person"><span class="p-author h-card" itemprop="name">François Brucker</span></span>
  </header>

  <div class="post-content">
    <blockquote class="chemin">
  <p><a href="/cours_informatique/cours/algorithme-code-theorie/">Algorithme, code et théorie</a> / <a href="/cours_informatique/cours/algorithme-code-theorie/algorithme/">algorithmie</a> / <a href="/cours_informatique/cours/algorithme-code-theorie/algorithme/etude-alignement-sequences.html">étude : alignement de séquences</a></p>

  <p>prérequis :</p>

  <ul>
    <li><a href="/cours_informatique/cours/algorithme-code-theorie/algorithme/etude-recherche-sous-chaines.html">étude : recherche de sous-chaines</a></li>
  </ul>

</blockquote>

<p>Nous allons voir dans cette étude comment définir/calculer une distance entre 2 chaînes de caractères. Nous utiliserons la <a href="https://fr.wikipedia.org/wiki/Distance_de_Levenshtein">distance d’édition</a>, très utilisée.</p>

<h2 id="distance-entre-chaines-">distance entre chaines ?</h2>

<p>Soient $a$ et $b$ deux chaines de caractères définies sur un alphabet $\mathcal{A}$. Commençons par supposer qu’elles sont de même longueur (disons $n$). On peut compter les différences entre $a$ et $b$ :</p>

\[D(a, b) = \vert \{i \mid a[i] \neq b[i], 0 \leq i &lt; n \} \vert\]

<blockquote>
  <p>La distance entre <em>“MISO”</em> et <em>“SILO”</em> est de 2 différences.</p>
</blockquote>

<p>Cette définition de distance est cependant un peu frustre puisque qu’elle ne permet de comparer que deux mots ayant le même nombre de caractères. Il faut donc généraliser pour permettre de comparer deux chaînes de longueur différentes.</p>

<p>Pour cela, on va ajouter un caractère noté <code class="language-plaintext highlighter-rouge">-</code> qui correspond à un caractère <em>vide</em> et dont le but est d’allonger artificiellement une chaine. Par exemple : <code class="language-plaintext highlighter-rouge">MEROU</code> et <code class="language-plaintext highlighter-rouge">ME-R-OUR</code>  correspondent aux même chaînes, mais l’une est de longueur 6 et la seconde de longueur 8.</p>

<p>On peut donc maintenant comparer <code class="language-plaintext highlighter-rouge">MEROU</code> et <code class="language-plaintext highlighter-rouge">MARLOU</code> via un <em>alongement</em> de <code class="language-plaintext highlighter-rouge">MEROU</code>. Par exemple comparer <code class="language-plaintext highlighter-rouge">MERO-U</code> et <code class="language-plaintext highlighter-rouge">MARLOU</code>, ce qui donne une distance de 3. Le dessin ci-dessous représente cette distance. On a mis des <code class="language-plaintext highlighter-rouge">|</code> entre les lettres identiques :</p>

<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>MERO-U
| |  |
MARLOU
</code></pre></div></div>

<p>La distance est donc égale :</p>

<ul>
  <li>au nombre de lettres différentes</li>
  <li>à la longueur des mots moins le nombre de lettres identiques</li>
</ul>

<p>Ceci pose cependant deux (gros) problèmes :</p>

<ol>
  <li>
    <p>selon l’allongement choisi, la distance n’est pas la même :</p>

    <div class="language-text highlighter-rouge">
<div class="highlight"><pre class="highlight"><code> MER-OU
 | | ||
 MARLOU
</code></pre></div>    </div>
  </li>
  <li>
    <p>on peut utiliser l’allongement pour changer la distance de 2 chaînes de mêmes longueurs :</p>

    <div class="language-text highlighter-rouge">
<div class="highlight"><pre class="highlight"><code> MEROUS       MER-OUS
 | |      ≠   | | || 
 MARLOU       MARLOU-
</code></pre></div>    </div>
  </li>
</ol>

<p>Il faut donc tout refaire… Une solution pour unifier les deux approches est de formaliser la notion d’<strong>alignement</strong>. entre séquences, puis d’utiliser cet outil pour définir la distance d’édition entre deux séquences.</p>

<h2 id="alignement">alignement</h2>

<blockquote class="note">
  <p>Un alignement entre la chaîne $a =a_0\dots a_{n-1}$ et $b = b_0\dots b_{m-1}$ est un couple $(a^\star, b^\star)$ tel que :</p>

  <ul>
    <li>$a^\star =a^\star_0\dots a^\star_{L-1}$</li>
    <li>$b^\star =b^\star_0\dots b^\star_{L-1}$</li>
    <li>chaque caractère de $a^\star$ et $b^\star$ est soit <code class="language-plaintext highlighter-rouge">-</code> soit un caractère de la chaine initiale</li>
    <li>$(a^\star_i, b^\star_i) \neq (-, -)$ pour tout $0 \leq i &lt; L$</li>
    <li>$a^\star$ (respectivement $b^\star$) privé des caractères <code class="language-plaintext highlighter-rouge">-</code> est égal à $a$ (<em>resp.</em> $b$)</li>
  </ul>

</blockquote>

<p>On remarque que : $\max(n, m) - 1 \leq L &lt; n + m$.</p>

<h3 id="distance">distance</h3>

<p>Etant donné un alignement $(a^\star, b^\star)$, on peut alors définir sa distance :</p>

\[D(a^\star, b^\star) = \sum_{i=0}^{L-1} \delta(a^\star_i, b^\star_i)\]

<p>Avec la <strong>distance élémentaire</strong> $\delta$ :</p>

\[\delta(a^\star_i, b^\star_i) = \begin{cases} 0 &amp; \text{si } a^\star_i = b^\star_i\\ 1 &amp; \text{sinon}\end{cases}\]

<p>Notez que $D$ est bien une distance :</p>

<ul>
  <li>elle est symétrique</li>
  <li>$d(a, a) = 0$</li>
  <li>elle vérifie l’inégalité triangulaire</li>
</ul>

<h3 id="évolution-dune-séquence-en-lautre">évolution d’une séquence en l’autre</h3>

<p>Un alignement permet de simuler le passage d’une séquence à l’autre. Par exemple en considérant l’alignement suivant :</p>

<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>MER-OUS
| | || 
MARLOU-
</code></pre></div></div>

<p>En allant de gauche à droite on passe de <code class="language-plaintext highlighter-rouge">MEROUS</code> à <code class="language-plaintext highlighter-rouge">MARLOU</code> :</p>

<ol>
  <li>MEROUS (mot initial)</li>
  <li>
<strong>M</strong>EROUS (identité)</li>
  <li>
<strong>MA</strong>ROUS (<strong>substitution</strong> de E en A)</li>
  <li>
<strong>MAR</strong>OUS (identité)</li>
  <li>
<strong>MARL</strong>OUS (<strong>insertion</strong> de L)</li>
  <li>
<strong>MARLO</strong>US (identité)</li>
  <li>
<strong>MARLOU</strong>S (identité)</li>
  <li>
<strong>MARLOU</strong> (<strong>suppression</strong> de S)</li>
</ol>

<h3 id="nombre-dalignements">nombre d’alignements</h3>

<p>Il peut y avoir beaucoup (beaucoup) d’alignements possibles entre 2 séquences.</p>

<details><summary>exercice : trouver au moins 3 alignements différents entre les séquences ACTGC et ACGTC</summary><div>
<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ACTG-C
|  |
A-CGTC
</code></pre></div></div>

<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ACTGC
||  |
ACGTC
</code></pre></div></div>

<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ACTG-C
|| | |
AC-GTC
</code></pre></div></div>

<p>et bien d’autres encore sont possibles.</p>

</div></details>

<p>On peut remarquer que ce nombre ne dépend que de la longueur des chaines $a$ et $b$, pas de leur contenu. On note alors $f(n, m)$ le nombre possible d’alignements entre une chaîne de longueur $n$ et une chaîne de longueur $m$.</p>

<p>Comme un alignement ne peut finir sur $(-, -)$, on ne peut qu’avoir 3 possibilités :</p>

<ul>
  <li>$(a_{n-1}, b_{m-1})$</li>
  <li>$(a_{n-1}, -)$</li>
  <li>$(-, b_{m-1})$</li>
</ul>

<p>Aligner $a$ et $b$ revient alors soit à aligner :</p>

<ul>
  <li>$a_0\dots a_{n-2}$ et $b_0\dots b_{m-2}$ et ajouter $(a_{n-1}, b_{m-1})$ à la fin de cet alignement</li>
  <li>aligner $a_0\dots a_{n-2}$ et $b$ et ajouter $(a_{n-1}, -)$ à la fin de cet alignement</li>
  <li>aligner $a$ et $b_0\dots b_{m-2}$ et ajouter $(-, b_{m-1})$ à la fin de cet alignement</li>
</ul>

<p>Ce qui donne l’équation de récurrence suivante :</p>

\[f(n, m) = f(n − 1, m − 1) + f(n − 1, m) + f(n, m − 1)\]

<p>On peut alors prouver, si $n=m$ que :</p>

\[f(n, n) \sim \frac{(1 + \sqrt{2})^{2n + 1}}{\sqrt{n}}\]

<p>Ce nombre est affreusement énorme :</p>

<ul>
  <li>pour $n = 10$, on a déjà  $f(10, 10) \sim 34537380$</li>
  <li>pour $n = 100$, on a $f(100, 100) \sim 8.67 \cdot 10^{75}$</li>
  <li>pour $n = 200$, on a  $f(200, 200) \sim 2.2 \cdot 10^{152}$</li>
</ul>

<blockquote>
  <p>Il n’y a qu’environ $10^{80}$ particules dans l’univers.</p>
</blockquote>

<h2 id="distance-dédition">distance d’édition</h2>

<p>L’alignement entre 2 séquences nous permet de définir, à partir d’une distance pour alignement, une distance pour séquences :</p>

\[D(a, b) = \min \{ S(a^\star, b^\star) \mid \text{pour tous les alignements } (a^\star, b^\star) \text{ entre } a \text{ et } b\}\]

<p>Comme il est impossible de trouver tous les alignements possibles, il faut ruser pour calculer cette distance sans faire exploser la complexité.</p>

<h3 id="calcul-pour-la-distance-élémentaire">calcul pour la distance élémentaire</h3>

<p>Reprenons le calcul de la distance pour un alignement donné :</p>

\[D(a^\star, b^\star) = \sum_{i=0}^{L-1} \delta(a^\star_i, b^\star_i) = \sum_{i=0}^{L-2} \delta(a^\star_i, b^\star_i) + \delta(a^\star_{L-1}, b^\star_{L-1})\]

<p>Ce qui, pour la distance élémentaire donne :</p>

\[D(a^\star, b^\star) = \sum_{i=0}^{L-1} \delta(a^\star_i, b^\star_i) = \sum_{i=0}^{L-2} \delta(a^\star_i, b^\star_i) +
\begin{cases}
0 &amp; \text{si } a^\star_{L-1} = b^\star_{L-1}\\
1 &amp; \text{sinon}
\end{cases}\]

<p>De la même façon que l’on a fait pour établir l’équation de récurrence pour déterminer le nombre d’alignements, on a que $(a^\star_{L-1}, b^\star_{L-1})$ peut être égal à :</p>

<ul>
  <li>$(a_{n-1}, b_{m-1})$ et donc $(a^\star_0\dots a^\star_{L-2}, b^\star_0\dots b^\star_{L-2})$ est un alignement des séquences $a_0\dots a_{n-2}$ et $b_0\dots b_{m-2}$</li>
  <li>$(a_{n-1}, -)$ et donc $(a^\star_0\dots a^\star_{L-2}, b^\star_0\dots b^\star_{L-2})$ est un alignement des séquences $a_0\dots a_{n-2}$ et $b$</li>
  <li>$(-, b_{m-1})$ et donc $(a^\star_0\dots a^\star_{L-2}, b^\star_0\dots b^\star_{L-2})$ est un alignement des séquences $a$ et $b_0\dots b_{m-2}$</li>
</ul>

<p>De là, si l’on connaît :</p>

<ul>
  <li>$D(a[:-1], b[:-1])$</li>
  <li>$D(a[:-1], b)$</li>
  <li>$D(a, b[:-1])$</li>
</ul>

<p>on a :</p>

\[D(a, b) = \min  \begin{cases}
      D(a[:-1], b[:-1]) + \delta(a_{n-1}, b_{m-1}) &amp; \\
     D(a[:-1], b) + 1 &amp; \\
      D(a, b[:-1]) + 1 &amp;\\
    \end{cases}\]

<blockquote class="note">
  <p>C’est le principe de la <a href="https://fr.wikipedia.org/wiki/Programmation_dynamique">programmation dynamique</a> : un chemin optimal est constitué de sous-chemins eux-mêmes optimaux.</p>
</blockquote>

<p>Ceci se généralise pour tout $i$ et $j$ :</p>

\[D(a[:i+1], b[:j+1]) = \min \begin{cases}
      D(a[:i], b[:j]) + \delta(a[i], b[j]) &amp; \\
      D(a[:i], b[:j + 1]) + 1 &amp; \\
      D(a[:i + 1], b[:j]) + 1 &amp; \\
    \end{cases}\]

<p>Et nous permet de créer une représentation matricielle de l’alignement et de la distance d’édition, appelée <strong>matrice d’édition</strong> :</p>

<table>
  <thead>
    <tr>
      <th> </th>
      <th>$-$</th>
      <th>$a[0]$</th>
      <th>…</th>
      <th>$a[i-1]$</th>
      <th>$a[i]$</th>
      <th>$a[n-1]$</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>$-$</td>
      <td>0</td>
      <td>$1$</td>
      <td> </td>
      <td>$i$</td>
      <td>$i+1$</td>
      <td>$n$</td>
    </tr>
    <tr>
      <td>$b[0]$</td>
      <td>$1$</td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>…</td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>$b[j-1]$</td>
      <td>$j$</td>
      <td> </td>
      <td> </td>
      <td>$D(a[:i],b[:j])$</td>
      <td>$D(a[:i+1],b[:j])$</td>
      <td> </td>
    </tr>
    <tr>
      <td>$b[j]$</td>
      <td>$j+1$</td>
      <td> </td>
      <td> </td>
      <td>$D(a[:i],b[:j+1])$</td>
      <td>$D(a[:i+1],b[:j+1])$</td>
      <td> </td>
    </tr>
    <tr>
      <td>…</td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>$b[m-1]$</td>
      <td>$m$</td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td>$D(a,b)$</td>
    </tr>
  </tbody>
</table>

<p>Et nous donne un algorithme très facile pour la calculer, puisqu’il suffit de remplir la première ligne et la première colonne, puis de progresser ligne à ligne avec la formule:</p>

\[M[i + 1][j + 1] = \min \begin{cases}
M[i][j] + 0  &amp; \text{si } a[j] = b[i]\\
M[i][j] + 1  &amp; \text{si } a[j] \neq b[i]\\
M[i + 1][j] + 1 &amp;\\
M[i][j + 1] + 1&amp;\\
\end{cases}\]

<p>La distance entre $a$ et $b$ qui correspond à un alignement de distance minimale est alors à la dernière ligne et dernière colonne de la matrice (en $M[-1][-1]$).</p>

<h3 id="exemple-pour-la-distance-élémentaire">exemple pour la distance élémentaire</h3>

<p>Distance de <code class="language-plaintext highlighter-rouge">ACTGATT</code> (horizontal) à <code class="language-plaintext highlighter-rouge">GCTAATCG</code> (vertical).</p>

<blockquote class="a-faire">
  <p>Créez la matrice d’édition <em>vierge</em> à utiliser</p>
</blockquote>
<details><summary>solution</summary><div>
<table>
  <thead>
    <tr>
      <th> </th>
      <th>-</th>
      <th>A</th>
      <th>C</th>
      <th>T</th>
      <th>G</th>
      <th>A</th>
      <th>T</th>
      <th>T</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>G</td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>C</td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>T</td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>A</td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>A</td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>T</td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>C</td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>G</td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
  </tbody>
</table>

</div></details>

<blockquote class="a-faire">
  <p>Remplissez la première ligne et la première colonne</p>
</blockquote>
<details><summary>solution</summary><div>
<table>
  <tbody>
    <tr>
      <td> </td>
      <td>-</td>
      <td>A</td>
      <td>C</td>
      <td>T</td>
      <td>G</td>
      <td>A</td>
      <td>T</td>
      <td>T</td>
    </tr>
    <tr>
      <td>-</td>
      <td>0</td>
      <td>1</td>
      <td>2</td>
      <td>3</td>
      <td>4</td>
      <td>5</td>
      <td>6</td>
      <td>7</td>
    </tr>
    <tr>
      <td>G</td>
      <td>1</td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>C</td>
      <td>2</td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>T</td>
      <td>3</td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>A</td>
      <td>4</td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>A</td>
      <td>5</td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>T</td>
      <td>6</td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>C</td>
      <td>7</td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>G</td>
      <td>8</td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
  </tbody>
</table>

</div></details>

<blockquote class="a-faire">
  <p>Remplissez le reste de la matrice ligne à ligne</p>
</blockquote>
<details><summary>solution</summary><div>
<table>
  <tbody>
    <tr>
      <td> </td>
      <td>-</td>
      <td>A</td>
      <td>C</td>
      <td>T</td>
      <td>G</td>
      <td>A</td>
      <td>T</td>
      <td>T</td>
    </tr>
    <tr>
      <td>-</td>
      <td>0</td>
      <td>1</td>
      <td>2</td>
      <td>3</td>
      <td>4</td>
      <td>5</td>
      <td>6</td>
      <td>7</td>
    </tr>
    <tr>
      <td>G</td>
      <td>1</td>
      <td>1</td>
      <td>2</td>
      <td>3</td>
      <td>3</td>
      <td>4</td>
      <td>5</td>
      <td>6</td>
    </tr>
    <tr>
      <td>C</td>
      <td>2</td>
      <td>2</td>
      <td>1</td>
      <td>2</td>
      <td>3</td>
      <td>4</td>
      <td>5</td>
      <td>6</td>
    </tr>
    <tr>
      <td>T</td>
      <td>3</td>
      <td>3</td>
      <td>2</td>
      <td>1</td>
      <td>2</td>
      <td>3</td>
      <td>4</td>
      <td>5</td>
    </tr>
    <tr>
      <td>A</td>
      <td>4</td>
      <td>3</td>
      <td>3</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>3</td>
      <td>4</td>
    </tr>
    <tr>
      <td>A</td>
      <td>5</td>
      <td>4</td>
      <td>4</td>
      <td>3</td>
      <td>3</td>
      <td>2</td>
      <td>3</td>
      <td>4</td>
    </tr>
    <tr>
      <td>T</td>
      <td>6</td>
      <td>5</td>
      <td>5</td>
      <td>4</td>
      <td>4</td>
      <td>3</td>
      <td>2</td>
      <td>3</td>
    </tr>
    <tr>
      <td>C</td>
      <td>7</td>
      <td>6</td>
      <td>5</td>
      <td>5</td>
      <td>5</td>
      <td>4</td>
      <td>3</td>
      <td>3</td>
    </tr>
    <tr>
      <td>G</td>
      <td>8</td>
      <td>7</td>
      <td>6</td>
      <td>6</td>
      <td>5</td>
      <td>5</td>
      <td>4</td>
      <td>4</td>
    </tr>
  </tbody>
</table>

</div></details>

<blockquote class="a-faire">
  <p>Donnez la distance obtenue</p>
</blockquote>
<details><summary>solution</summary><div>
<p>C’est $M[-1][-1]$ et cela vaut 4</p>

</div></details>

<h3 id="alignement-et-distance-dédition">alignement et distance d’édition</h3>

<p>Avec la matrice d’édition, il est facile de retrouver un alignement qui a réalisé la distance minimale en <em>remontant</em> dans la matrice.</p>

<ol>
  <li>on pose $i=-1$ et $j=-1$</li>
  <li>on pose $A = []$, c’est le tableau qui va contenir notre alignement</li>
  <li>on considère $M[i][j]$ qui est la valeur courante de la matrice</li>
  <li>on cherche le minimum parmi les 4 possibilités :
    <ol>
      <li>$M[i-1][j-1]$ si $a[j] = b[i]$</li>
      <li>$M[i-1][j-1] + 1$ si $a[j] \neq b[i]$</li>
      <li>$M[i-1][j] + 1$</li>
      <li>$M[i][j-1] + 1$</li>
    </ol>
  </li>
  <li>le minimum de l’étape 3 nous donne une partie de l’alignement à ajouter :
    <ol>
      <li>on ajoute $(a[j], b[i])$ au début de $A$ et on pose $i=i-1$ et $j=j-1$</li>
      <li>on ajoute $(a[j], b[i])$ au début de $A$ et on pose $i=i-1$ et $j=j-1$</li>
      <li>on ajoute $(-, b[i])$ au début de $A$ et on pose $i=i-1$</li>
      <li>on ajoute $(a[j], -)$ au début de $A$ et on pose $j=j-1$</li>
    </ol>
  </li>
  <li>si $i&gt; -m$ ou $j&gt;-n$ on retourne en 3.</li>
</ol>

<p>L’algorithme précédent est une idée de l’algorithme. Il faudra ajouter les conditions au bord de la matrice (lorsque $i=-m$ et $j &gt; -n$ par exemple) pour ne pas déborder.</p>

<blockquote class="a-faire">
  <p>En reprenant l’exemple précédent, donner un alignement donnant le coût minimum</p>
</blockquote>
<details><summary>solution</summary><div>
<p>Le chemin dans la matrice est donné en gras :</p>

<table>
  <tbody>
    <tr>
      <td> </td>
      <td>-</td>
      <td>A</td>
      <td>C</td>
      <td>T</td>
      <td>G</td>
      <td>A</td>
      <td>T</td>
      <td>T</td>
    </tr>
    <tr>
      <td>-</td>
      <td><strong>0</strong></td>
      <td>1</td>
      <td>2</td>
      <td>3</td>
      <td>4</td>
      <td>5</td>
      <td>6</td>
      <td>7</td>
    </tr>
    <tr>
      <td>G</td>
      <td>1</td>
      <td><strong>1</strong></td>
      <td>2</td>
      <td>3</td>
      <td>3</td>
      <td>4</td>
      <td>5</td>
      <td>6</td>
    </tr>
    <tr>
      <td>C</td>
      <td>2</td>
      <td>2</td>
      <td><strong>1</strong></td>
      <td>2</td>
      <td>3</td>
      <td>4</td>
      <td>5</td>
      <td>6</td>
    </tr>
    <tr>
      <td>T</td>
      <td>3</td>
      <td>3</td>
      <td>2</td>
      <td><strong>1</strong></td>
      <td>2</td>
      <td>3</td>
      <td>4</td>
      <td>5</td>
    </tr>
    <tr>
      <td>A</td>
      <td>4</td>
      <td>4</td>
      <td>3</td>
      <td>2</td>
      <td><strong>2</strong></td>
      <td>2</td>
      <td>3</td>
      <td>4</td>
    </tr>
    <tr>
      <td>A</td>
      <td>5</td>
      <td>4</td>
      <td>4</td>
      <td>3</td>
      <td>3</td>
      <td><strong>2</strong></td>
      <td>3</td>
      <td>4</td>
    </tr>
    <tr>
      <td>T</td>
      <td>6</td>
      <td>5</td>
      <td>4</td>
      <td>4</td>
      <td>4</td>
      <td>3</td>
      <td><strong>2</strong></td>
      <td>3</td>
    </tr>
    <tr>
      <td>C</td>
      <td>7</td>
      <td>6</td>
      <td>5</td>
      <td>5</td>
      <td>5</td>
      <td>4</td>
      <td><strong>3</strong></td>
      <td>3</td>
    </tr>
    <tr>
      <td>G</td>
      <td>8</td>
      <td>7</td>
      <td>6</td>
      <td>6</td>
      <td>5</td>
      <td>5</td>
      <td>4</td>
      <td><strong>4</strong></td>
    </tr>
  </tbody>
</table>

<p>On obtient alors l’alignement :</p>

<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ACTGAT-T
 || ||
GCTAATCG
</code></pre></div></div>

<p>Notez qu’il y a un autre alignement possible :</p>

<table>
  <tbody>
    <tr>
      <td> </td>
      <td>-</td>
      <td>A</td>
      <td>C</td>
      <td>T</td>
      <td>G</td>
      <td>A</td>
      <td>T</td>
      <td>T</td>
    </tr>
    <tr>
      <td>-</td>
      <td><strong>0</strong></td>
      <td>1</td>
      <td>2</td>
      <td>3</td>
      <td>4</td>
      <td>5</td>
      <td>6</td>
      <td>7</td>
    </tr>
    <tr>
      <td>G</td>
      <td>1</td>
      <td><strong>1</strong></td>
      <td>2</td>
      <td>3</td>
      <td>3</td>
      <td>4</td>
      <td>5</td>
      <td>6</td>
    </tr>
    <tr>
      <td>C</td>
      <td>2</td>
      <td>2</td>
      <td><strong>1</strong></td>
      <td>2</td>
      <td>3</td>
      <td>4</td>
      <td>5</td>
      <td>6</td>
    </tr>
    <tr>
      <td>T</td>
      <td>3</td>
      <td>3</td>
      <td>2</td>
      <td><strong>1</strong></td>
      <td>2</td>
      <td>3</td>
      <td>4</td>
      <td>5</td>
    </tr>
    <tr>
      <td>A</td>
      <td>4</td>
      <td>4</td>
      <td>3</td>
      <td>2</td>
      <td><strong>2</strong></td>
      <td>2</td>
      <td>3</td>
      <td>4</td>
    </tr>
    <tr>
      <td>A</td>
      <td>5</td>
      <td>4</td>
      <td>4</td>
      <td>3</td>
      <td>3</td>
      <td><strong>2</strong></td>
      <td>3</td>
      <td>4</td>
    </tr>
    <tr>
      <td>T</td>
      <td>6</td>
      <td>5</td>
      <td>4</td>
      <td>4</td>
      <td>4</td>
      <td>3</td>
      <td><strong>2</strong></td>
      <td>3</td>
    </tr>
    <tr>
      <td>C</td>
      <td>7</td>
      <td>6</td>
      <td>5</td>
      <td>5</td>
      <td>5</td>
      <td>4</td>
      <td>3</td>
      <td><strong>3</strong></td>
    </tr>
    <tr>
      <td>G</td>
      <td>8</td>
      <td>7</td>
      <td>6</td>
      <td>6</td>
      <td>5</td>
      <td>5</td>
      <td>4</td>
      <td><strong>4</strong></td>
    </tr>
  </tbody>
</table>

<p>Qui donne l’alignement :</p>

<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ACTGATT-
 || ||
GCTAATCG
</code></pre></div></div>

</div></details>

<h2 id="cas-général">cas général</h2>

<p>Pour l’instant notre distance élémentaire est définie telle que :</p>

<p>Avec la <strong>distance élémentaire</strong> $\delta$ :</p>

\[\delta(a^\star_i, b^\star_i) = \begin{cases} 0 &amp; \text{si } a^\star_i = b^\star_i\\ 1 &amp; \text{sinon}\end{cases}\]

<p>Comme $a^\star_i$ et $b^\star_j$ sont soit des caractères de l’alphabet soit le caractère vide $-$, on peut définir $\delta$ tel que :</p>

<ul>
  <li>$\delta(u, u) = 0$ pour tout caractère $u$</li>
  <li>$\delta(u, v) = 1$ si $u$ et $v$ sont deux caractères différents</li>
  <li>$\delta(u, -) = \delta(-, u) = 1$</li>
</ul>

<p>Il peut parfois être intéressant d’affiner un peu cette distance. Par exemple, si l’on cherche à trouver les erreurs de frappe, on pourra tenter de supposer que deux mots sont proches si les lettres qui les composent sont proches sur le clavier.</p>

<blockquote>
  <p><em>“ORNE”</em> sera plus proche de <em>“ORBE”</em> que de <em>“URNE”</em> si l’on compte l’éloignement des touches sur le clavier.</p>
</blockquote>

<p>On pourra alors utiliser la distance :</p>

<ul>
  <li>$\delta’(u, u) = 0$ pour tout caractère $u$</li>
  <li>$\delta’(u, v)$ vaut la distance entre les touches $u$ et $v$ sur le clavier</li>
  <li>$\delta’(u, -) = \delta’(-, u) = K$, une constante.</li>
</ul>

<p>De façon général, on définit alors un coût entre caractères défini tel que</p>

<ul>
  <li>$d(x, -)$ est appelé <strong>coût de suppression</strong>,</li>
  <li>$d(-, x)$ est appelé <strong>coût d’insertion</strong> et est égal à $d(x, -)$</li>
  <li>$d(x, y)$ est nommé <strong>coût de substitution</strong>
</li>
</ul>

<h3 id="définition-du-cas-général">définition du cas général</h3>

<p>Tout ce qu’on a fait précédemment est toujours applicable !</p>

<p>Sachant un coût $d$, on peut définir la distance $D_d$ pour un alignement $(a^\star, b^\star)$:</p>

\[D_d(a^\star, b^\star) = \sum_{i=0}^{L-1} d(a^\star_i, b^\star_i)\]

<p>Ce qui nous permet de définir la distance entre deux séquences pour un coût $d$ :</p>

\[D_d(a, b) = \min \{ S_d(a^\star, b^\star) \mid \text{pour tous les alignements } (a^\star, b^\star) \text{ entre } a \text{ et } b\}\]

<p>On en déduit une méthode itérative pour trouver cette distance grâce à l’équation :</p>

\[D_d(a[:i+1], b[:j+1]) = \min \begin{cases}
      D_d(a[:i], b[:j]) + d(a[i], b[j]) &amp; \\
      D_d(a[:i], b[:j + 1]) + d(a[i], -) &amp; \\
      D_d(a[:i + 1], b[:j]) + d(-, b[j]) &amp; \\
    \end{cases}\]

<p>Et le terme général de la matrice d’édition :</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">M</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">M</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="n">d</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span> 
                      <span class="n">M</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="n">d</span><span class="p">(</span><span class="o">-</span><span class="p">,</span> <span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span>
                      <span class="n">M</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">d</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="o">-</span><span class="p">))</span>
</code></pre></div></div>

<h3 id="exemple-du-cas-général">exemple du cas général</h3>

<p>Considérons le coût :</p>

<table>
  <tbody>
    <tr>
      <td> </td>
      <td>A</td>
      <td>C</td>
      <td>G</td>
      <td>T</td>
    </tr>
    <tr>
      <td>A</td>
      <td>0</td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>C</td>
      <td>2</td>
      <td>0</td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>G</td>
      <td>2</td>
      <td>2</td>
      <td>0</td>
      <td> </td>
    </tr>
    <tr>
      <td>T</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>0</td>
    </tr>
    <tr>
      <td>-</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
    </tr>
  </tbody>
</table>

<p>Aller de <code class="language-plaintext highlighter-rouge">ACTGATT</code> (horizontal) à <code class="language-plaintext highlighter-rouge">GCTAATCG</code> (vertical).</p>

<blockquote class="a-faire">
  <p>Créez la matrice d’édition <em>vierge</em> à utiliser</p>
</blockquote>
<details><summary>solution</summary><div>
<table>
  <thead>
    <tr>
      <th> </th>
      <th>-</th>
      <th>A</th>
      <th>C</th>
      <th>T</th>
      <th>G</th>
      <th>A</th>
      <th>T</th>
      <th>T</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>G</td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>C</td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>T</td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>A</td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>A</td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>T</td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>C</td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>G</td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
  </tbody>
</table>

</div></details>

<blockquote class="a-faire">
  <p>Remplissez la première ligne et la première colonne</p>
</blockquote>
<details><summary>solution</summary><div>
<table>
  <tbody>
    <tr>
      <td> </td>
      <td>-</td>
      <td>A</td>
      <td>C</td>
      <td>T</td>
      <td>G</td>
      <td>A</td>
      <td>T</td>
      <td>T</td>
    </tr>
    <tr>
      <td>-</td>
      <td>0</td>
      <td>1</td>
      <td>2</td>
      <td>3</td>
      <td>4</td>
      <td>5</td>
      <td>6</td>
      <td>7</td>
    </tr>
    <tr>
      <td>G</td>
      <td>1</td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>C</td>
      <td>2</td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>T</td>
      <td>3</td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>A</td>
      <td>4</td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>A</td>
      <td>5</td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>T</td>
      <td>6</td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>C</td>
      <td>7</td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>G</td>
      <td>8</td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
  </tbody>
</table>

</div></details>

<blockquote class="a-faire">
  <p>Remplissez le reste de la matrice ligne à ligne</p>
</blockquote>
<details><summary>solution</summary><div>
<table>
  <tbody>
    <tr>
      <td> </td>
      <td>-</td>
      <td>A</td>
      <td>C</td>
      <td>T</td>
      <td>G</td>
      <td>A</td>
      <td>T</td>
      <td>T</td>
    </tr>
    <tr>
      <td>-</td>
      <td>0</td>
      <td>1</td>
      <td>2</td>
      <td>3</td>
      <td>4</td>
      <td>5</td>
      <td>6</td>
      <td>7</td>
    </tr>
    <tr>
      <td>G</td>
      <td>1</td>
      <td>2</td>
      <td>3</td>
      <td>4</td>
      <td>3</td>
      <td>4</td>
      <td>5</td>
      <td>6</td>
    </tr>
    <tr>
      <td>C</td>
      <td>2</td>
      <td>3</td>
      <td>2</td>
      <td>3</td>
      <td>4</td>
      <td>5</td>
      <td>6</td>
      <td>7</td>
    </tr>
    <tr>
      <td>T</td>
      <td>3</td>
      <td>4</td>
      <td>3</td>
      <td>2</td>
      <td>3</td>
      <td>4</td>
      <td>5</td>
      <td>6</td>
    </tr>
    <tr>
      <td>A</td>
      <td>4</td>
      <td>3</td>
      <td>4</td>
      <td>3</td>
      <td>4</td>
      <td>3</td>
      <td>4</td>
      <td>5</td>
    </tr>
    <tr>
      <td>A</td>
      <td>5</td>
      <td>4</td>
      <td>5</td>
      <td>4</td>
      <td>5</td>
      <td>4</td>
      <td>5</td>
      <td>6</td>
    </tr>
    <tr>
      <td>T</td>
      <td>6</td>
      <td>5</td>
      <td>6</td>
      <td>5</td>
      <td>6</td>
      <td>5</td>
      <td>4</td>
      <td>5</td>
    </tr>
    <tr>
      <td>C</td>
      <td>7</td>
      <td>6</td>
      <td>5</td>
      <td>6</td>
      <td>7</td>
      <td>6</td>
      <td>5</td>
      <td>6</td>
    </tr>
    <tr>
      <td>G</td>
      <td>8</td>
      <td>7</td>
      <td>6</td>
      <td>7</td>
      <td>6</td>
      <td>7</td>
      <td>6</td>
      <td>7</td>
    </tr>
  </tbody>
</table>

</div></details>

<blockquote class="a-faire">
  <p>Quel est la distance entre les deux séquences ?</p>
</blockquote>
<details><summary>solution</summary><div>
<p>7</p>

</div></details>

  </div>

</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/cours_informatique/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">cours d'informatique</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">cours d'informatique</li>
</ul>
      </div>

      <div class="footer-col footer-col-2">
<ul class="social-media-list"><li><a href="https://github.com/FrancoisBrucker"><svg class="svg-icon"><use xlink:href="/cours_informatique/assets/minima-social-icons.svg#github"></use></svg> <span class="username">FrancoisBrucker</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>Support de cours/td d'informatique de François Brucker.</p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
