<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
<!-- Begin Jekyll SEO tag v2.7.1 -->
<title>classes et objets | cours d’informatique</title>
<meta name="generator" content="Jekyll v4.2.0">
<meta property="og:title" content="classes et objets">
<meta name="author" content="François Brucker">
<meta property="og:locale" content="en_US">
<meta name="description" content="Support de cours/td d’informatique de François Brucker.">
<meta property="og:description" content="Support de cours/td d’informatique de François Brucker.">
<link rel="canonical" href="/cours_informatique/cours/algorithme-code-theorie/code/programmation-objet/classes-et-objets.html">
<meta property="og:url" content="/cours_informatique/cours/algorithme-code-theorie/code/programmation-objet/classes-et-objets.html">
<meta property="og:site_name" content="cours d’informatique">
<meta name="twitter:card" content="summary">
<meta property="twitter:title" content="classes et objets">
<script type="application/ld+json">
{"description":"Support de cours/td d’informatique de François Brucker.","@type":"WebPage","author":{"@type":"Person","name":"François Brucker"},"url":"/cours_informatique/cours/algorithme-code-theorie/code/programmation-objet/classes-et-objets.html","headline":"classes et objets","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/cours_informatique/assets/main.css">

  <link rel="stylesheet" href="/cours_informatique/assets/custom.css">

  <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet">
<link type="application/atom+xml" rel="alternate" href="/cours_informatique/feed.xml" title="cours d'informatique">
</head>

<body>
<header class="site-header" role="banner">

  <div class="wrapper">
<a class="site-title" rel="author" href="/cours_informatique/">cours d'informatique</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger">
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewbox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"></path>
            </svg>
          </span>
        </label>

        <div class="trigger">
            <a class="page-link" href="/cours_informatique/about"> about </a>
        </div>
      </nav>
</div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post">

  <header class="post-header">
    <h1 class="post-title">classes et objets</h1>Auteurs :
      <ul>
      
        <li><span itemprop="author" itemscope itemtype="http://schema.org/Person"><span class="p-author h-card" itemprop="name">François Brucker</span></span></li>
      
        <li><span itemprop="author" itemscope itemtype="http://schema.org/Person"><span class="p-author h-card" itemprop="name">Célia Châtel</span></span></li>
      
      </ul>
  </header>

  <div class="post-content">
    <blockquote class="chemin">
  <p><a href="/cours_informatique/cours/algorithme-code-theorie/">Algorithme, code et théorie</a> / <a href="/cours_informatique/cours/algorithme-code-theorie/code/">code</a> / <a href="/cours_informatique/cours/algorithme-code-theorie/code/programmation-objet/">programmation objet</a> / <a href="/cours_informatique/cours/algorithme-code-theorie/code/programmation-objet/classes-et-objets.html">classes et objets</a></p>

  <p><strong>prérequis :</strong></p>

  <ul>
    <li><a href="/cours_informatique/cours/algorithme-code-theorie/code/programmation-objet/memoire-et-espace-noms.html">mémoire et espace de noms</a></li>
  </ul>
</blockquote>

<p>Le but de la programmation objet n’est pas d’utiliser des concepts plus ou moins fumeux (classes abstraites, encapsulation et polymorphismes) mais d’écrire du code :</p>

<ul>
  <li>facile à lire</li>
  <li>maintenable</li>
  <li>facile à étendre en ajoutant des fonctionnalités</li>
</ul>

<p>Si un concept objet va à l’encontre de ce principe dans votre programme <strong>NE L’UTILISEZ PAS</strong>. C’est souvent vrai pour l’héritage qui n’a d’utilité que dans des cas très précis…</p>

<blockquote class="note">
  <p>Un objet est un bout de code auquel est associé :</p>

  <ul>
    <li>des fonctionnalités (des méthodes) qui sont communes à tous les objets de sa classe</li>
    <li>des choses à lui tout seul (des attributs) qui lui permettent de se différentier des autres objets de sa classe même s’il a les mêmes fonctionnalités.</li>
  </ul>

</blockquote>

<p>Un objet, n’est donc pas isolé, il partage ses fonctionnalités avec tous les objets de sa <em>classe</em>. Pour s’y retrouver entre, classes, objets méthode et attribut et trouver qui appartient à qui, python utilise les <a href="/cours_informatique/cours/algorithme-code-theorie/code/programmation-objet/memoire-et-espace-noms.html#espace-noms">espaces de noms</a> (<em>namespaces</em>). Cela lui permet de réutiliser le même code pour plusieurs objets.</p>

<h2 id="classes-et-objets">classes et objets</h2>

<p>Lorsque l’on écrit du code python, on ne fait que manipuler des objets. Les entier, les chaines de caractères et même les fonctions peuvent être considérées comme des objets.</p>

<p>De façon générale, on peut considérer que :</p>

<blockquote class="note">
  <p>un <strong>objet</strong> est <strong>une structure de données</strong> sur laquelle on peut <em>effectuer des opérations</em>. Pour pouvoir facilement créer une structure particulière et donner un moyen simple d’effectuer les opérations sur celle-ci, on utilise des <strong>classes</strong> comme patron de ces objets.</p>
</blockquote>

<p>Pour résumer, une classe :</p>

<ul>
  <li>permet de créer un type d’objet (une structure de donnée précise)</li>
  <li>définit les opérations (méthodes) que l’on peut effectuer sur ces objets.</li>
</ul>

<p>Un objet issu d’une certaine classe :</p>

<ul>
  <li>possède la même structure de données que les autres objets de la classe mais les valeurs de celle-ci lui sont uniques : ses <strong>attributs</strong>
</li>
  <li>possède un lien vers les méthodes définies dans sa class et on peut les utiliser via la notation pointée : ses <strong>méthodes</strong>
</li>
</ul>

<p>Exemple :</p>

<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>objet.méthode(paramètre 1, ..., paramètre n)
</code></pre></div></div>

<p>On cherchera <code class="language-plaintext highlighter-rouge">méthode</code> définie pour l’<code class="language-plaintext highlighter-rouge">objet</code>.</p>

<blockquote>
  <p>Le mécanisme pour réaliser ceci utilise les espaces de noms : on cherche le nom <code class="language-plaintext highlighter-rouge">méthode</code> défini dans l’espace de nom de <code class="language-plaintext highlighter-rouge">objet</code></p>
</blockquote>

<h3 id="but">but</h3>

<p>La programmation objet n’a pas pour but de révolutionner votre façon de programmer. Elle permet juste de bien mettre en œuvre les paradigmes de développement que l’on a vu jusqu’à présent. Il est fortement conseiller de <em>coder objet</em> car :</p>

<ul>
  <li>cela favorise la factorisation du code (<a href="https://fr.wikipedia.org/wiki/Ne_vous_r%C3%A9p%C3%A9tez_pas">on ne se répète pas</a>) : on ne défini ses méthodes qu’une seule fois dans les classes</li>
  <li>lisibilité avec la notation <code class="language-plaintext highlighter-rouge">.</code> : on sait clairement à qui s’applique telle ou telle méthode</li>
  <li>compartimentation du code : chaque partie du code et chaque opération est compartimentée, ce qui permet de les tester et des améliorer indépendamment du reste du code.</li>
  <li>plutôt que de créer un gros programme complexe, on crée plein de petits programmes indépendants (les objets) qui interagissent entre eux.</li>
</ul>

<blockquote>
  <p>ces principes sont mis en œuvre de façon différentes selon les langages mais on retrouvera toujours ces notions.</p>
</blockquote>

<h3 id="exemple-dobjets-en-python">exemple d’objets en python</h3>

<h4 id="chaine-de-caractères">chaine de caractères</h4>

<p>Les chaines de caractères sont des objets de la classe (<a href="https://docs.python.org/fr/3/library/string.html">str</a>) :</p>

<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&gt;&gt;&gt; type("une chaine")
&lt;class 'str'&gt;
</code></pre></div></div>

<p>Les méthodes définies dans la classe <code class="language-plaintext highlighter-rouge">str</code>, comme <code class="language-plaintext highlighter-rouge">upper()</code> par exemple sont utilisables par tous les objets de la classe <code class="language-plaintext highlighter-rouge">str</code> (dans l’exemple ci-après par l’objet <code class="language-plaintext highlighter-rouge">"coucou"</code> et l’objet <code class="language-plaintext highlighter-rouge">"toi"</code>) :</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="s">"coucou"</span><span class="p">.</span><span class="n">upper</span><span class="p">()</span>
<span class="s">'COUCOU'</span>
<span class="o">&gt;&gt;&gt;</span> <span class="s">"toi"</span><span class="p">.</span><span class="n">upper</span><span class="p">()</span>
<span class="s">'TOI'</span>
</code></pre></div></div>

<p>La notation pointée permet de dire que c’est la méthode à droite du <code class="language-plaintext highlighter-rouge">.</code> que l’on cherche dans l’objet à gauche du point.</p>

<blockquote class="a-faire">
  <p>Le code suivant produit une erreur. Pourquoi ?</p>
</blockquote>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="n">upper</span><span class="p">(</span><span class="s">"coucou"</span><span class="p">)</span>
<span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">):</span>
  <span class="n">File</span> <span class="s">"&lt;stdin&gt;"</span><span class="p">,</span> <span class="n">line</span> <span class="mi">1</span><span class="p">,</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="nb">NameError</span><span class="p">:</span> <span class="n">name</span> <span class="s">'upper'</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">defined</span>
</code></pre></div></div>

<details><summary>solution</summary><div>
<p>C’est la méthode définie dans la classe <code class="language-plaintext highlighter-rouge">str</code> qui s’appelle <code class="language-plaintext highlighter-rouge">upper</code> qui existe…</p>
</div></details>

<p>Ce qui fait que le résultat est différent lorsque l’on applique la méthode <code class="language-plaintext highlighter-rouge">upper</code> à <code class="language-plaintext highlighter-rouge">"bonjour"</code> et <code class="language-plaintext highlighter-rouge">"toi"</code> est que ces deux objets, bien que de la même classe, sont différents : dan l’un il y a les caractère “bonjour”, dans l’autres les caractères “toi”.</p>

<p>On appelle les spécificités de chaque objet, c’est à dire les valeurs de sa structure de données, des <strong>attributs</strong>.</p>

<blockquote>
  <p>un objet <code class="language-plaintext highlighter-rouge">str</code> est bien plus que juste ses caractères : <strong>Un objet est bien plus que ses composants</strong></p>
</blockquote>

<h4 id="entiers">entiers</h4>

<p>Les entiers sont aussi des objets d’une classe : <code class="language-plaintext highlighter-rouge">int</code>.</p>

<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&gt;&gt;&gt; type(1)
&lt;class 'int'&gt;
</code></pre></div></div>

<p>Contrairement à la classe <code class="language-plaintext highlighter-rouge">str</code>, la classe <code class="language-plaintext highlighter-rouge">int</code> ne définit pas de méthode mais des opérations. Par exemple <code class="language-plaintext highlighter-rouge">__add__</code> définit l’addition d’un entier par un autre objet. C’est pratique que tout soit défini dans la classe , cela nous permettra à nous aussi de faire nos propres additions.</p>

<p>Les deux écritures sont identiques en python, mais bien sur, nous préférerons la première, bien plus simple à écrire et à comprendre :</p>

<ol>
  <li><code class="language-plaintext highlighter-rouge">1 + 2</code></li>
  <li><code class="language-plaintext highlighter-rouge">(1).__add__(2)</code></li>
</ol>

<blockquote>
  <p>Remarquez que l’opération <code class="language-plaintext highlighter-rouge">+</code> n’est pas identique pour <code class="language-plaintext highlighter-rouge">1 + 2</code> et <code class="language-plaintext highlighter-rouge">1.0 + 2</code>. Dans le premier cas c’est l’addition définie dans <code class="language-plaintext highlighter-rouge">int</code> qui est utilisé, dans le second cas c’est celle définie dans <code class="language-plaintext highlighter-rouge">float</code>.</p>
</blockquote>

<h3 id="créer-des-objets">créer des objets</h3>

<p>Pour créer des objets d’une classe, on utilise un <strong>constructeur</strong>.</p>

<p>En python, c’est le nom de la classe. Par Exemples :</p>

<ul>
  <li>
<code class="language-plaintext highlighter-rouge">list(range(5))</code> : crée une liste (de type <code class="language-plaintext highlighter-rouge">list</code>) avec le résultat de la fonction <code class="language-plaintext highlighter-rouge">range</code>
</li>
  <li>
<code class="language-plaintext highlighter-rouge">float("3.1415")</code> : crée un réel à partir de la chaine de caractère <code class="language-plaintext highlighter-rouge">"3.1415"</code>.</li>
  <li>
<code class="language-plaintext highlighter-rouge">int(3.1415)</code> : crée un entier à partir du réel <code class="language-plaintext highlighter-rouge">3.1415</code>.</li>
</ul>

<blockquote>
  <p>Certains objets se créent juste avec leur valeur comme les entiers, les réels ou les chaines de caractères. En python <code class="language-plaintext highlighter-rouge">3</code> est équivalent à <code class="language-plaintext highlighter-rouge">int(3)</code> par exemple.</p>
</blockquote>

<h2 id="outils">outils</h2>

<p>On va utiliser un outil <em>papier</em> (l’<a href="https://fr.wikipedia.org/wiki/UML_(informatique)">uml</a>) et un outil clavier (le python) pour écrire nos classes.</p>

<h3 id="uml">uml</h3>

<p>L’uml est une façon de représenter des objets et des classes. Nous allons l’utiliser pour décrire les classes que nous allons créer.</p>

<blockquote class="note">
  <p>Vous pouvez suivre ce petit <a href="https://www.sparxsystems.fr/resources/tutorials/uml/datamodel.html">tutoriel uml</a> pour comprendre sa notation et son utilité.</p>
</blockquote>

<p>L’uml peut être très compliqué. Nous allons uniquement l’utiliser ici comme une représentation synthétique d’une classe/objet. Vous le verrez dans les exemples ci-dessous mais, en gros, une classe en uml c’est le diagramme :</p>

<p><img src="./assets/classes-1.png" alt="une classe uml" style="margin: auto;display: block;"></p>

<ul>
  <li>pour chaque attribut on pourra préciser le <em>type</em> (entier, chaine de caractère, une classe particulière d’objet, …) si c’est important</li>
  <li>pour chaque méthode on donnera sa <a href="https://developer.mozilla.org/fr/docs/Glossaire/Signature/Fonction">signature</a> complète (son nom et ses paramètres) pour que l’on puisse l’utiliser.</li>
</ul>

<h3 id="python">python</h3>

<p>Comme le python va être notre langage de programmation, regardons quelques convention d’usage lorsque l’on programme objet en python.</p>

<blockquote>
  <p>En python, beaucoup de choses sont des <a href="https://en.wikipedia.org/wiki/Convention_over_configuration">conventions</a> (variable privée, premier nom est self, …) mais tout le monde s’y tient car la lecture du code en devient aisée.</p>
</blockquote>

<p>N’hésitez pas à jeter un coup d’œil au <a href="https://docs.python.org/3/tutorial/classes.html">tuto python sur les classes de python</a>. Ce cours est là pour vous montrer tout ce qu’il y a dedans, à part (peut-être) la partie sur l’héritage et les itérateurs.</p>

<h4 id="constructeur">constructeur</h4>

<p>En python, le constructeur d’une classe sera <strong>toujours</strong> la méthode : <code class="language-plaintext highlighter-rouge">__init__</code>. C’est une méthode spéciale.</p>

<h4 id="variables-spéciales">variables spéciales</h4>

<p>En regardant du code python, vous allez voir beaucoup de noms qui commencent par des <code class="language-plaintext highlighter-rouge">_</code>. Ils sont une signification spéciale en python :</p>

<ul>
  <li>qui commencent par <code class="language-plaintext highlighter-rouge">_</code> : non public. Ce sont des attributs ou méthodes que l’utilisateur n’est pas sensé utiliser. Ils sont uniquement là pour le bon fonctionnement de la classe.</li>
  <li>qui commencent par <code class="language-plaintext highlighter-rouge">__</code> : privé (non disponibles pour les descendants lorsque l’on fait de l’héritage). Ces attributs ou méthodes sont réservé exclusivement à être utilisé dans la classe.</li>
  <li>qui commencent et finissent par <code class="language-plaintext highlighter-rouge">__</code> : méthodes spécifiques de python qui ont un sens (par exemple <strong>str</strong>, <strong>eq</strong>), elles sont utilisées dans des cas précis et documentés.</li>
</ul>

<h4 id="espace-de-nom-namespaces">espace de nom (namespaces)</h4>

<p>La gestion des noms en python se fait via des <a href="/cours_informatique/cours/algorithme-code-theorie/code/programmation-objet/memoire-et-espace-noms.html#espace-noms">espaces de noms</a>. L’ordre dans lequel ces noms sons cherché pour être associé à un objet est logique et se règle en sachant quel namespace est utilisé.</p>

<h2 id="premier-exemple--le-compteur">Premier exemple : le Compteur</h2>

<p>On souhaite créer un objet <code class="language-plaintext highlighter-rouge">Compteur</code> qui retient le compte de quelque chose et est capable d’ajouter 1 à son compte quand on le lui demande.</p>

<p>On va tenter de proposer une modélisation UML de cet objet simple, puis de le coder en python.</p>

<h3 id="code-dutilisation">code d’utilisation</h3>

<p>Cette modélisation doit être capable de répondre au code suivant, dans le fichier <em>“main.py”</em> :</p>

<style>
    table, td, tr, th, pre {
        padding:0;
        margin:0;
        border:none
    }
</style>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><table class="rouge-table"><tbody><tr>
<td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre></td>
<td class="code"><pre><span class="kn">from</span> <span class="nn">compteur</span> <span class="kn">import</span> <span class="n">Compteur</span>
    
<span class="n">c1</span> <span class="o">=</span> <span class="n">Compteur</span><span class="p">()</span>
<span class="n">c2</span> <span class="o">=</span> <span class="n">Compteur</span><span class="p">()</span>
<span class="n">c1</span><span class="p">.</span><span class="n">ajoute</span><span class="p">()</span>
<span class="n">c2</span><span class="p">.</span><span class="n">ajoute</span><span class="p">()</span>
<span class="n">c1</span><span class="p">.</span><span class="n">ajoute</span><span class="p">()</span>

<span class="k">print</span><span class="p">(</span><span class="n">c2</span><span class="p">.</span><span class="n">donne_valeur</span><span class="p">())</span>
</pre></td>
</tr></tbody></table></code></pre></figure>

<h4 id="analyse-du-programme">analyse du programme</h4>

<p>C’est du python. On va essayer de comprendre le code pour produire une représentation uml de la classe <code class="language-plaintext highlighter-rouge">Compteur</code>.</p>

<ol>
  <li>on importe le mot <code class="language-plaintext highlighter-rouge">Compteur</code> et on l’exécute 2 fois pour l’affecter à 2 noms différents : cela <strong>ne doit pas être</strong> une fonction normale, sinon <code class="language-plaintext highlighter-rouge">c1</code> et <code class="language-plaintext highlighter-rouge">c2</code> seraient identiques.</li>
  <li>on suppose donc que <code class="language-plaintext highlighter-rouge">Compteur</code> est une <em>classe</em> et que l’on a crée 2 <strong>objets</strong> <code class="language-plaintext highlighter-rouge">c1</code> et <code class="language-plaintext highlighter-rouge">c2</code>.</li>
</ol>

<p><strong>Les objets d’une classe partagent les mêmes méthodes</strong>, donc :</p>

<ul>
  <li>
<code class="language-plaintext highlighter-rouge">ajoute()</code> doit faire la même chose pour <code class="language-plaintext highlighter-rouge">c1</code> et <code class="language-plaintext highlighter-rouge">c2</code>
</li>
  <li>je dois pouvoir écrire : <code class="language-plaintext highlighter-rouge">c1.donne_valeur()</code>, même si ce n’est pas écrit dans le code.</li>
</ul>

<p>De plus, comme j’appelle <code class="language-plaintext highlighter-rouge">c1.ajoute()</code> et <code class="language-plaintext highlighter-rouge">c2.ajoute()</code> sans paramètre on doit surement modifier un attribut des objets <code class="language-plaintext highlighter-rouge">c1</code> et <code class="language-plaintext highlighter-rouge">c2</code>, car les <strong>attributs sont spécifique à chaque objet d’une classe</strong></p>

<h4 id="exécution-du-programme">exécution du programme</h4>

<p>A la lecture du code, on <em>a envie</em> que le code fasse ça :</p>

<ol>
  <li>on crée 2 compteurs</li>
  <li>on en incrémente 1 deux fois et l’autre qu’une seule fois</li>
  <li>on affiche à l’écran la valeur d’un des compteurs (celui qui a été incrémenté 1 fois) : 1</li>
</ol>

<h3 id="schéma-uml">schéma uml</h3>

<p>Un objet est un ensemble de fonctionnalités récurrente dans un programme. Ici un
compteur. Les fonctionnalités sont :</p>

<ul>
  <li>ajouter une unité à un compteur</li>
  <li>connaître la valeur du compteur.</li>
</ul>

<p>Pour que l’on puisse avoir plusieurs compteurs (si on n’a qu’un seul compteur, ce n’est pas la peine de faire des objets), il faut que chaque compteur ait une valeur à lui.</p>

<p>On a donc ce qu’il faut pour notre classe :</p>

<ul>
  <li>un nom : Compteur</li>
  <li>des méthodes (<strong>= fonctionnalités = ce qui est pareil pour tous les objets</strong>) : <code class="language-plaintext highlighter-rouge">ajoute</code> et <code class="language-plaintext highlighter-rouge">donne_valeur</code>
</li>
  <li>un attribut (<strong>= ce qui est différent pour chaque objet</strong>) : <code class="language-plaintext highlighter-rouge">value</code>
</li>
</ul>

<p>Pour créer un diagramme uml, je commence toujours par le nom de la classe, puis j’imagine comment je vais l’utiliser (ici incrémenter un compteur). Une fois que je sais comment je vais l’utiliser, je vois ce qu’il faut ajouter à chaque objet pour qu’il puisse stocker les informations nécessaires à son utilisation : ce sont les attributs (ici un entier pour stocker le nombre de fois où on l’a incrémenté).</p>

<p>Ce qui donne le diagramme uml du compteur :</p>

<p><img src="./assets/classes-2.png" alt="compteur" style="margin: auto;display: block;"></p>

<blockquote>
  <p>On a utilisé ici un <code class="language-plaintext highlighter-rouge">_</code> en début de nom de la variable <code class="language-plaintext highlighter-rouge">valeur</code> pour signifier qu’elle est <em>privée</em>, c’est à dire que personne d’autre n’a le droit de l’utiliser à part l’objet. Cette convention n’est pas indispensable à utiliser car il est parfois un peut flou de savoir si telle ou telle attribut et <em>privé</em> ou <em>publique</em>…</p>
</blockquote>

<h3 id="code-python">code python</h3>

<p>La classe python qui correspond à l’uml précédent est celui-ci, contenu dans le fichier <em>“compteur.py”</em>, placé dans le même dossier que le fichier <em>“main.py”</em> :</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">Compteur</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">_valeur</span> <span class="o">=</span> <span class="mi">0</span>
           
    <span class="k">def</span> <span class="nf">ajoute</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">_valeur</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">_valeur</span> <span class="o">+</span> <span class="mi">1</span>
    
    <span class="k">def</span> <span class="nf">donne_valeur</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="p">.</span><span class="n">_valeur</span>
</code></pre></div></div>

<p>La définition d’une classe est un bloc python :</p>

<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
class &lt;nom de la classe&gt;:
    def __init__(self, paramètre 1, ..., paramètre n):
        instruction 1
        ...
        instruction n
    def méthode 1(self, paramètre 1, ..., paramètre n):
        instruction 1
        ...
        instruction n
        ...
    def méthode n(self, paramètre 1, ..., paramètre n):
        instruction 1
        ...
        instruction n
</code></pre></div></div>

<ul>
  <li>
<code class="language-plaintext highlighter-rouge">__init__</code> est le constructeur. L’usage courant est de déclarer tous les attributs d’un objets dans celui-ci.</li>
  <li>deux méthodes : <code class="language-plaintext highlighter-rouge">ajoute</code> et <code class="language-plaintext highlighter-rouge">donne_valeur</code>
</li>
</ul>

<blockquote class="note">
  <p>En python, lorsque l’on définit une méthode d’un classe, le 1er paramètre de chaque méthode est <strong>toujours</strong> <code class="language-plaintext highlighter-rouge">self</code>. A l’exécution, python donnera à ce paramètre l’objet qui appelle la méthode, on ne le voit pas lorsque l’on écrit le code.</p>
</blockquote>

<p>Par exemple dans le code la ligne <code class="language-plaintext highlighter-rouge">c1.ajoute()</code> sera transformée par python en : <code class="language-plaintext highlighter-rouge">Compteur.ajoute(c1)</code> qui peut se lire : on exécute la fonction <code class="language-plaintext highlighter-rouge">ajoute</code> de l’espace de nom du bloc <code class="language-plaintext highlighter-rouge">Compteur</code> avec comme paramètre <code class="language-plaintext highlighter-rouge">c1</code>.</p>

<p>La première façon d’écrire (<code class="language-plaintext highlighter-rouge">c1.ajoute()</code>) est plus simple à comprendre <strong>pour un humain</strong> et évite les erreurs (la méthode est appliquée à l’objet à gauche du point), alors que la seconde est plus facile à comprendre <strong>pour un ordinateur</strong> en utilisant les espaces de noms et le passage explicite de l’objet appelant.</p>

<blockquote>
  <p><code class="language-plaintext highlighter-rouge">self</code> qui peut souvent paraître magique. Ce premier paramètre est l’objet qui a appelé la méthode (à gauche du <em>.</em>). C’est la manière explicite de python de montrer quel objet est utilisé. Vous pouvez appeler ce premier paramètre comme vous voulez, mais c’est <strong>très très</strong> déconseillé car votre code en deviendra
moins lisible (tout le monde utilise le nom <code class="language-plaintext highlighter-rouge">self</code>).</p>
</blockquote>

<h3 id="exécution-du-code">exécution du code</h3>

<blockquote>
  <p>Lorsque l’on définit une classe, python lui associe un espace de noms. Les différents noms définit dans la classes y seront consignés.
{ .note}</p>
</blockquote>

<p>Dans l’exemple du compteur, lorsque le fichier <em>“main.py”</em> importe le fichier <em>“compteur.py”</em>, la classe <code class="language-plaintext highlighter-rouge">Compteur</code> y est définie. Dans son namespace seront alors placés les noms :</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">__init__</code></li>
  <li><code class="language-plaintext highlighter-rouge">ajoute</code></li>
  <li><code class="language-plaintext highlighter-rouge">donne_valeur</code></li>
</ul>

<p>Qui correspondent aux noms ds 3 méthodes définies dans la classe.</p>

<p>De même :</p>

<blockquote class="note">
  <p>Lorsque l’on crée un objet, python lui associe un espace de noms.</p>

  <p>Son espace de nom parent est celui de sa classe.</p>
</blockquote>

<p>L’espace de noms de l’objet est important, il est utilisé à chaque notation pointée. Par exemple dans la méthode <code class="language-plaintext highlighter-rouge">__init__</code>, la ligne <code class="language-plaintext highlighter-rouge">self._valeur = 0</code> crée un objet entier (valant 0) et l’affecte au nom <code class="language-plaintext highlighter-rouge">_valeur</code> dans l’espace de nom de l’objet nommé <code class="language-plaintext highlighter-rouge">self</code>.</p>

<p>Reprenons le code de <em>“main.py”</em>, et exécutons le ligne à ligne :</p>

<ol>
  <li>lorsque python commence l’exécution du fichier, il crée le namespace global. C’est le namespace le plus haut.</li>
  <li>
<code class="language-plaintext highlighter-rouge">from compteur import Compteur</code> :
    <ol>
      <li>cherche un fichier <em>“compteur.py”</em> dans le répertoire courant.</li>
      <li>on crée un espace de nom <code class="language-plaintext highlighter-rouge">compteur</code>
</li>
      <li>Python exécute le fichier <em>“compteur.py”</em> (il lit chaque ligne) dans l’espace de nom <code class="language-plaintext highlighter-rouge">compteur</code>.</li>
      <li>Une fois ceci fait, il prend le nom <code class="language-plaintext highlighter-rouge">Compteur</code> dans cet espace et l’ajoute dans l’espace de nom <code class="language-plaintext highlighter-rouge">global</code>. On peut donc utiliser le nom <code class="language-plaintext highlighter-rouge">Compteur</code>
</li>
    </ol>
  </li>
  <li>
<code class="language-plaintext highlighter-rouge">c1 = Compteur()</code> :
    <ul>
      <li>en informatique <code class="language-plaintext highlighter-rouge">=</code> n’est pas symétrique. A gauche un nom à droite un objet. Ici ceci signifie que l’on ajoute le nom <code class="language-plaintext highlighter-rouge">c1</code> au namespace global et que sa valeur sera le résultat de <code class="language-plaintext highlighter-rouge">Compteur()</code>
</li>
      <li>
<code class="language-plaintext highlighter-rouge">Compteur()</code> : est le résultat de l’exécution du nom <code class="language-plaintext highlighter-rouge">Compteur</code>. Les parenthèses (et les paramètres éventuels) après un nom l’exécute. (si on avait juste écrit <code class="language-plaintext highlighter-rouge">c1 = Compteur</code> on aurait alors eu un nom <code class="language-plaintext highlighter-rouge">c1</code> qui sera égal à la classe <code class="language-plaintext highlighter-rouge">Compteur</code>).</li>
      <li>
<code class="language-plaintext highlighter-rouge">Compteur()</code> Exécuter une classe revient à :
        <ul>
          <li>créer un objet vide et lui associer un espace de nom vierge</li>
          <li>chercher la méthode <code class="language-plaintext highlighter-rouge">__init__</code> de la classe et l’exécuter en passant le nouvel objet en premier paramètre :
            <ul>
              <li>pour exécuter une fonction on crée un namespace pour elle.</li>
              <li>on place le nom <code class="language-plaintext highlighter-rouge">self</code> qui vaut ici le nouveau namespace créé</li>
              <li>la première ligne crée le nom <code class="language-plaintext highlighter-rouge">_valeur</code> dans le namespace de l’objet <code class="language-plaintext highlighter-rouge">self</code>
</li>
              <li>la fonction étant terminée, on supprime le namespace de la fonction (qui contenait le nom <code class="language-plaintext highlighter-rouge">self</code>)</li>
              <li>on rend l’objet</li>
            </ul>
          </li>
        </ul>
      </li>
      <li>l’objet créé est associé au nom <code class="language-plaintext highlighter-rouge">c1</code> dans le namespace <code class="language-plaintext highlighter-rouge">global</code>
</li>
    </ul>
  </li>
  <li>idem que la ligne précédente avec un nouvel objet</li>
  <li>
<code class="language-plaintext highlighter-rouge">c1.ajoute()</code> : python cherche le nom <code class="language-plaintext highlighter-rouge">ajoute</code> dans l’espace de nom de l’objet nommé <code class="language-plaintext highlighter-rouge">c1</code>.
    <ol>
      <li>Il regarde d’abord dans l’objet de nom <code class="language-plaintext highlighter-rouge">c1</code>. Ça n’y est pas (dans l’espace de noms de <code class="language-plaintext highlighter-rouge">c1</code> il n’y a que le nom <code class="language-plaintext highlighter-rouge">_valeur</code>).</li>
      <li>Il regarde donc dans l’espace de nom parent : l’espace de nom de de la classe. Il y est puisqu’<code class="language-plaintext highlighter-rouge">ajoute</code> est une fonction définie.</li>
      <li>On peut maintenant exécuter cette fonction. Comme pour toutes les fonctions définies dans une classe et utilisée par un objet, le premier paramètre est l’objet (le self). Ce mécanisme permet d’utiliser les noms définis dans l’espace de noms de l’objet (ici la valeur de l’objet).</li>
    </ol>
  </li>
  <li>idem que la ligne d’avant</li>
  <li>idem que la ligne d’avant</li>
  <li>
<code class="language-plaintext highlighter-rouge">print(c1.donne_valeur())</code> : pareil que la ligne 4. <code class="language-plaintext highlighter-rouge">donne_valeur</code> est défini dans la classe. On essaye ici d’afficher à l’écran le résultat de l’exécution de la méthode <code class="language-plaintext highlighter-rouge">donne_valeur</code> appliquée à l’objet de nom <code class="language-plaintext highlighter-rouge">c1</code>
</li>
</ol>

<blockquote class="note">
  <p><code class="language-plaintext highlighter-rouge">objet.nom</code> est <strong>toujours</strong> résolu de façon identique en python : on commence par chercher le nom dans l’objet et si on ne le trouve pas on cherche dans sa classe</p>
</blockquote>

<h2 id="deuxième-exemple--compteur-à-pas-choisi">Deuxième exemple : Compteur à pas choisi</h2>

<p>On souhaite maintenant pouvoir choisir le pas de notre compteur (c’est-à-dire ajouter 2 à chaque fois plutôt que 1 par exemple).</p>

<p>Pour faire cela on va ajouter un paramètre dans le constructeur.</p>

<h3 id="ajout-dun-paramètre-dans-le-constructeur">ajout d’un paramètre dans le constructeur</h3>

<p>Nous allons ajouter un paramètre dans le constructeur pour que chaque compteur puisse connaitre son pas :</p>

<p>Fichier <em>“compteur.py”</em> :</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">Compteur</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pas</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">_valeur</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">pas</span> <span class="o">=</span> <span class="n">pas</span>

<span class="c1"># ...           
</span></code></pre></div></div>

<blockquote>
  <p>On a pas utilisé d’<code class="language-plaintext highlighter-rouge">_</code> pour la définition de l’attribut <code class="language-plaintext highlighter-rouge">pas</code> (on a défini <code class="language-plaintext highlighter-rouge">pas</code> et non <code class="language-plaintext highlighter-rouge">_pas</code>). Son utilisation n’est qu’une convention.
De plus, si un utilisateur modifie le pas sans utiliser de méthodes (<code class="language-plaintext highlighter-rouge">c1.pas = 12</code> par exemple dans le programme), ce n’est pas bien grave.</p>
</blockquote>

<p>Il faut alors changer le code pour construire les objets avec ce nouveau paramètre :</p>

<p>Fichier <em>“main.py”</em> :</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">compteur</span> <span class="kn">import</span> <span class="n">Compteur</span>
    
<span class="n">c1</span> <span class="o">=</span> <span class="n">Compteur</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="n">c2</span> <span class="o">=</span> <span class="n">Compteur</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="c1">#...
</span></code></pre></div></div>

<blockquote class="attention">
  <p>Notez bien que le premier paramètre de la définition de la classe est <strong>TOUJOURS</strong> self. Le premier paramètre de l’utilisation de la méthode est alors le second dans sa définition.</p>
</blockquote>

<p>Et il faut modifier la méthode <code class="language-plaintext highlighter-rouge">ajoute(self)</code> pour qu’elle prenne en compte le pas :</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">Compteur</span><span class="p">:</span>
    <span class="c1"># ...
</span>    <span class="k">def</span> <span class="nf">ajoute</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">_valeur</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">_valeur</span> <span class="o">+</span> <span class="bp">self</span><span class="p">.</span><span class="n">pas</span>
    <span class="c1"># ...
</span></code></pre></div></div>

<blockquote class="note">
  <p>On définira <strong>toujours</strong> les différents attributs de l’objet dans le constructeur <code class="language-plaintext highlighter-rouge">__init__</code>.
On le fera de cette façon :</p>

  <div class="language-python highlighter-rouge">
<div class="highlight"><pre class="highlight"><code><span class="bp">self</span><span class="p">.</span><span class="n">nom_attribut</span> <span class="o">=</span> <span class="n">valeur_attribut</span>
</code></pre></div>  </div>

</blockquote>

<p>Cette façon de faire :</p>

<ul>
  <li>attributs dans les objets</li>
  <li>méthodes (fonctions) dans les classes</li>
</ul>

<p>permet à chaque objet (le paramètre <code class="language-plaintext highlighter-rouge">self</code>) d’être différent tout en utilisant les mêmes méthodes.</p>

<blockquote class="note">
  <p>Lors de l’utilisation de méthode l’objet est passé en premier paramètre, ce qui permet de réutiliser tous ses attributs.</p>
</blockquote>

<h3 id="paramètre-par-défaut">paramètre par défaut</h3>

<p>Le soucis avec la méthode précédente, c’est que même si le pas est de <code class="language-plaintext highlighter-rouge">1</code> il faut le définir dans la construction de l’objet. Nous allns hanger ça en mettant un <a href="https://docs.python.org/3/tutorial/controlflow.html#default-argument-values">paramètre par défaut</a>.</p>

<p>En python cela donne (fichier <em>“compteur.py”</em>) :</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">Compteur</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pas</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">_valeur</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">pas</span> <span class="o">=</span> <span class="n">pas</span>

    <span class="k">def</span> <span class="nf">ajoute</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">_valeur</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">_valeur</span> <span class="o">+</span> <span class="bp">self</span><span class="p">.</span><span class="n">pas</span>

    <span class="k">def</span> <span class="nf">donne_valeur</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="p">.</span><span class="n">_valeur</span>
</code></pre></div></div>

<p>On peut utiliser deux fois le même nom <code class="language-plaintext highlighter-rouge">pas</code> car ils sont dans des espaces de noms différent :</p>

<ul>
  <li>un dans l’espace de nom de la fonction (créé lorsque l’on exécute la fonction et détruit à la fin. Attention : on détruit les noms pas les objets)</li>
  <li>un dans l’objet lui-même.</li>
</ul>

<p>Le code final de <em>“main.py”</em> pourra alors être :</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">compteur</span> <span class="kn">import</span> <span class="n">Compteur</span>
    
<span class="n">c1</span> <span class="o">=</span> <span class="n">Compteur</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="n">c2</span> <span class="o">=</span> <span class="n">Compteur</span><span class="p">()</span>
<span class="n">c1</span><span class="p">.</span><span class="n">ajoute</span><span class="p">()</span>
<span class="n">c2</span><span class="p">.</span><span class="n">ajoute</span><span class="p">()</span>
<span class="n">c1</span><span class="p">.</span><span class="n">ajoute</span><span class="p">()</span>

<span class="k">print</span><span class="p">(</span><span class="n">c2</span><span class="p">.</span><span class="n">donne_valeur</span><span class="p">())</span>
</code></pre></div></div>

<h3 id="valeur-initiale">valeur initiale</h3>

<p>Finissons cette partie en ajoutant une valeur initiale à notre compteur :</p>

<p>Fichier <em>“compteur.py”</em> :</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">Compteur</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pas</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">valeur</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">_valeur</span> <span class="o">=</span> <span class="n">valeur</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">pas</span> <span class="o">=</span> <span class="n">pas</span>

    <span class="k">def</span> <span class="nf">ajoute</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">_valeur</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">_valeur</span> <span class="o">+</span> <span class="bp">self</span><span class="p">.</span><span class="n">pas</span>

    <span class="k">def</span> <span class="nf">donne_valeur</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="p">.</span><span class="n">_valeur</span>
</code></pre></div></div>

<p>On peut créer de compteur de plein de façon différente maintenant. Par exemple :</p>

<ul>
  <li>
<code class="language-plaintext highlighter-rouge">Compteur()</code> : créera un compteur de <code class="language-plaintext highlighter-rouge">valeur=0</code> et de <code class="language-plaintext highlighter-rouge">pas=1</code>,</li>
  <li>
<code class="language-plaintext highlighter-rouge">Compteur(3)</code> : créera un compteur de <code class="language-plaintext highlighter-rouge">valeur=0</code> et de <code class="language-plaintext highlighter-rouge">pas=3</code>,</li>
  <li>
<code class="language-plaintext highlighter-rouge">Compteur(3, 12)</code> : créera un compteur de <code class="language-plaintext highlighter-rouge">valeur=12</code> et de <code class="language-plaintext highlighter-rouge">pas=3</code>,</li>
  <li>
<code class="language-plaintext highlighter-rouge">Compteur(pas=3)</code> : créera un compteur de <code class="language-plaintext highlighter-rouge">valeur=0</code> et de <code class="language-plaintext highlighter-rouge">pas=3</code>,</li>
  <li>
<code class="language-plaintext highlighter-rouge">Compteur(valeur=12)</code> : créera un compteur de <code class="language-plaintext highlighter-rouge">valeur=12</code> et de <code class="language-plaintext highlighter-rouge">pas=1</code>
</li>
</ul>

<h3 id="pour-aller-plus-loin">Pour aller plus loin</h3>

<p>Python dispose de méthodes spéciales qui peuvent être invoquées en utilisant une syntaxe particulière. On a déjà vu <code class="language-plaintext highlighter-rouge">__init__</code>, mais il y en a d’autres.</p>

<p>Vous en trouverez une liste
exhaustive dans la <a href="https://docs.python.org/3/reference/datamodel.html#special-method-names">documentation officielle</a>. Nous allons
en utiliser ici quelques-unes sur notre classe. Ces méthodes se présentent toujours sous la forme <code class="language-plaintext highlighter-rouge">__nom_de_la_methode__</code>.</p>

<p>Essayez de taper dans le fichier <em>“main.py”</em> :</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">c</span> <span class="o">=</span> <span class="n">Compteur</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
</code></pre></div></div>

<p>Vous devriez obtenir quelque chose comme :</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&lt;</span><span class="n">__main__</span><span class="p">.</span><span class="n">Compteur</span> <span class="nb">object</span> <span class="n">at</span> <span class="mh">0x107149100</span><span class="o">&gt;</span>
</code></pre></div></div>

<p>La fonction <code class="language-plaintext highlighter-rouge">print</code> appelle la méthode <code class="language-plaintext highlighter-rouge">__str__</code> de notre classe. En effet, <code class="language-plaintext highlighter-rouge">print</code> affiche à l’écran une chaine de caractère. L’Objet à afficher est donc converti en <code class="language-plaintext highlighter-rouge">str</code> avant.</p>

<p>Comme nous n’avons pas défini cette méthode, c’est donc la méthode par défaut de tous les objets python qui est appelée. Comme vous le constatez, elle n’est pas très intéressante pour nous. Il faut donc la définir dans notre classe.</p>

<p>On va faire en sorte de pouvoir lire les valeur de notre objet sous la forme d’une chaine de caractère :</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">Compteur</span>
    <span class="c1"># ...
</span>    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s">"Compteur(pas="</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">pas</span><span class="p">)</span> <span class="o">+</span> <span class="s">", valeur="</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">_valeur</span><span class="p">)</span> <span class="o">+</span> <span class="s">")"</span>
</code></pre></div></div>

<p>Avec cette nouvelle méthode, le code précédent donne :</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">Compteur</span><span class="p">(</span><span class="n">pas</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">valeur</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</code></pre></div></div>

<p>Ce qui est bien plus lisible.</p>

<p>Finissons en essayons de comparer deux compteurs :</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">c1</span> <span class="o">=</span> <span class="n">Compteur</span><span class="p">(</span><span class="n">valeur</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">c2</span> <span class="o">=</span> <span class="n">Compteur</span><span class="p">(</span><span class="n">valeur</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">c1</span> <span class="o">&lt;</span> <span class="n">c2</span>
</code></pre></div></div>

<p>Si on testez ça avec votre code tel qu’il est, on obtiendra :</p>

<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>TypeError: '&lt;' not supported between instances of 'Compteur' and 'Compteur'
</code></pre></div></div>

<p>Python vous explique qu’il ne connaît pas l’opérateur <code class="language-plaintext highlighter-rouge">&lt;</code> pour les objets de notre classe. Pour pouvoir utiliser
directement les opérateurs <code class="language-plaintext highlighter-rouge">&lt;</code> et <code class="language-plaintext highlighter-rouge">&gt;</code>, il faut définir respectivement les méthodes <code class="language-plaintext highlighter-rouge">__lt__(self, other)</code> et
<code class="language-plaintext highlighter-rouge">__gt__(self, other)</code>. On pourra aussi ajouter <code class="language-plaintext highlighter-rouge">__eq__(self, other)</code> pour tester l’égalité.</p>

<p>Nous allons ici juste comparer deux compteur pour la comparaison “plus petit que” :</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">Compteur</span>
    <span class="c1"># ...
</span>    <span class="k">def</span> <span class="nf">__lt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="p">.</span><span class="n">valeur</span> <span class="o">&lt;</span> <span class="n">other</span><span class="p">.</span><span class="n">valeur</span>
</code></pre></div></div>

<blockquote class="note">
  <p>On peut maintenant comparer 2 compteurs, ou un compteur à toute autre objet qui possède l’attribut valeur.</p>
</blockquote>

<h3 id="code">code</h3>

<p>Les deux fichiers sont dans le même dossier <em>“compteur”</em> qui fait office de projet vscode.</p>

<p>Fichier <em>“compteur.py”</em> :</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">Compteur</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pas</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">valeur</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">_valeur</span> <span class="o">=</span> <span class="n">valeur</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">pas</span> <span class="o">=</span> <span class="n">pas</span>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s">"Compteur(pas="</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">pas</span><span class="p">)</span> <span class="o">+</span> <span class="s">", valeur="</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">_valeur</span><span class="p">)</span> <span class="o">+</span> <span class="s">")"</span>

    <span class="k">def</span> <span class="nf">__lt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="p">.</span><span class="n">_valeur</span> <span class="o">&lt;</span> <span class="n">other</span><span class="p">.</span><span class="n">_valeur</span>
        
    <span class="k">def</span> <span class="nf">ajoute</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">_valeur</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">_valeur</span> <span class="o">+</span> <span class="bp">self</span><span class="p">.</span><span class="n">pas</span>

    <span class="k">def</span> <span class="nf">donne_valeur</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="p">.</span><span class="n">valeur</span>        
</code></pre></div></div>

<p>Fichier <em>“main.py”</em> :</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="kn">from</span> <span class="nn">compteur</span> <span class="kn">import</span> <span class="n">Compteur</span>
    
<span class="n">c1</span> <span class="o">=</span> <span class="n">Compteur</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="n">c2</span> <span class="o">=</span> <span class="n">Compteur</span><span class="p">()</span>
<span class="n">c1</span><span class="p">.</span><span class="n">ajoute</span><span class="p">()</span>
<span class="n">c2</span><span class="p">.</span><span class="n">ajoute</span><span class="p">()</span>
<span class="n">c1</span><span class="p">.</span><span class="n">ajoute</span><span class="p">()</span>

<span class="k">print</span><span class="p">(</span><span class="n">c1</span><span class="p">.</span><span class="n">donne_valeur</span><span class="p">(),</span> <span class="n">c1</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">c2</span><span class="p">.</span><span class="n">donne_valeur</span><span class="p">(),</span> <span class="n">c2</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="n">c1</span> <span class="o">&lt;</span> <span class="n">c2</span><span class="p">)</span>
</code></pre></div></div>

  </div>

</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/cours_informatique/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">cours d'informatique</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">cours d'informatique</li>
</ul>
      </div>

      <div class="footer-col footer-col-2">
<ul class="social-media-list"><li><a href="https://github.com/FrancoisBrucker"><svg class="svg-icon"><use xlink:href="/cours_informatique/assets/minima-social-icons.svg#github"></use></svg> <span class="username">FrancoisBrucker</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>Support de cours/td d'informatique de François Brucker.</p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
