<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.7.1 -->
<title>Composition et agrégation corrigé | cours d’informatique</title>
<meta name="generator" content="Jekyll v4.2.0" />
<meta property="og:title" content="Composition et agrégation corrigé" />
<meta name="author" content="François Brucker" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Support de cours/td d’informatique à l’école centrale marseille." />
<meta property="og:description" content="Support de cours/td d’informatique à l’école centrale marseille." />
<link rel="canonical" href="/cours_informatique/cours/developpement_objet/composition_et_agregation_corrige.html" />
<meta property="og:url" content="/cours_informatique/cours/developpement_objet/composition_et_agregation_corrige.html" />
<meta property="og:site_name" content="cours d’informatique" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Composition et agrégation corrigé" />
<script type="application/ld+json">
{"description":"Support de cours/td d’informatique à l’école centrale marseille.","@type":"WebPage","author":{"@type":"Person","name":"François Brucker"},"url":"/cours_informatique/cours/developpement_objet/composition_et_agregation_corrige.html","headline":"Composition et agrégation corrigé","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/cours_informatique/assets/main.css">

  <link rel="stylesheet" href="/cours_informatique/assets/custom.css"><link type="application/atom+xml" rel="alternate" href="/cours_informatique/feed.xml" title="cours d'informatique" /><!-- Mathjax Support -->
  <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"] ],
        processEscapes: true
      }
    });
  </script>
  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
</head>

<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/cours_informatique/">cours d&#39;informatique</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger">
            <a class="page-link" href="/cours_informatique/about"> about </a>
        </div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post">

  <header class="post-header">
    <h1 class="post-title">Composition et agrégation corrigé</h1></p>Auteur : <span itemprop="author" itemscope itemtype="http://schema.org/Person"><span class="p-author h-card" itemprop="name">François Brucker</span></span></p>
  </header>

  <div class="post-content">
    <h2 id="but">But</h2>

<p>Eléments de corrigé de la séance  <a href="/cours_informatique/cours/developpement_objet/composition_et_agregation.html">composition et agrégation</a>.</p>

<h2 id="elements-de-cours">Elements de cours</h2>

<p>Composition et agrégation permettent de lier des classes ensembles, et plus principalement lorsqu’une classe admet comme attribut des objets de l’autre classe.</p>

<p>On considère deux cas d’usage :</p>

<ul>
  <li><em>agrégation</em> : quand les objets utilisés sont créés en dehors de la classe,</li>
  <li><em>composition</em> : quand les objets utilisés sont créés dans le constructeur de la classe qui les utilise.</li>
</ul>

<p>Il est important de comprendre que si des objets n’ont pas été crée dans la classe qui l’utilise, ils peuvent être connus par d’autres méthode du programme et donc être modifiées par ceux-ci.
Il se passe la même chose lorsqu’une méthode retourne un objet qui est un attribut. Une fois qu’un objet a été <em>donné</em> au monde extérieur on ne contrôle plus son état et il peut être utilisé a priori par n’importe quoi d’autre dans le programme.</p>

<p>Le diagramme uml de l’agrégation est :</p>

<p><img src="img/uml_composition_agregation.png" alt="uml composition et agregation" /></p>

<p>Pour que tout se passe comme prévu, il faut donc s’assurer que soit :</p>

<ol>
  <li>on s’en fiche qu’ils changent</li>
  <li>on refait un nouvel objet à nous pour s’assurer qu’il ne changera pas</li>
  <li>on se rappelle de ce qu’on peut faire avec les objets à tout instant</li>
  <li>les objets que l’on retourne et qui sont des attributs sont non modifiables (des entiers, réels, chaînes de caractères, tuples, etc)</li>
</ol>

<p>C’est la solution 1 que nous appliquons dans ce td. Les objets <code class="language-plaintext highlighter-rouge">dice</code> du <code class="language-plaintext highlighter-rouge">GreenCarpet</code> peuvent bouger (n’importe qui peut les lancer) sans que ça ne gène le fonctionnement de l’objet de classe <code class="language-plaintext highlighter-rouge">GreenCarpet</code>.</p>

<p>Refaire des nouveaux à chaque fois peut s’avérer coûteux s’ils ne sont pas modifiés souvent et il est illusoire de se rappeller tout le temps ce qu’on a le droit (ou pas) de faire avec des objets (encore plus quand le projet contient plusieurs personne ou que sa durée de développement/maintient est longue, c’est à dire plus de 2h…)</p>

<p>La solution 4. est une solution très efficace lorsque les objets sont plus souvent lu que modifié. On ne créer que des objets qui ne peuvent pas être modifié : on appelle ça des 
<a href="https://en.wikipedia.org/wiki/Value_object">value object</a>. Ces objets possèdent des valeurs et des méthodes pour y accéder mais que l’on ne peut pas modifier. La seule façon de changer de valeur c’est de recréer de nouveaux objets. Pour que l’utilisation de ce genre d’objets soit fluide, on fait en sorte qu’ils puissent supporter l’opération <code class="language-plaintext highlighter-rouge">==</code>.</p>

<p>Vous avez utilisé des value objects bien souvent en python comme : les  entiers, les réels ou encore les chaines de caractères. Enfin de nombreux objets modifiables en python ont leur contrepartie non modifiable comme les tuples qui sont des listes non modifiables ou encore les <code class="language-plaintext highlighter-rouge">frozenset</code>sont des ensembles non modifiables.</p>

<p>Une bonne façon de programmer est de n’utiliser par défaut que des objets non modifiables et que si le besoin s’en fait sentir de les rendre modifiables.</p>

<h2 id="séance-tableau">séance tableau</h2>

<h2 id="séance-de-code">séance de code</h2>

<h3 id="ressources">ressources</h3>

<p><a href="ressources/TD_2.tex">Les sources tex du sujet</a></p>

<h3 id="11">1.1</h3>

<p><img src="img/dice_proba_no_class_att.png" alt="un dé" /></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">dice</span> <span class="kn">import</span> <span class="n">Dice</span>

<span class="n">d1</span> <span class="o">=</span> <span class="n">Dice</span><span class="p">()</span>
<span class="n">d2</span> <span class="o">=</span> <span class="n">Dice</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="n">d3</span> <span class="o">=</span> <span class="n">Dice</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

<span class="k">for</span> <span class="n">essai</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="p">(</span><span class="n">d1</span><span class="p">,</span> <span class="n">d2</span><span class="p">,</span> <span class="n">d3</span><span class="p">):</span>
        <span class="n">d</span><span class="p">.</span><span class="n">roll</span><span class="p">()</span>
    
    <span class="k">print</span><span class="p">(</span><span class="n">d1</span><span class="p">.</span><span class="n">get_position</span><span class="p">(),</span> <span class="n">d2</span><span class="p">.</span><span class="n">get_position</span><span class="p">(),</span> <span class="n">d3</span><span class="p">.</span><span class="n">get_position</span><span class="p">())</span>
</code></pre></div></div>

<h3 id="12">1.2</h3>

<h4 id="uml">uml</h4>

<p><img src="img/greenCarpet.png" alt="greencarpet" /></p>

<p>Les objets de la classe <code class="language-plaintext highlighter-rouge">GreenCarpet</code> créent à l’initalisation 5 dé de la classe <code class="language-plaintext highlighter-rouge">Dice</code> qu’ils mettront dans la liste <code class="language-plaintext highlighter-rouge">_dices_</code>. C’est une <strong>composition</strong>.</p>

<h4 id="code">code</h4>
<p>Le code est dans la correction de la session de code ci-dessous.</p>

<h4 id="roll-">roll ?</h4>

<p>Il est possible d’avoir plusieurs méthodes roll car elles ne seront jamais appliquées au même objet (à gauche du <code class="language-plaintext highlighter-rouge">.</code>)</p>

<p>Lorsque l’on exécute la méthode roll d’un objet de type <code class="language-plaintext highlighter-rouge">GreenCarpet</code>, on exécutera la ligne <code class="language-plaintext highlighter-rouge">self.dices[i].roll()</code> (ou un truc du genre). Donc la méthode <code class="language-plaintext highlighter-rouge">roll</code> sera cherché dans l’objet à gauche du <code class="language-plaintext highlighter-rouge">.</code> donc <code class="language-plaintext highlighter-rouge">self.dices[i]</code>. De là, on cherchera l’objet de numéro <code class="language-plaintext highlighter-rouge">i</code> de <code class="language-plaintext highlighter-rouge">self.dices</code> donc de la liste de nom <code class="language-plaintext highlighter-rouge">dices</code> appartenant à l’objet de nom <code class="language-plaintext highlighter-rouge">self</code> qui est un objet de la classe <code class="language-plaintext highlighter-rouge">GreenCarpet</code> : cet objet est un objet de la classe <code class="language-plaintext highlighter-rouge">Dice</code> qui possède une méthode <code class="language-plaintext highlighter-rouge">roll</code> (cette méthode n’a rien à voir avec la méthode <code class="language-plaintext highlighter-rouge">roll</code> des <code class="language-plaintext highlighter-rouge">GreenCarpet</code>).</p>

<h4 id="les-espaces-de-noms">Les espaces de noms</h4>

<p>On suppose qu’on a le code suivant pour la classe <code class="language-plaintext highlighter-rouge">GreenCarpet</code> :</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">GreenCarpet</span><span class="p">:</span>
    <span class="c1"># ...
</span>    <span class="k">def</span> <span class="nf">roll</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">dice</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">.</span><span class="n">dices</span><span class="p">:</span>
            <span class="n">dice</span><span class="p">.</span><span class="n">roll</span><span class="p">()</span>
    <span class="c1"># ...
</span></code></pre></div></div>

<p>Et dans la classe <code class="language-plaintext highlighter-rouge">Dice</code> :</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">random</span>

<span class="c1"># ...
</span>
<span class="k">class</span> <span class="nc">Dice</span><span class="p">:</span>
    <span class="c1"># ...
</span>    <span class="k">def</span> <span class="nf">roll</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">set_position</span><span class="p">(</span><span class="n">randam</span><span class="p">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
    <span class="c1"># ...
</span></code></pre></div></div>

<p>On suppose que l’on veuille exécuter le fichier <em>main.py</em> qui contient les lignes :</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">GreenCarpet</span> <span class="kn">import</span> <span class="n">GreenCarpet</span>

<span class="c1"># ...
</span>
<span class="n">tapis_vert</span> <span class="o">=</span> <span class="n">GreenCarpet</span><span class="p">()</span>

<span class="c1"># ...
</span>
<span class="n">tapis_vert</span><span class="p">.</span><span class="n">roll</span><span class="p">()</span>

</code></pre></div></div>

<p>Les différents objets et espaces de noms (les flèches avec un petit carré) sont rassemblés dans la figure ci-après :</p>

<p><img src="ressources/td2_1_2_5.png" alt="espaces de noms" /></p>

<p>L’exécution de la commande <code class="language-plaintext highlighter-rouge">tapis_vert.roll()</code> se déroule alors comme suit (on a mis le début jusqu’à l’excution de la méthode <code class="language-plaintext highlighter-rouge">dice.roll</code>) :</p>

<ol>
  <li>c’est une l’exécution du nom <code class="language-plaintext highlighter-rouge">roll</code> de l’espace de nom associé à l’objet de nom <code class="language-plaintext highlighter-rouge">tapis_vert</code> de l’espace de nom de <em>main.py</em></li>
  <li>il existe un nom <code class="language-plaintext highlighter-rouge">tapis_vert</code> dans l’espace de nom de <em>main.py</em> associé à un objet de la classe <code class="language-plaintext highlighter-rouge">GreenCarpet</code>.</li>
  <li>on cherche donc le nom <code class="language-plaintext highlighter-rouge">roll</code> dans l’espace de nom de cet objet. Il n’y est pas</li>
  <li>
    <p>lorsqu’un nom n’est pas dans l’espace de nom d’un objet, on cherche dans sa classe et <em>bingo</em> c’est un nom de méthode. On exécute alors cette méthode :</p>

    <ol>
      <li>on crée un espace de nom pour cette méthode</li>
      <li>on place les paramètre de la méthode dans cet espace de nom. Ici il n’y a qu’un paramètre de nom <code class="language-plaintext highlighter-rouge">self</code> associé à l’objet appelant (c’est à dire l’objet de la classe <code class="language-plaintext highlighter-rouge">GreenCarpet</code>)</li>
      <li>la méthode consiste en une boucle for, qui itère sur l’objet associé au nom <code class="language-plaintext highlighter-rouge">self.dices</code> dans l’espace de nom de la méthode.</li>
      <li>comme <code class="language-plaintext highlighter-rouge">self</code> est l’objet de la classe <code class="language-plaintext highlighter-rouge">GreenCarpet</code>, il possède un nom <code class="language-plaintext highlighter-rouge">dices</code> dans son espace de nom qui est une liste de 5 objets de la classe <code class="language-plaintext highlighter-rouge">Dice</code></li>
      <li>lors de l’itération le nom <code class="language-plaintext highlighter-rouge">dice</code> crée par la boucle for sera associé itérativement à chaque élément de la liste, c’est à dire à chaque objet de la classe <code class="language-plaintext highlighter-rouge">Dice</code></li>
      <li>La boucle for exécute l’objet associé au nom  <code class="language-plaintext highlighter-rouge">dice.roll</code>.</li>
      <li>le nom <code class="language-plaintext highlighter-rouge">roll</code> n’existe pas dans l’objet de nom <code class="language-plaintext highlighter-rouge">dice</code> dans l’espace de nom de la méthode. Mais il existe dans sa classe, la classe <code class="language-plaintext highlighter-rouge">Dice</code>.</li>
      <li>
        <p>on exécute la méthode <code class="language-plaintext highlighter-rouge">roll</code> de la classe dice :</p>

        <ol>
          <li>on crée un espace de nom pour cette méthode et on y place le nom <code class="language-plaintext highlighter-rouge">self</code> correspondant à l’objet à gauche du point, ici l’objet associé au nom <code class="language-plaintext highlighter-rouge">dice</code> dans l’espace de nom de la méthode <code class="language-plaintext highlighter-rouge">roll</code> de la classe <code class="language-plaintext highlighter-rouge">GreenCarpet</code></li>
          <li>l’exécution de cette méthode cherche un nom <code class="language-plaintext highlighter-rouge">random.randint</code>. Ce nom n’existe pas dans l’espace de nom de la méthode, du coup on remonte. Quand un objet n’existe pas dans l’espace de nom d’une méthode, on cherche dans l’espace de nom principal. Notez que c’est différent du fait de cherche un nom dans un objet, pour lequel on remonte à sa classe. Pour un espace de nom de méthode, on monte à l’esapce de nom du fichier. Ici on le trouve puisque c’est dans un import. Le nom correspont au nom <code class="language-plaintext highlighter-rouge">randint</code> dans l’espace de nom <code class="language-plaintext highlighter-rouge">random</code> qui existe dans l’espace de nom du fichier <em>dice.py</em> (ouf).</li>
          <li>l’exécution du nom <code class="language-plaintext highlighter-rouge">random.randint</code> rend un entier qui est associé au nom <code class="language-plaintext highlighter-rouge">position</code> dans l’espace de nom de l’objet associé à <code class="language-plaintext highlighter-rouge">self</code> dans l’espace de nom de la méthode roll de <code class="language-plaintext highlighter-rouge">Dice</code>, ici un des dés.</li>
          <li>la méthode <code class="language-plaintext highlighter-rouge">roll</code> de la classe <code class="language-plaintext highlighter-rouge">Dice</code> est finie, son espace de nom disparait.</li>
        </ol>
      </li>
    </ol>
  </li>
  <li>une fois la boucle for finie, la méthode <code class="language-plaintext highlighter-rouge">roll</code> de <code class="language-plaintext highlighter-rouge">GreenCarpet</code> est finie, son espace de nom disparait.</li>
</ol>

<h3 id="2">2</h3>

<h4 id="21">2.1</h4>

<p><img src="img/card_v1.png" alt="card" /></p>

<p>On pourra coder :</p>

<ul>
  <li>la valeur par un nombre 11 = “Valet”, 12 = “reine” et 13 = “roi” par exemple</li>
  <li>la couleur par une chaîne de caractère</li>
</ul>

<p>La carte est un value object. Une fois créée on ne peut la modifier. On a ajouté une méthode <code class="language-plaintext highlighter-rouge">__eq__</code> pour que 2 deux cartes de même couleur et valeur puissent être identique même si ce ne sont pas les mêmes objets.</p>

<h4 id="22">2.2</h4>

<p>Voir le diagramme UML de la question 2.3.</p>

<p>On a affaire à une agrégation puisque la classe <code class="language-plaintext highlighter-rouge">Deck</code> ne crée aucune carte.</p>

<h4 id="23">2.3</h4>

<p>Pour les 2 premières questions, on a donné pas un nom/nombre (1, 2, 3, 4 ou “pique”, “cœur”, “carreau”, “trèfle”) aux couleurs. Ceci n’est pas satisfaisant car c’est un <a href="https://codeburst.io/software-anti-patterns-magic-numbers-7bc484f40544">magic number</a>.</p>

<p>L’idée est de mettre des noms de constantes explicites et d’utiliser ces noms plutôt que les chaînes de caractères. Pour se rappeler des différentes possibilités, on place des constantes dans la définition de la classe.</p>

<p>On va montrer ici les attributs de classes avec les différentes couleurs de cartes et l’agrégation avec les decks qui
sont des tas de cartes qui existent déjà indépendamment.</p>

<p><img src="img/card_deck.png" alt="carddeck" /></p>

<h2 id="séance-de-code-1">séance de code</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">dice</span> <span class="kn">import</span> <span class="n">Dice</span>

<span class="n">d1</span> <span class="o">=</span> <span class="n">Dice</span><span class="p">()</span>
<span class="n">d2</span> <span class="o">=</span> <span class="n">Dice</span><span class="p">()</span>
<span class="n">d3</span> <span class="o">=</span> <span class="n">Dice</span><span class="p">()</span>

<span class="n">NOMBRE_LANCER</span> <span class="o">=</span> <span class="mi">42</span>
<span class="n">moyenne</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">essai</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">NOMBRE_LANCER</span><span class="p">):</span>     
    <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="p">(</span><span class="n">d1</span><span class="p">,</span> <span class="n">d2</span><span class="p">,</span> <span class="n">d3</span><span class="p">):</span>        
        <span class="n">d</span><span class="p">.</span><span class="n">roll</span><span class="p">()</span>
        <span class="n">moyenne</span> <span class="o">+=</span> <span class="n">d</span><span class="p">.</span><span class="n">get_position</span><span class="p">()</span>
    
<span class="n">moyenne</span> <span class="o">/=</span> <span class="n">NOMBRE_LANCER</span>
<span class="k">print</span><span class="p">(</span><span class="s">"moyenne :"</span><span class="p">,</span> <span class="n">moyenne</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">numpy.random</span>


<span class="k">class</span> <span class="nc">Dice</span><span class="p">:</span>
    <span class="n">NUMBER_FACES</span> <span class="o">=</span> <span class="mi">6</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">probabilities</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">position</span> <span class="o">=</span> <span class="n">position</span>
        <span class="k">if</span> <span class="n">probabilities</span><span class="p">:</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">probabilities</span> <span class="o">=</span> <span class="n">probabilities</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">probabilities</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span> <span class="o">/</span> <span class="bp">self</span><span class="p">.</span><span class="n">NUMBER_FACES</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="p">.</span><span class="n">NUMBER_FACES</span>

    <span class="k">def</span> <span class="nf">get_position</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="p">.</span><span class="n">position</span>

    <span class="k">def</span> <span class="nf">set_position</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_position</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">position</span> <span class="o">=</span> <span class="n">new_position</span>

    <span class="k">def</span> <span class="nf">roll</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">position</span> <span class="o">=</span> <span class="n">numpy</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">choice</span><span class="p">([</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="p">.</span><span class="n">NUMBER_FACES</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)],</span> <span class="n">p</span><span class="o">=</span><span class="bp">self</span><span class="p">.</span><span class="n">probabilities</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s">"Dice(position="</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">position</span><span class="p">)</span> <span class="o">+</span> <span class="s">", probabilities="</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">probabilities</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="p">.</span><span class="n">position</span> <span class="o">==</span> <span class="n">other</span><span class="p">.</span><span class="n">position</span> <span class="ow">and</span> <span class="bp">self</span><span class="p">.</span><span class="n">probabilities</span> <span class="o">==</span> <span class="n">other</span><span class="p">.</span><span class="n">probabilities</span>

    <span class="k">def</span> <span class="nf">__lt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="p">.</span><span class="n">position</span> <span class="o">&lt;</span> <span class="n">other</span><span class="p">.</span><span class="n">position</span>

    <span class="k">def</span> <span class="nf">__gt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="p">.</span><span class="n">position</span> <span class="o">&gt;</span> <span class="n">other</span><span class="p">.</span><span class="n">position</span>


<span class="k">class</span> <span class="nc">GreenCarpet</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">dices</span> <span class="o">=</span> <span class="p">[</span><span class="n">Dice</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">)]</span>

    <span class="k">def</span> <span class="nf">get_dices</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="p">.</span><span class="n">dices</span>

    <span class="k">def</span> <span class="nf">roll</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">index</span><span class="p">:</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">dices</span><span class="p">[</span><span class="n">index</span><span class="p">].</span><span class="n">roll</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">dice</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">.</span><span class="n">dices</span><span class="p">:</span>
                <span class="n">dice</span><span class="p">.</span><span class="n">roll</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">get_dice_by_id</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="p">.</span><span class="n">dices</span><span class="p">[</span><span class="n">item</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="p">.</span><span class="n">dices</span><span class="p">[</span><span class="n">item</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">appears_more_than</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nb_times</span><span class="p">):</span>
        <span class="n">count</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">7</span>
        <span class="k">for</span> <span class="n">dice</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">.</span><span class="n">dices</span><span class="p">:</span>
            <span class="n">count</span><span class="p">[</span><span class="n">dice</span><span class="p">.</span><span class="n">get_position</span><span class="p">()]</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">count</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">count</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">nb_times</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">True</span>
        <span class="k">return</span> <span class="bp">False</span>

    <span class="k">def</span> <span class="nf">is_pair</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="p">.</span><span class="n">appears_more_than</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">is_three_of_a_kind</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="p">.</span><span class="n">appears_more_than</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">is_square</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="p">.</span><span class="n">appears_more_than</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">roll_until_number</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">number</span><span class="p">):</span>
        <span class="k">while</span> <span class="ow">not</span> <span class="bp">self</span><span class="p">.</span><span class="n">appears_more_than</span><span class="p">(</span><span class="n">number</span><span class="p">):</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">roll</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">roll_until_pair</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">roll_until_number</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">roll_until_three_of_a_kind</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">roll_until_number</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">roll_until_square</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">roll_until_number</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">dice</span> <span class="kn">import</span> <span class="n">Dice</span>

<span class="k">def</span> <span class="nf">test_dice_creation_no_argument</span><span class="p">():</span>
    <span class="n">dice</span> <span class="o">=</span> <span class="n">Dice</span><span class="p">()</span>
    <span class="k">assert</span> <span class="n">dice</span><span class="p">.</span><span class="n">get_position</span><span class="p">()</span> <span class="o">==</span> <span class="mi">1</span>

<span class="k">def</span> <span class="nf">test_set_position</span><span class="p">():</span>
    <span class="n">dice</span> <span class="o">=</span> <span class="n">Dice</span><span class="p">()</span>
    <span class="k">assert</span> <span class="n">dice</span><span class="p">.</span><span class="n">get_position</span><span class="p">()</span> <span class="o">==</span> <span class="mi">1</span>
    <span class="n">dice</span><span class="p">.</span><span class="n">set_position</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">dice</span><span class="p">.</span><span class="n">get_position</span><span class="p">()</span> <span class="o">==</span> <span class="mi">3</span>

<span class="k">def</span> <span class="nf">test_roll</span><span class="p">():</span>
    <span class="n">dice</span> <span class="o">=</span> <span class="n">Dice</span><span class="p">()</span>
    <span class="n">dice</span><span class="p">.</span><span class="n">roll</span><span class="p">()</span>
    <span class="k">assert</span> <span class="mi">1</span> <span class="o">&lt;=</span> <span class="n">dice</span><span class="p">.</span><span class="n">get_position</span><span class="p">()</span> <span class="o">&lt;=</span> <span class="n">dice</span><span class="p">.</span><span class="n">NUMBER_FACES</span>

<span class="k">def</span> <span class="nf">test_dice_creation_initial_position</span><span class="p">():</span>
    <span class="n">dice</span> <span class="o">=</span> <span class="n">Dice</span><span class="p">(</span><span class="n">position</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">dice</span><span class="p">.</span><span class="n">get_position</span><span class="p">()</span> <span class="o">==</span> <span class="mi">5</span>

<span class="k">def</span> <span class="nf">test_roll_proba</span><span class="p">():</span>
    <span class="n">dice</span> <span class="o">=</span> <span class="n">Dice</span><span class="p">(</span><span class="n">probabilities</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
    <span class="n">dice</span><span class="p">.</span><span class="n">roll</span><span class="p">()</span>
    <span class="k">assert</span> <span class="n">dice</span><span class="p">.</span><span class="n">get_position</span><span class="p">()</span> <span class="o">==</span> <span class="mi">1</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">test_green_carpet_creation</span><span class="p">():</span>
    <span class="n">carpet</span> <span class="o">=</span> <span class="n">GreenCarpet</span><span class="p">()</span>
    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">carpet</span><span class="p">.</span><span class="n">dices</span><span class="p">)</span> <span class="o">==</span> <span class="mi">5</span>


<span class="k">def</span> <span class="nf">test_green_carpet_roll</span><span class="p">():</span>
    <span class="n">carpet</span> <span class="o">=</span> <span class="n">GreenCarpet</span><span class="p">()</span>
    <span class="n">carpet</span><span class="p">.</span><span class="n">roll</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">dice</span> <span class="ow">in</span> <span class="n">carpet</span><span class="p">.</span><span class="n">get_dices</span><span class="p">():</span>
        <span class="k">assert</span> <span class="mi">1</span> <span class="o">&lt;=</span> <span class="n">dice</span><span class="p">.</span><span class="n">position</span> <span class="o">&lt;=</span> <span class="n">dice</span><span class="p">.</span><span class="n">NUMBER_FACES</span>

<span class="k">def</span> <span class="nf">test_is_three_of_a_kind</span><span class="p">():</span>
    <span class="n">carpet</span> <span class="o">=</span> <span class="n">GreenCarpet</span><span class="p">()</span>
    <span class="k">assert</span> <span class="n">carpet</span><span class="p">.</span><span class="n">is_three_of_a_kind</span><span class="p">()</span>
    <span class="n">carpet</span><span class="p">.</span><span class="n">dices</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">set_position</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">carpet</span><span class="p">.</span><span class="n">is_three_of_a_kind</span><span class="p">()</span>
    <span class="n">carpet</span><span class="p">.</span><span class="n">dices</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="n">set_position</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
    <span class="n">carpet</span><span class="p">.</span><span class="n">dices</span><span class="p">[</span><span class="mi">2</span><span class="p">].</span><span class="n">set_position</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">carpet</span><span class="p">.</span><span class="n">is_three_of_a_kind</span><span class="p">()</span>
    <span class="n">carpet</span><span class="p">.</span><span class="n">dices</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">set_position</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
    <span class="k">assert</span> <span class="ow">not</span> <span class="n">carpet</span><span class="p">.</span><span class="n">is_three_of_a_kind</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">test_is_square</span><span class="p">():</span>
    <span class="n">carpet</span> <span class="o">=</span> <span class="n">GreenCarpet</span><span class="p">()</span>
    <span class="k">assert</span> <span class="n">carpet</span><span class="p">.</span><span class="n">is_square</span><span class="p">()</span>
    <span class="n">carpet</span><span class="p">.</span><span class="n">dices</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">set_position</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">carpet</span><span class="p">.</span><span class="n">is_square</span><span class="p">()</span>
    <span class="n">carpet</span><span class="p">.</span><span class="n">dices</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="n">set_position</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
    <span class="n">carpet</span><span class="p">.</span><span class="n">dices</span><span class="p">[</span><span class="mi">2</span><span class="p">].</span><span class="n">set_position</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
    <span class="n">carpet</span><span class="p">.</span><span class="n">dices</span><span class="p">[</span><span class="mi">3</span><span class="p">].</span><span class="n">set_position</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">carpet</span><span class="p">.</span><span class="n">is_square</span><span class="p">()</span>
    <span class="n">carpet</span><span class="p">.</span><span class="n">dices</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">set_position</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
    <span class="k">assert</span> <span class="ow">not</span> <span class="n">carpet</span><span class="p">.</span><span class="n">is_square</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">test_roll_until</span><span class="p">():</span>
    <span class="n">carpet</span> <span class="o">=</span> <span class="n">GreenCarpet</span><span class="p">()</span>
    <span class="n">carpet</span><span class="p">.</span><span class="n">roll_until_number</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">carpet</span><span class="p">.</span><span class="n">is_pair</span><span class="p">()</span>
</code></pre></div></div>

<h2 id="ressources-1">ressources</h2>

<p>Le code pour https://www.planttext.com/ qui permet de créer de jolis diagrammes UML. Ce n’est pas franchement utile pour les étudiants à moins que vous vouliez voir comment on arrive à faire de telles merveilles graphiques en uml avec un petit service web.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>@startuml


  class Dice {
  -_position
  -_probabilities
  + __init__(position=1, probabilities=None)
  +get_position()
  +set_position(position)
  +get_probabilities()
  +set_probabilities(proba)
  +roll()
}

class GreenCarpet {
 - _dices
    
 + __init__()
 + roll()
 + sum()
}

Dice --* GreenCarpet

@enduml
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>@startuml
class Card { 
__attributes__
 - value
 - color
__methods__
 +__init__(value, color)
 + __eq__(self, other)
 + get_value()
 + get_color()
}
@enduml
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>class Card { 
__class_attributes__
 - SPADES
 - HEARTS
 - CLUBS
 - DIAMONDS
__attributes__
 - value
 - color
__methods__
 +__init__(value, color)
 + __eq__(self, other)
 + get_value()
 + get_color()

}

class Deck {
    __attributes__
    - cards
    __methods__
    +__init__()
    +add(card)
    +show()
    +remove()
    
}

Card --o Deck
</code></pre></div></div>


  </div>

</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/cours_informatique/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">cours d&#39;informatique</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">cours d&#39;informatique</li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/FrancoisBrucker"><svg class="svg-icon"><use xlink:href="/cours_informatique/assets/minima-social-icons.svg#github"></use></svg> <span class="username">FrancoisBrucker</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>Support de cours/td d&#39;informatique à l&#39;école centrale marseille.</p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
