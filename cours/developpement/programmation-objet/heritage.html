<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.7.1 -->
<title>Héritage | cours d’informatique</title>
<meta name="generator" content="Jekyll v4.2.0" />
<meta property="og:title" content="Héritage" />
<meta name="author" content="François Brucker" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Support de cours/td d’informatique à l’école centrale marseille." />
<meta property="og:description" content="Support de cours/td d’informatique à l’école centrale marseille." />
<link rel="canonical" href="/cours_informatique/cours/developpement/programmation-objet/heritage.html" />
<meta property="og:url" content="/cours_informatique/cours/developpement/programmation-objet/heritage.html" />
<meta property="og:site_name" content="cours d’informatique" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Héritage" />
<script type="application/ld+json">
{"headline":"Héritage","description":"Support de cours/td d’informatique à l’école centrale marseille.","@type":"WebPage","url":"/cours_informatique/cours/developpement/programmation-objet/heritage.html","author":{"@type":"Person","name":"François Brucker"},"@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/cours_informatique/assets/main.css">

  <link rel="stylesheet" href="/cours_informatique/assets/custom.css"><link type="application/atom+xml" rel="alternate" href="/cours_informatique/feed.xml" title="cours d'informatique" /><!-- Mathjax Support -->
  <script>
    MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']],
      },
      svg: {
        fontCache: 'global'
      }
    };
    </script>
    <script type="text/javascript" id="MathJax-script" async
      src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js">
    </script>
</head>

<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/cours_informatique/">cours d&#39;informatique</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger">
            <a class="page-link" href="/cours_informatique/about"> about </a>
        </div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post">

  <header class="post-header">
    <h1 class="post-title">Héritage</h1>Auteurs :
      <ul>
      
        <li><span itemprop="author" itemscope itemtype="http://schema.org/Person"><span class="p-author h-card" itemprop="name">François Brucker</span></span></li>
      
        <li><span itemprop="author" itemscope itemtype="http://schema.org/Person"><span class="p-author h-card" itemprop="name">Célia Châtel</span></span></li>
      
      </ul></p></p>
  </header>

  <div class="post-content">
    <p>Présentation du mécanisme d’héritage qui permettant de factoriser du code entre classes.</p>

<h2 id="principe-de-lhéritage">principe de l’héritage</h2>

<p>Dans un programme, les classes sont organisées hiérarchiquement, la classe <em>racine</em> étant appelé <em>object</em>.</p>

<p><img src="/cours_informatique/assets/cours/developpement/programmation-objet/classes_heritage.png" alt="classes héritage" /></p>

<p>Dans la figure précédente :</p>

<ul>
  <li>la classe <strong>object</strong> est la <em>racine</em></li>
  <li>la classe <strong>1</strong> est la <em>classe mère</em> de la classe <strong>2</strong></li>
  <li>la classe <strong>2</strong> est une <em>classe fille</em> de la classe <strong>1</strong></li>
</ul>

<p>La figure montre également la désignation UML de l’héritage : une flèche avec un triangle vide.</p>

<h3 id="utilisation-de-lhéritage">utilisation de l’héritage</h3>

<p>L’héritage permet d’utiliser les attributs et méthodes créées dans les classes mères de façon simple :</p>

<ol>
  <li>soit en cherchant dans la hiérarchie des classes l’attribut ou l’objet appelé depuis une classe fille</li>
  <li>soit en appelant directement un attribut ou un objet de la classe mère.</li>
</ol>

<h4 id="chercher-dans-la-hiérarchie">chercher dans la hiérarchie</h4>

<p>Supposons que j’ai un objet de la “classe 2” <code class="language-plaintext highlighter-rouge">obj</code> qui veut appeler la méthode 1 : <code class="language-plaintext highlighter-rouge">obj.methode1()</code></p>

<ol>
  <li>on va chercher <code class="language-plaintext highlighter-rouge">methode1</code> dans l’espace de nom de <code class="language-plaintext highlighter-rouge">obj</code> : il n’y est pas.</li>
  <li>on va alors chercher dans sa classe, <code class="language-plaintext highlighter-rouge">classe2</code> : elle ne définit pas <code class="language-plaintext highlighter-rouge">méthode1</code></li>
  <li>on cherche alors dans la classe mère de classe 2, <code class="language-plaintext highlighter-rouge">classe1</code> : <code class="language-plaintext highlighter-rouge">méthode1</code> est définie, on utilise son code.</li>
</ol>

<blockquote>
  <p>si l’on arrive jusqu’à la classe <code class="language-plaintext highlighter-rouge">object</code> et qu’elle ne contient pas le nom recherché une erreur est lancée.</p>
</blockquote>

<h4 id="appeler-directement">appeler directement</h4>

<p>Supposons que dans la définition de <code class="language-plaintext highlighter-rouge">méthode1</code> de la classe <code class="language-plaintext highlighter-rouge">2'</code> on particulariser la méthode <code class="language-plaintext highlighter-rouge">méthode1</code> de la <code class="language-plaintext highlighter-rouge">classe1</code>. On appelle alors la méthode <code class="language-plaintext highlighter-rouge">méthode1</code> de la classe 1 dans la définition de la <code class="language-plaintext highlighter-rouge">méthode1</code> de la classe <code class="language-plaintext highlighter-rouge">2'</code>.</p>

<blockquote>
  <p>si l’on ne retrouve pas la méthode dans la classe mère, on remonte la hiérarchie. De là tenter d’utiliser la méthode <code class="language-plaintext highlighter-rouge">méthode1</code>  de la classe <code class="language-plaintext highlighter-rouge">1'</code> en définissant la  méthode <code class="language-plaintext highlighter-rouge">méthode1</code>  de la classe <code class="language-plaintext highlighter-rouge">2''</code> va en fait exécuter la méthode  méthode <code class="language-plaintext highlighter-rouge">méthode1</code>  de la classe <code class="language-plaintext highlighter-rouge">object</code></p>
</blockquote>

<h3 id="connaitre-la-hiérarchie">connaitre la hiérarchie</h3>

<p>En python, si l’on veut connaitre l’ordre dans lequel les classes vont être examinée lors de la remontée de la hiérarchie, on peut utiliser la méthode <code class="language-plaintext highlighter-rouge">mro()</code> des classes. Cette méthode regarde l’attribut <code class="language-plaintext highlighter-rouge">__mro__</code>.</p>

<p>Par exemple, dans un interpréteur :</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="nb">str</span><span class="p">.</span><span class="n">mro</span><span class="p">()</span>
<span class="p">[</span><span class="o">&lt;</span><span class="k">class</span> <span class="err">'</span><span class="nc">str</span><span class="s">'&gt;, &lt;class '</span><span class="nb">object</span><span class="s">'&gt;]
&gt;&gt;&gt; str.__mro__
(&lt;class '</span><span class="nb">str</span><span class="s">'&gt;, &lt;class '</span><span class="nb">object</span><span class="s">'&gt;)
&gt;&gt;&gt; 
</span></code></pre></div></div>

<p>L’ordre dans lequel est examinée les classe pour les chaines de caractères est donc : d’abord la classe <code class="language-plaintext highlighter-rouge">str</code> puis la classe <code class="language-plaintext highlighter-rouge">object</code></p>

<blockquote>
  <p>La classe <code class="language-plaintext highlighter-rouge">object</code> est toujours le dernier élément de la liste</p>
</blockquote>

<h3 id="quand-utiliser-lhéritage">quand utiliser l’héritage</h3>

<p>La composition et l’agrégation permettent de factoriser des fonctionnalités alors que l’héritage factorise du code. On va donc toujours favoriser la composition à l’héritage si c’est possible.</p>

<p>Il y a cependant des cas où l’héritage est très utile :</p>

<ul>
  <li>lorsque l’on veut spécifier une classe : la nouvelle classe est un cas particulier de la classe mère**</li>
  <li>lors de l’utilisation de bibliothèques : on particularise à nos besoin une classe générique donnée par un module que l’on a pas écrit.</li>
</ul>

<p>La règle est que lorsque l’héritage doit re-écrire toutes les méthodes de sa classe mère pour qu’il n’y ait pas de conflit, alors il faut changer d’approche. Une classe et sa classe mère doivent partager beaucoup de méthodes (ou que les méthodes soient des cas particuliers)</p>

<h3 id="héritage-multiple">héritage multiple</h3>

<p>Python autorise l’<a href="https://docs.python.org/fr/3/tutorial/classes.html#multiple-inheritance">héritage multiple</a>, mais sans très bonne raison il est plus que recommandé de ne pas l’utiliser. Il existe <strong>toujours</strong> une solution utilisant l’héritage simple qui sera plus facile à comprendre et surtout à maintenir dans le temps.</p>

<p>D’ailleurs, certains langages, comme le java ou par exemple, interdisent carrément l’héritage multiple.</p>

<blockquote>
  <p>Si cela vous intéresse, python utilise la règle <a href="https://en.wikipedia.org/wiki/C3_linearization">de linéarisation C3</a> pour réaliser l’ordre de priorité des classes (le mro), ceci permet de résoudre le <a href="https://fr.wikipedia.org/wiki/Probl%C3%A8me_du_diamant">problème du diamant</a> en héritage multiple.</p>
</blockquote>

<h2 id="exemple-1--héritage-simple">Exemple 1 : héritage simple</h2>

<p>On présente ici un premier exemple d’utilisation de l’héritage, en combinaison d’une composition.</p>

<p>On veut manipuler des polygones. On veut pouvoir :</p>

<ul>
  <li>créer un polygone à partir d’une liste de sommets donnée</li>
  <li>calculer l’aire du polygone</li>
  <li>calculer le périmètre du polygone</li>
</ul>

<h3 id="classes-point-et-polygone">classes Point et Polygone</h3>

<p>Pour cela, on va créer une classe <code class="language-plaintext highlighter-rouge">Point</code> et une classe <code class="language-plaintext highlighter-rouge">Polygone</code> :</p>

<ul>
  <li>classe <code class="language-plaintext highlighter-rouge">Point</code> :
    <ul>
      <li>on se restreint à la 2D</li>
      <li>coordonnées cartésiennes</li>
      <li>distance à un autre point pour pouvoir plus facilement calculer le périmètre ensuite</li>
    </ul>
  </li>
  <li>classe <code class="language-plaintext highlighter-rouge">Polygone</code> :
    <ul>
      <li>création avec une liste de Point</li>
      <li>calcul du périmètre</li>
      <li>calcul de l’aire</li>
    </ul>
  </li>
</ul>

<p>On va supposer que le <a href="https://fr.wikipedia.org/wiki/Polygone_simple">polygone est simple</a> pour simplifier le calcul de l’aire…</p>

<h4 id="uml">uml</h4>

<p>Point et polygone entretiennent un lien d’agrégation (les points sont passé au polygone à sa construction). Le modèle UML suivant :</p>

<p><img src="/cours_informatique/assets/cours/developpement/programmation-objet/heritage_point_poly.png" alt="point polygone" /></p>

<h4 id="code-python">code python</h4>

<p>On peut alors avoir le code python suivant pour créer les classes :</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">sqrt</span>


<span class="k">class</span> <span class="nc">Point</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">_x</span> <span class="o">=</span> <span class="n">x</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">_y</span> <span class="o">=</span> <span class="n">y</span>

    <span class="k">def</span> <span class="nf">get_x</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="p">.</span><span class="n">_x</span>

    <span class="k">def</span> <span class="nf">get_y</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="p">.</span><span class="n">_y</span>

    <span class="k">def</span> <span class="nf">set_x</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">_x</span> <span class="o">=</span> <span class="n">x</span>

    <span class="k">def</span> <span class="nf">set_y</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">_y</span> <span class="o">=</span> <span class="n">y</span>

    <span class="k">def</span> <span class="nf">distance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="n">x1</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">get_x</span><span class="p">()</span>
        <span class="n">x2</span> <span class="o">=</span> <span class="n">other</span><span class="p">.</span><span class="n">get_x</span><span class="p">()</span>

        <span class="n">y1</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">get_y</span><span class="p">()</span>
        <span class="n">y2</span> <span class="o">=</span> <span class="n">other</span><span class="p">.</span><span class="n">get_y</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">sqrt</span><span class="p">((</span><span class="n">x2</span> <span class="o">-</span> <span class="n">x1</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">y2</span> <span class="o">-</span> <span class="n">y1</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">Polygone</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">points</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">_points</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">périmètre</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">d</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">pivot</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">_points</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">point</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">.</span><span class="n">_points</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
            <span class="n">d</span> <span class="o">+=</span> <span class="n">pivot</span><span class="p">.</span><span class="n">distance</span><span class="p">(</span><span class="n">point</span><span class="p">)</span>
            <span class="n">pivot</span> <span class="o">=</span> <span class="n">point</span>
        <span class="n">d</span> <span class="o">+=</span> <span class="n">pivot</span><span class="p">.</span><span class="n">distance</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">_points</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

        <span class="k">return</span> <span class="n">d</span>

    <span class="k">def</span> <span class="nf">aire</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">a</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">pivot</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">_points</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">point</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">.</span><span class="n">_points</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
            <span class="n">a</span> <span class="o">+=</span> <span class="n">pivot</span><span class="p">.</span><span class="n">get_x</span><span class="p">()</span> <span class="o">*</span> <span class="n">point</span><span class="p">.</span><span class="n">get_y</span><span class="p">()</span> <span class="o">-</span> <span class="n">pivot</span><span class="p">.</span><span class="n">get_y</span><span class="p">()</span> <span class="o">*</span> <span class="n">point</span><span class="p">.</span><span class="n">get_x</span><span class="p">()</span>
            <span class="n">pivot</span> <span class="o">=</span> <span class="n">point</span>

        <span class="n">point</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">_points</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">a</span> <span class="o">+=</span> <span class="n">pivot</span><span class="p">.</span><span class="n">get_x</span><span class="p">()</span> <span class="o">*</span> <span class="n">point</span><span class="p">.</span><span class="n">get_y</span><span class="p">()</span> <span class="o">-</span> <span class="n">pivot</span><span class="p">.</span><span class="n">get_y</span><span class="p">()</span> <span class="o">*</span> <span class="n">point</span><span class="p">.</span><span class="n">get_x</span><span class="p">()</span>

        <span class="k">return</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="nb">abs</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>

</code></pre></div></div>

<blockquote>
  <p>On a rendu les attributs des classes privé. La convention en python pour rendre un attribut privé est de lui coller un <code class="language-plaintext highlighter-rouge">_</code> avant son nom.</p>
</blockquote>

<p>Remarques :</p>

<ol>
  <li>Remarquez que l’on utiliser toujours les méthodes (si elles existent) pour accéder aux attributs, cela permettra si besoin de changer les attributs de la classes (passer en coordonnées polaires par exemple) sans changer le code des méthodes.</li>
  <li>Pour la classe polygone, on recrée une liste de points pour être sur que le nombre de points reste constant (la liste est passée en paramètre et peut donc être modifiées à ‘extérieur de la classe)</li>
  <li>Notez que l’on ne recrée pas les points, ils peuvent donc changer car ils sont passés en paramètre de la construction du polygone</li>
</ol>

<p>On peut tester le code avec, par exemple :</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">points</span> <span class="o">=</span> <span class="p">[</span><span class="n">Point</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">Point</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">Point</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">Point</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)]</span>
<span class="n">polygone</span> <span class="o">=</span> <span class="n">Polygone</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">polygone</span><span class="p">.</span><span class="n">périmètre</span><span class="p">())</span>
<span class="k">print</span><span class="p">(</span><span class="n">polygone</span><span class="p">.</span><span class="n">aire</span><span class="p">())</span>
</code></pre></div></div>

<h3 id="un-polygone-particulier">un polygone particulier</h3>

<p>Comment modéliser une classe triangle ?</p>

<p>Comme un triangle <strong>est un</strong> polygone simple, on peut utiliser l’héritage pour cela.</p>

<h4 id="modélisation-uml">modélisation UML</h4>

<p>Elle est très simple :</p>

<p><img src="/cours_informatique/assets/cours/developpement/programmation-objet/heritage_triangle.png" alt="triangle" /></p>

<p>Notez que pour l’héritage, on ne remet pas les attributs/méthodes définis dans les classes mères.</p>

<h4 id="code-python-du-triangle">code python du Triangle</h4>

<p>La classe <code class="language-plaintext highlighter-rouge">Triangle</code> hérite de <code class="language-plaintext highlighter-rouge">Polygon</code>, on appelle donc le constructeur de ce dernier lors de la création d’un <code class="language-plaintext highlighter-rouge">Triangle</code>.</p>

<p>Ceci est explicite en python :</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">Triangle</span><span class="p">(</span><span class="n">Polygone</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">point1</span><span class="p">,</span> <span class="n">point2</span><span class="p">,</span> <span class="n">point3</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">().</span><span class="n">__init__</span><span class="p">([</span><span class="n">point1</span><span class="p">,</span> <span class="n">point2</span><span class="p">,</span> <span class="n">point3</span><span class="p">])</span>
</code></pre></div></div>

<p>Le mot clé <code class="language-plaintext highlighter-rouge">super()</code> désigne la classe parente, ici <code class="language-plaintext highlighter-rouge">Polygone</code>. Ce mot clé permet d’utiliser toutes les méthodes de la classe parente, ici <code class="language-plaintext highlighter-rouge">__init__</code>. Remarquez que l’on utilise la méthode <code class="language-plaintext highlighter-rouge">__init__</code> sans utiliser le premier paramètre (<code class="language-plaintext highlighter-rouge">self</code>) qui est implicitement l’objet courant.</p>

<p>Si on regarde l’ordre dans lequel est examiné les espaces de nom, on a (c’est la commande <code class="language-plaintext highlighter-rouge">Triangle.mro()</code>) :</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">[</span><span class="o">&lt;</span><span class="k">class</span> <span class="err">'</span><span class="nc">__main__</span><span class="p">.</span><span class="n">Triangle</span><span class="s">'&gt;, &lt;class '</span><span class="n">__main__</span><span class="p">.</span><span class="n">Polygone</span><span class="s">'&gt;, &lt;class '</span><span class="nb">object</span><span class="s">'&gt;]
</span></code></pre></div></div>

<blockquote>
  <p>Un petit tuto sur <a href="https://he-arc.github.io/livre-python/super/index.html">la fonction super</a></p>
</blockquote>

<p>On peut maintenant utiliser toutes les méthodes définies dans Polygone puisque le constructeur de <code class="language-plaintext highlighter-rouge">Triangle</code> appelle directement le constructeur de <code class="language-plaintext highlighter-rouge">Polygone</code> : à la fin du constructeur, il existera une liste de points dans le triangle.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="n">triangle</span> <span class="o">=</span> <span class="n">Triangle</span><span class="p">(</span><span class="n">Point</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">Point</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">Point</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
    <span class="k">print</span><span class="p">(</span><span class="n">triangle</span><span class="p">.</span><span class="n">périmètre</span><span class="p">())</span>
    <span class="k">print</span><span class="p">(</span><span class="n">triangle</span><span class="p">.</span><span class="n">aire</span><span class="p">())</span>
</code></pre></div></div>

<p>Pour trouver le périmètre, python fonctionne ainsi :</p>

<ol>
  <li>existe-t-il un nom <code class="language-plaintext highlighter-rouge">périmètre</code> dans l’objet <code class="language-plaintext highlighter-rouge">triangle</code> : NON</li>
  <li>existe-t-il un nom <code class="language-plaintext highlighter-rouge">périmètre</code> dans la classe de l’objet <code class="language-plaintext highlighter-rouge">triangle</code>, <code class="language-plaintext highlighter-rouge">Triangle</code> : NON</li>
  <li>existe-t-il un nom <code class="language-plaintext highlighter-rouge">périmètre</code> dans la classe mère de <code class="language-plaintext highlighter-rouge">Triangle</code>, <code class="language-plaintext highlighter-rouge">Polygone</code> : OUI</li>
</ol>

<p>Une fois la méthode trouvée, on l’exécute en plaçant l’objet (ici notre <code class="language-plaintext highlighter-rouge">triangle</code> en 1er paramètre, c’est à dire <code class="language-plaintext highlighter-rouge">self</code> de la méthode <code class="language-plaintext highlighter-rouge">périmètre</code> définie dans <code class="language-plaintext highlighter-rouge">Polygone</code>).</p>

<h2 id="exemple-2--donjons-et-dragons">Exemple 2 : donjons et dragons</h2>

<p>On va simuler des personnage d’<em>heroic fantasy</em>. Pour cela, on commence par créer une classe <code class="language-plaintext highlighter-rouge">Personnage</code> qui sera particularisée petit à petit.</p>

<h3 id="classe-personnage">classe Personnage</h3>

<p>Le personnage générique doit :</p>

<ul>
  <li>avoir un score d’attaque</li>
  <li>avoir des points de vie</li>
  <li>pouvoir modifier son score d’ataque et ses points de vie</li>
  <li>taper un autre personnage (lui faire perdre un nombre de point de vie égale à son score d’attaque)</li>
  <li>se faire taper par un autre personnage</li>
</ul>

<h4 id="uml-du-personnage">UML du personnage</h4>

<p><img src="/cours_informatique/assets/cours/developpement/programmation-objet/heritage_personnage.png" alt="personnage" /></p>

<h4 id="code-python-du-personnage">code python du personnage</h4>

<p>On a décidé ici de ne pas mettre de méthode get et set, mais de laisser libre accès aux attributs. C’est un choix possible. L’UML dérive donc un peut du code python ce qui est normal, chaque langage ayant ses spécificités.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">Personnage</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vie</span><span class="p">,</span> <span class="n">attaque</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">vie</span> <span class="o">=</span> <span class="n">vie</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">attaque</span> <span class="o">=</span> <span class="n">attaque</span>

    <span class="k">def</span> <span class="nf">se_faire_taper</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">personnage</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">vie</span> <span class="o">-=</span> <span class="n">personnage</span><span class="p">.</span><span class="n">attaque</span>

    <span class="k">def</span> <span class="nf">taper</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">personnage</span><span class="p">):</span>
        <span class="n">personnage</span><span class="p">.</span><span class="n">se_faire_taper</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</code></pre></div></div>

<p>Voyez comment on a utilisé la méthode <code class="language-plaintext highlighter-rouge">se_faire_taper</code> pour définir la méthode <code class="language-plaintext highlighter-rouge">taper</code>.</p>

<h3 id="la-classe-guerrière">la classe guerrière</h3>

<p>La guerrière dispose d’un score de bloquage qui représente son pourcentage de chances de ne pas perdre de vie quand un autre personnage l’attaque.</p>

<h4 id="modèle-uml-de-la-guerrière">modèle UML de la guerrière</h4>

<p>c’est un personnage, on peut donc utiliser l’héritage.</p>

<p><img src="/cours_informatique/assets/cours/developpement/programmation-objet/heritage_guerriere.png" alt="Guerrière" /></p>

<p>On ne met que les méthodes qui changent, donc le constructeur et se faire taper.</p>

<h4 id="code-python-de-la-guerrière">code python de la guerrière</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># ... 
</span><span class="kn">import</span> <span class="nn">random</span>
<span class="c1">#...
</span>
<span class="k">class</span> <span class="nc">Guerriere</span><span class="p">(</span><span class="n">Personnage</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vie</span><span class="p">,</span> <span class="n">attaque</span><span class="p">,</span> <span class="n">blocage</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">().</span><span class="n">__init__</span><span class="p">(</span><span class="n">vie</span><span class="p">,</span> <span class="n">attaque</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">blocage</span> <span class="o">=</span> <span class="n">blocage</span>

    <span class="k">def</span> <span class="nf">se_faire_taper</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">personnage</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="p">.</span><span class="n">blocage</span> <span class="o">&lt;=</span> <span class="n">random</span><span class="p">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">):</span>
            <span class="nb">super</span><span class="p">().</span><span class="n">se_faire_taper</span><span class="p">(</span><span class="n">personnage</span><span class="p">)</span>
</code></pre></div></div>

<p>Comprenez bien le code :</p>

<ul>
  <li>On commence par appeler le constructeur de la classe mère (<code class="language-plaintext highlighter-rouge">super().__init__()</code>) puis on applique le cas particulier de notre classe (<code class="language-plaintext highlighter-rouge">self.blocage = blocage</code>).</li>
  <li>on ajoute un attribut à la guerrière par rapport au personnage normal,</li>
  <li>la méthode <code class="language-plaintext highlighter-rouge">se_faire_taper(personnage)</code> utilise la méthode <code class="language-plaintext highlighter-rouge">se_faire_taper</code> de la classe <code class="language-plaintext highlighter-rouge">Personnage</code> seulement si la guerrière ne bloque pas le coup. Le <code class="language-plaintext highlighter-rouge">super().methode_de_la_mere()</code> permet d’accéder à la méthode de la classe mère même de même nom qu’une méthode (différente) de la classe fille.</li>
</ul>

<blockquote class="attention">
  <p>On utilise <strong>toujours</strong> le constructeur de la classe mère pour garantir que les méthodes définie dans la classe mère fonctionnent avec les objets de la classe fille. Sinon ici, <code class="language-plaintext highlighter-rouge">se_faire_taper</code> ne fonctionnerait pas puisque vie et attaque ne seraient pas défini</p>
</blockquote>

<h3 id="le-magicien">le magicien</h3>

<p>Le magicien peut faire tout ce que peut faire un personnage normal mais il dispose en plus d’un score d’attaque magique qui détermine les dégâts qu’il fait en lançant un sort.</p>

<h4 id="modèle-uml-du-magicien">modèle UML du magicien</h4>

<p>On ajoute une nouvelle méthode qui n’existe pas dans la classe mère :</p>

<p><img src="/cours_informatique/assets/cours/developpement/programmation-objet/heritage_magicien.png" alt="Magicien" /></p>

<h4 id="code-python-du-magicien">code python du magicien</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">Magicien</span><span class="p">(</span><span class="n">Personnage</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vie</span><span class="p">,</span> <span class="n">attaque</span><span class="p">,</span> <span class="n">attaque_magique</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">().</span><span class="n">__init__</span><span class="p">(</span><span class="n">vie</span><span class="p">,</span> <span class="n">attaque</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">attaque_magique</span> <span class="o">=</span> <span class="n">attaque_magique</span>

    <span class="k">def</span> <span class="nf">lancer_sort</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">personnage</span><span class="p">):</span>
        <span class="n">personnage</span><span class="p">.</span><span class="n">vie</span> <span class="o">-=</span> <span class="bp">self</span><span class="p">.</span><span class="n">attaque_magique</span>
</code></pre></div></div>

<p>On voit là que le personnage peut mourir si sa vie descend en dessous de 0. Comme on ne modifie qu’un attribut, on ne peut associer aucune méthode à cette mort. Il faut donc rendre l’attribut vie privé et n’y accéder qu’avec une méthode.</p>

<p>Une autre solution élégante en python est d’utiliser des <a href="https://www.it-swarm-fr.com/fr/python/utiliser-property-contre-les-getters-et-les-setters/972255514/">@property</a> qui font comme si on modifiait un attribut alors qu’on exécute une fonction :</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">Personnage</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vie</span><span class="p">,</span> <span class="n">attaque</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">_vie</span> <span class="o">=</span> <span class="n">vie</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">attaque</span> <span class="o">=</span> <span class="n">attaque</span>

    <span class="k">def</span> <span class="nf">se_faire_taper</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">personnage</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">vie</span> <span class="o">-=</span> <span class="n">personnage</span><span class="p">.</span><span class="n">attaque</span>

    <span class="k">def</span> <span class="nf">taper</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">personnage</span><span class="p">):</span>
        <span class="n">personnage</span><span class="p">.</span><span class="n">se_faire_taper</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="o">@</span><span class="nb">property</span>
    <span class="k">def</span> <span class="nf">vie</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="p">.</span><span class="n">_vie</span>

    <span class="o">@</span><span class="n">vie</span><span class="p">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">vie</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">valeur</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">_vie</span> <span class="o">=</span> <span class="n">valeur</span>
        <span class="k">if</span> <span class="bp">self</span><span class="p">.</span><span class="n">_vie</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">_vie</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">print</span><span class="p">(</span><span class="s">"je suis mort"</span><span class="p">)</span>
</code></pre></div></div>

<p>Si l’on utilise la classe précédente, écrire :</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">gandalf.vie = 1</code> est équivalent à écrire <code class="language-plaintext highlighter-rouge">gandalf.vie(1)</code> (on utilise la méthode)</li>
  <li><code class="language-plaintext highlighter-rouge">print(gendalf.vie)</code> sera équivalent à utiliser la méthode en-dessous du <code class="language-plaintext highlighter-rouge">@property.setter</code></li>
</ul>

<h2 id="odds-and-ends">odds and ends</h2>

<p>Quelques petit tests qui ne servent à rien en pratique mais qui permettent de</p>

<h3 id="héritage-de-méthodes">héritage de méthodes</h3>

<p>Comment faire une classe <code class="language-plaintext highlighter-rouge">A</code> qui a :</p>

<ul>
  <li>un attribut <code class="language-plaintext highlighter-rouge">a</code></li>
  <li>une méthode <code class="language-plaintext highlighter-rouge">truc_que_fait_a()</code> qui affiche “Truc défini dans la classe mère”</li>
  <li>une méthode <code class="language-plaintext highlighter-rouge">autre_truc()</code> qui affiche “Autre truc dans la classe mère”</li>
</ul>

<details><summary>solution</summary><div>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">A</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">a</span> <span class="o">=</span> <span class="n">a</span>

    <span class="k">def</span> <span class="nf">truc_que_fait_a</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"Truc défini dans la classe mère"</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">truc_que_fait_a</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"Autre truc dans la classe mère"</span><span class="p">)</span>  
</code></pre></div></div>

</div></details>

<p>Écrivez une classe <code class="language-plaintext highlighter-rouge">B</code> qui hérite de <code class="language-plaintext highlighter-rouge">A</code> et qui a :</p>

<ul>
  <li>un attribut <code class="language-plaintext highlighter-rouge">b</code></li>
  <li>le constructeur à 2 paramètres (a et b), un qui est initialisé dans la classe A (a), l’autre initialisé dans B (b)</li>
  <li>une méthode <code class="language-plaintext highlighter-rouge">autre_truc()</code> qui affiche “C’est mon autre truc à moi”</li>
  <li>une méthode <code class="language-plaintext highlighter-rouge">que_de_b()</code> qui affiche “Méthode seulement de la classe fille”</li>
</ul>

<details><summary>solution</summary><div>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">B</span><span class="p">(</span><span class="n">A</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">().</span><span class="n">__init__</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">b</span> <span class="o">=</span> <span class="n">b</span>

    <span class="k">def</span> <span class="nf">autre_truc</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"C'est mon autre truc à moi"</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">que_de_b</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"Méthode seulement de la classe fille"</span><span class="p">)</span>
</code></pre></div></div>

<p>Faites bien attention à utiliser proprement le mot-clé <code class="language-plaintext highlighter-rouge">super</code> dans le constructeur de la classe fille.</p>

</div></details>

<h3 id="attribut-de-classe">attribut de classe</h3>

<p>Ajoutez dans <code class="language-plaintext highlighter-rouge">A</code> un attribut de classe <code class="language-plaintext highlighter-rouge">CTE</code> constante valant <code class="language-plaintext highlighter-rouge">un attribut de classe</code></p>

<details><summary>solution</summary><div>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">A</span><span class="p">:</span>
    <span class="n">CTE</span> <span class="o">=</span> <span class="s">"un attribut de classe"</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">a</span> <span class="o">=</span> <span class="n">a</span>
    
    <span class="k">def</span> <span class="nf">truc_que_fait_a</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"Truc défini dans la classe mère"</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">truc_que_fait_a</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"Autre truc dans la classe mère"</span><span class="p">)</span>  
</code></pre></div></div>

</div></details>

<h3 id="combinaison-de-méthodes">combinaison de méthodes</h3>

<p>Ajoutez :</p>

<ul>
  <li>dans la  classe <code class="language-plaintext highlighter-rouge">A</code> : une méthode <code class="language-plaintext highlighter-rouge">j_herite(x)</code> qui prend un paramètre <code class="language-plaintext highlighter-rouge">x</code> qui est une chaine de caractère et affiche la valeur de x</li>
  <li>dans la  classe <code class="language-plaintext highlighter-rouge">B</code> : une méthode <code class="language-plaintext highlighter-rouge">j_herite(x)</code> qui commence par appeler la méthode de la classe mère puis affiche la valeur de x en majuscules</li>
</ul>

<details><summary>solution</summary><div>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">A</span><span class="p">:</span>
    <span class="n">CTE</span> <span class="o">=</span> <span class="s">"un attribut de classe"</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">a</span> <span class="o">=</span> <span class="n">a</span>

    <span class="k">def</span> <span class="nf">truc_que_fait_a</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"Truc défini dans la classe mère"</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">truc_que_fait_a</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"Autre truc dans la classe mère"</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">j_herite</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="k">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">B</span><span class="p">(</span><span class="n">A</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">().</span><span class="n">__init__</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">b</span> <span class="o">=</span> <span class="n">b</span>

    <span class="k">def</span> <span class="nf">autre_truc</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"C'est mon autre truc à moi"</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">que_de_b</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"Méthode seulement de la classe fille"</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">j_herite</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">().</span><span class="n">j_herite</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="n">x</span><span class="p">.</span><span class="n">upper</span><span class="p">())</span>
</code></pre></div></div>

</div></details>

  </div>

</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/cours_informatique/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">cours d&#39;informatique</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">cours d&#39;informatique</li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/FrancoisBrucker"><svg class="svg-icon"><use xlink:href="/cours_informatique/assets/minima-social-icons.svg#github"></use></svg> <span class="username">FrancoisBrucker</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>Support de cours/td d&#39;informatique à l&#39;école centrale marseille.</p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
