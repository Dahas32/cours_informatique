<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.7.1 -->
<title>les bases de données (relationnelles) | cours d’informatique</title>
<meta name="generator" content="Jekyll v4.2.0" />
<meta property="og:title" content="les bases de données (relationnelles)" />
<meta name="author" content="Adèle Bourgeix" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Support de cours/td d’informatique à l’école centrale marseille. A destination des 1A (tronc commun), des 2A (de l’approfondissement MIE) et des 3A (de l’option digital·e)" />
<meta property="og:description" content="Support de cours/td d’informatique à l’école centrale marseille. A destination des 1A (tronc commun), des 2A (de l’approfondissement MIE) et des 3A (de l’option digital·e)" />
<link rel="canonical" href="/cours_informatique/cours/dfs/bases_de_donnees.html" />
<meta property="og:url" content="/cours_informatique/cours/dfs/bases_de_donnees.html" />
<meta property="og:site_name" content="cours d’informatique" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="les bases de données (relationnelles)" />
<script type="application/ld+json">
{"description":"Support de cours/td d’informatique à l’école centrale marseille. A destination des 1A (tronc commun), des 2A (de l’approfondissement MIE) et des 3A (de l’option digital·e)","headline":"les bases de données (relationnelles)","@type":"WebPage","url":"/cours_informatique/cours/dfs/bases_de_donnees.html","author":{"@type":"Person","name":"Adèle Bourgeix"},"@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/cours_informatique/assets/main.css"><link type="application/atom+xml" rel="alternate" href="/cours_informatique/feed.xml" title="cours d'informatique" /><!-- Mathjax Support -->
  <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"] ],
        processEscapes: true
      }
    });
  </script>
  
  <script type="text/javascript" async
    src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML">
  </script>
</head>

<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/cours_informatique/">cours d&#39;informatique</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger">
            <a class="page-link" href="/cours_informatique/about"> about </a>
        </div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post">

  <header class="post-header">
    <h1 class="post-title">les bases de données (relationnelles)</h1>
  </header>

  <div class="post-content">
    <h2 id="introduction">Introduction</h2>

<p>Le but de ce tuto est de couvrir le sujet des bases de données relationnelles, en voyant dans un premier temps ce dont il s’agit, puis en mettant en pratique au travers de l’utilisation de sqlite.</p>

<h2 id="une-base-de-donnée-relationnelle-">Une base de donnée relationnelle ?</h2>

<p>Une base de donnée, ce n’est rien d’autre qu’une collection de données. Et les données, ça peut être un peu tout et n’importe quoi : des mesures de distances, de températures, les résultats des matchs de Ligue 1, les livres présents dans une bibliothèque, et cetera, et cetera.</p>

<p>Une base de donnée <strong>relationnelle</strong>, c’est une base de données où les données sont organisées dans des tableaux à deux dimensions (des tableaux quoi) que l’on appelle <em>relations</em> (d’où le nom :wink: ).</p>

<p>| Titre | Auteur | Date de parution originale |
| :—: | :—: | :—: |
| Les Raisins de la colère | John Steinbeck | 1939 |
| Les Chemins de la faim | Jorge Amaldo | 1946 |
| Sur la Route | Jack Kerouac | 1957 |
<em><center>Une exemple de relation</center></em></p>

<p>Une ligne d’une relation est appelée n-uplet ou enregistrement, et n’est donc rien d’autre qu’un ensemble de n valeurs. Dans l’exemple ci-dessus, n est égal 3.</p>

<p>Une colonne d’une relation est appelée un attribut. C’est une caractéristique des enregistrements. Dans notre exemple, le titre des livres est un attribut.</p>

<h2 id="la-grammaire-sql">La grammaire SQL</h2>

<p>A partir d’une grammaire simple, composé de quelques prépositions et verbes, on construit un ensemble de relations à partir de nos données. Ce langage s’appelle SQL pour Structured Query Language, language de requête structurée en français.</p>

<p>Imaginons que ma base de données est composée de deux relation :</p>
<ul>
  <li>une relation “livres”, qui est celle de notre premier exemple,</li>
  <li>une relation “auteurs”, qui a pour attribut le nom des auteurs, leur date de naissance, de mort, et leur nationalité :</li>
</ul>

<p>| Auteur | Date de naissance | Date de décès | Nationalité |
| :-: | :-: | :-: | :-: |
| John Steinbeck | 1902-02-27 | 1968-12-20 | Américaine |
| Jorge Amado | 1912-08-10 | 2001-08-06 | Brésilienne |
| Jack Kerouac | 1922-03-12 | 1969-10-21 | Américaine |
<em><center>la relation "auteurs"</center></em></p>

<p>Je peux alors construire une requête en langage SQL pour créer une nouvelle relation n’affichant que les livres des auteurs américains :</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="n">Titre</span> <span class="k">FROM</span> <span class="p">(</span><span class="n">livres</span> <span class="k">NATURAL</span> <span class="k">JOIN</span> <span class="n">auteurs</span><span class="p">)</span> <span class="k">WHERE</span> <span class="n">Nationalit</span><span class="err">é</span> <span class="o">=</span> <span class="nv">"Américaine"</span>
</code></pre></div></div>

<table>
  <thead>
    <tr>
      <th style="text-align: center">Titre</th>
      <th style="text-align: center">Auteur</th>
      <th style="text-align: center">Nationalité</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">Les Raisons de la colère</td>
      <td style="text-align: center">John Steinbeck</td>
      <td style="text-align: center">Américaine</td>
    </tr>
    <tr>
      <td style="text-align: center">Sur la Route</td>
      <td style="text-align: center">Jack Kerouac</td>
      <td style="text-align: center">Américaine</td>
    </tr>
  </tbody>
</table>

<h2 id="sql-et-sqlite">SQL et sqlite</h2>

<p>Cette section propose de montrer comment créer une base de données et manipuler les enregistrements qu’elle contient avec la syntaxe SQL. Pour ce faire, nous utiliserons sqlite, qui présente l’avantage de n’avoir aucune administration ou paramétrage initial à effectuer, car la base de donnée n’est pas stockée dans un serveur distant mais localement, dans un fichier en extension <code class="language-plaintext highlighter-rouge">.db</code>.</p>

<h3 id="installer-sqlite">Installer sqlite</h3>

<p>Le plus simple est d’utiliser un <em>package manager</em>, comme apt ou brew. Par exemple, avec brew :</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>brew <span class="nb">install </span>sqlite3
</code></pre></div></div>

<p>ou avec apt :</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>apt-get <span class="nb">install </span>sqlite3
</code></pre></div></div>

<h3 id="créer-une-base-de-données">Créer une base de données</h3>

<p>Pour créer une base de données, il suffit de lancer la commande <code class="language-plaintext highlighter-rouge">sqlite3</code> suivie du nom de la base. Par exemple :</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sqlite3 bibli.db
</code></pre></div></div>

<p>Un nouveau fichier bibli.db va être créé, et vous serez automatiquement basculé dans la console sqlite. C’est depuis cette console que nous lancerons toutes les commandes suivantes.</p>

<h3 id="créer-une-table-auteurs">Créer une table “auteurs”</h3>

<p>Nous allons commencer par créer une table “auteurs” dans laquelle nous enregistrerons le nom/prénom, la date de naissance, la date de décès et la nationalité de nos écrivains. Afin de pallier aux problèmes d’homonymie et autres, il est commun d’ajouter un attribut “id”, qui est un entier sur lequel on itère et qui constituera une clé primaire de notre base.</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">CREATE</span> <span class="k">TABLE</span> <span class="n">auteurs</span> <span class="p">(</span><span class="n">id</span> <span class="nb">integer</span> <span class="k">primary</span> <span class="k">key</span><span class="p">,</span> <span class="n">auteur</span> <span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">30</span><span class="p">),</span> <span class="n">dateNaissance</span> <span class="nb">date</span><span class="p">,</span> <span class="n">dateDeces</span> <span class="nb">date</span><span class="p">,</span> <span class="n">nationalite</span> <span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">30</span><span class="p">));</span>
</code></pre></div></div>

<h3 id="créer-une-table-romans">Créer une table “romans”</h3>

<p>De même, nous créons une table “romans” pour y stocker les tites des ouvrages, ainsi que leur auteur et leur date de parution originale.</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">CREATE</span> <span class="k">TABLE</span> <span class="n">romans</span> <span class="p">(</span><span class="n">id</span> <span class="nb">integer</span> <span class="k">primary</span> <span class="k">key</span><span class="p">,</span> <span class="n">titre</span> <span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">30</span><span class="p">),</span> <span class="n">auteur</span> <span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">30</span><span class="p">),</span> <span class="n">dateParution</span> <span class="nb">date</span><span class="p">);</span>
</code></pre></div></div>

<h3 id="voir-les-tables-existantes">Voir les tables existantes</h3>

<p>A ce stade, on peut vouloir visualiser les tables dont notre base de données dispose :</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">.</span><span class="n">tables</span>
</code></pre></div></div>

<p>Cette commande doit retourner les noms de nos deux tables : <code class="language-plaintext highlighter-rouge">auteurs</code> et <code class="language-plaintext highlighter-rouge">romans</code>.</p>

<h3 id="enregistrer-des-données">Enregistrer des données</h3>

<p>On va maintenant ajouter nos enregistrements dans les tables :</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="k">INSERT</span> <span class="k">INTO</span> <span class="nv">"auteurs"</span> <span class="k">VALUES</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nv">"John Steinbeck"</span><span class="p">,</span> <span class="mi">1902</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">27</span><span class="p">,</span> <span class="mi">1968</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">20</span><span class="p">,</span> <span class="nv">"Américaine"</span><span class="p">);</span>
 <span class="k">INSERT</span> <span class="k">INTO</span> <span class="nv">"auteurs"</span> <span class="k">VALUES</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="nv">"Jorge Amado"</span><span class="p">,</span> <span class="nv">"1912-08-10"</span><span class="p">,</span> <span class="nv">"2001-08-06"</span><span class="p">,</span> <span class="nv">"Brésilienne"</span><span class="p">);</span>
 <span class="k">INSERT</span> <span class="k">INTO</span> <span class="nv">"auteurs"</span> <span class="k">VALUES</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="nv">"Jack kerouac"</span><span class="p">,</span> <span class="nv">"1922-03-12"</span><span class="p">,</span> <span class="nv">"1969-10-21"</span><span class="p">,</span> <span class="nv">"Américaine"</span><span class="p">);</span>
</code></pre></div></div>

<p>et</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">romans</span> <span class="k">VALUES</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nv">"Les Raisins de la colère"</span><span class="p">,</span> <span class="nv">"John Steinbeck"</span><span class="p">,</span> <span class="nv">"1939"</span><span class="p">);</span>
<span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">romans</span> <span class="k">VALUES</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="nv">"Les Chemins de la faim"</span><span class="p">,</span> <span class="nv">"Jorge Amado"</span><span class="p">,</span> <span class="nv">"1946"</span><span class="p">);</span>
<span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">romans</span> <span class="k">VALUES</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="nv">"Sur la Route"</span><span class="p">,</span> <span class="nv">"Jack Keouac"</span><span class="p">,</span> <span class="nv">"1957"</span><span class="p">);</span>
</code></pre></div></div>

<h3 id="modifier-un-enregistrement">Modifier un enregistrement</h3>

<p>Pour modifier un enregistrement, par exemple si un auteur contemporain décède et qu’il faut donc ajouter sa date de décès à la table, on utilise la méthode <code class="language-plaintext highlighter-rouge">UPDATE</code> :</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">UPDATE</span> <span class="n">auteurs</span> <span class="k">SET</span> <span class="n">dateDeces</span> <span class="o">=</span> <span class="nv">"1922-03-12"</span> <span class="k">WHERE</span> <span class="n">id</span><span class="o">=</span><span class="mi">3</span><span class="p">;</span>
</code></pre></div></div>

<h3 id="visualiser-nos-tables">Visualiser nos tables</h3>

<p>Pour visualiser nos tables, il faut passer par une requête sql demandant à sqlite de nous afficher tous les éléments. Par exemple, pour voir notre tableau d’auteurs, on utilisera :</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">auteurs</span>
</code></pre></div></div>

<p>On peut au passage changer l’affichage par défaut, ce qui est bien utile pour mieux visualiser les tables. On utilise courament un affichage avec en-têtes et en colonnes. Pour le mettre en place, il faut exécuter :</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">.</span><span class="n">headers</span> <span class="k">on</span>
<span class="p">.</span><span class="k">mode</span> <span class="k">column</span>
</code></pre></div></div>

<p>Réessayez maintenant d’afficher la table des auteurs. C’est plus lisible, non ?</p>

<h3 id="visualiser-des-relations-composées">Visualiser des relations composées</h3>

<p>On aura souvent besoin d’afficher des tableaux composés à partir des tables initiales. Par exemple, on peut vouloir voir tous les restaurants proposant de la cuisine indienne. Ou encore, tous les romans de notre bibliothèque dont l’auteur est américain. Pour ce faire, on réalise une jointure de nos deux tables, et on récupère les titres des romans dont l’auteur est de nationalité américaine :</p>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">SELECT</span> <span class="n">titre</span> <span class="k">FROM</span> <span class="p">(</span><span class="n">romans</span> <span class="k">NATURAL</span> <span class="k">JOIN</span> <span class="n">auteurs</span><span class="p">)</span> <span class="k">WHERE</span> <span class="n">nationalite</span> <span class="o">=</span> <span class="nv">"Américaine"</span><span class="p">;</span>
</code></pre></div></div>

<p>NB : on doit ici réaliser une jointure car la donnée que l’on recherche (les titres des romans) et la donnée sur laquelle on discrimine (la nationalité de l’auteur) ne sont pas dans les mêmes tables. Ces deux tables sont ici jointes de manière “naturelle” car elles ont un champ “auteur” en commun.</p>

<p>On obtient en résultat le tableau suivant des romans écrit par un auteur américain :</p>

<table>
  <thead>
    <tr>
      <th style="text-align: center">titre</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">Les Raisins de la colère</td>
    </tr>
    <tr>
      <td style="text-align: center">Sur la Route</td>
    </tr>
  </tbody>
</table>

<h2 id="utiliser-sqlite-avec-nodejs">Utiliser sqlite avec Nodejs</h2>

<p>Dans les faits, on n’utilisera pas nécessairement sqlite depuis l’interface de commande, mais plutôt depuis un programme qui utilisera une base de données sqlite. Dans la dernière partie de ce tutoriel, nous verrons donc comment relier une base de données sqlite à un programme écrit en nodejs, et comment faire des requêtes en lecture et en écriture à cette base de données, depuis le programme.</p>

<p>NB : la plupart des langages de programmation disposent d’une librairie sqlite. Nous avons fait le choix de présenter celle de Nodejs, mais il en existe bien d’autres, suivant les langages utilisés dans votre projet.</p>

<p>Globalement, l’ordre des opérations est un peu toujours le même :</p>
<ol>
  <li>Installer le module sqlite</li>
  <li>L’importer dans le projet</li>
  <li>Créer un objet “base de données”, en mémoire ou sur le disque dur</li>
  <li>Ouvrir la connexion à la base de données</li>
  <li>Manipuler les données (lecture/écriture)</li>
  <li>Fermer la connexion à la base de données</li>
</ol>

<p>Pour plus de détails, voir les très bons tutos de <a href="https://www.sqlitetutorial.net/sqlite-nodejs/">sqlitetutorial</a>, à suivre dans l’ordre.</p>

  </div>

</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/cours_informatique/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">cours d&#39;informatique</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">cours d&#39;informatique</li><li><a class="u-email" href="mailto:francois.brucker@centrale-marseille.fr">francois.brucker@centrale-marseille.fr</a></li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/FrancoisBrucker"><svg class="svg-icon"><use xlink:href="/cours_informatique/assets/minima-social-icons.svg#github"></use></svg> <span class="username">FrancoisBrucker</span></a></li><li><a href="https://www.twitter.com/p_____p___"><svg class="svg-icon"><use xlink:href="/cours_informatique/assets/minima-social-icons.svg#twitter"></use></svg> <span class="username">p_____p___</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>Support de cours/td d&#39;informatique à l&#39;école centrale marseille.
A destination des 1A (tronc commun), des 2A (de l&#39;approfondissement MIE) et des 3A (de l&#39;option digital·e)</p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
