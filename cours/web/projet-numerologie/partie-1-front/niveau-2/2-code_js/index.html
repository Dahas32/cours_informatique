<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1"/>

    <title>Projet numérologie / partie 1 : front / niveau 2 / code js</title>

    <link href=/cours_informatique/assets/node_modules/prismjs/themes/prism-solarizedlight.min.css rel="stylesheet">
    <link href=/cours_informatique/assets/node_modules/prismjs/plugins/line-numbers/prism-line-numbers.min.css rel="stylesheet">

    <link href=/cours_informatique/assets/stylesheets/main.css rel="stylesheet">

  </head>
  <body>
    <script>
      window.MathJax = {
        tex: {
          inlineMath: [
            [
              '$', '$'
            ],
            [
              '\\(', '\\)'
            ]
          ]
        },
        svg: {
          fontCache: 'global'
        }
      };
    </script>
    <script type="text/javascript" id="MathJax-script" async
  src=/cours_informatique/assets/node_modules/mathjax/es5/tex-svg-full.js></script>
  
    <header class="border-b-2 border-gray-200 mb-4">
      <div class="max-w-[1000px] mx-auto px-4">
        <div class="min-h-[50px] flex justify-between items-center">
          <a class="mx-2" href="/cours_informatique/">Home</a>
          <a class="mx-2" href="/cours_informatique/about">About</a>
        </div>
      </div>
    </header>

    <main class="max-w-[1000px] mx-auto px-4">
      
<article>

  <h1  class="mb-1">Projet numérologie / partie 1 : front / niveau 2 / code js</h1>
  <div class="mb-4">
    

    
      <div class=" px-4 flex items-center">
        
          <div class="font-bold">Auteur : </div>
        
        <ul class="flex not-prose list-none my-0 last:after:content-['•'] last:after:px-1 mx-0 px-1">
          
            <li class="before:content-['•'] before:px-1">François Brucker</li>
          
        </ul>
      </div>
    
  </div>

  
    
<div class="quote relative  py-2 drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-purple-500 bg-purple-100">
<svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 text-purple-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
  <path stroke-linecap="round" stroke-linejoin="round" d="M5 19a2 2 0 01-2-2V7a2 2 0 012-2h4l2 2h4a2 2 0 012 2v1M5 19h14a2 2 0 002-2v-5a2 2 0 00-2-2H9a2 2 0 00-2 2v5a2 2 0 01-2 2z" />
</svg>
<div class="pl-8 mr-8">

<a href="/cours_informatique/cours/">Cours</a><span class="px-1">/</span><a href="/cours_informatique/cours/web/">Web</a><span class="px-1">/</span><a href="/cours_informatique/cours/web/projet-numerologie/">Projet numérologie</a><span class="px-1">/</span><a href="/cours_informatique/cours/web/projet-numerologie/partie-1-front/">Projet numérologie / partie 1 : front</a><span class="px-1">/</span><a href="/cours_informatique/cours/web/projet-numerologie/partie-1-front/niveau-2/">Projet numérologie / partie 1 : front / niveau 2</a><span class="px-1">/</span><a href="/cours_informatique/cours/web/projet-numerologie/partie-1-front/niveau-2/2-code_js/">Projet numérologie / partie 1 : front / niveau 2 / code js</a>

</div></div>

  

  <!-- début résumé -->
<p>Code de la <em>logique métier</em> du projet. L'idée est de montrer comment on peut progresser en codant nous même, un item en amenant un autre à coder.</p>
<!-- fin résumé -->
<h2>Todos initiaux</h2>
<p>Il faut tout faire :</p>
<ul>
<li>[ ] associer un chiffre à un nom</li>
<li>[ ] créer un champ texte dans un fichier html</li>
<li>[ ] récupérer en html le contenu d'un champ texte lorsque l'on appuie sur la touche entrée</li>
<li>[ ] modifier l'arbre DOM avec du texte</li>
<li>[ ] récupérer un info de l'url et la traiter</li>
</ul>
<h2>Choix de la première tâche</h2>
<div class="quote relative drop-shadow  py-2 pr-2 rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-amber-800 bg-amber-100">
<svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 text-amber-800" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
  <path stroke-linecap="round" stroke-linejoin="round" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
</svg>
<div class="pl-8 mr-8">
<p>Quelle est la tâche la plus simple à réaliser dans nos todos ?</p>
</div></div>
<p>Le cœur du projet est d'associer un numéro à un nom, donc autant essayer de faire ça en javascript.</p>
<div class="quote relative drop-shadow  py-2 pr-2 rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-amber-800 bg-amber-100">
<svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 text-amber-800" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
  <path stroke-linecap="round" stroke-linejoin="round" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
</svg>
<div class="pl-8 mr-8">
<p>On modifie le fichier <code class="fichier">numerologie/todo/todos.md</code> pour refléter le fait qu'on travaille sur cet item.</p>
</div></div>
<ul>
<li>[X] associer un chiffre à un nom</li>
<li>[ ] créer un champ texte dans un fichier html</li>
<li>[ ] récupérer en html le contenu d'un champ texte lorsque l'on appuie sur la touche entrée</li>
<li>[ ] modifier l'arbre DOM avec du texte</li>
<li>[ ] récupérer un info de l'url et la traiter</li>
</ul>
<p>Bon c'est pas encore très détaillé. Comment faire ça ?</p>
<ol>
<li>déjà un nom c'est une chaîne de caractère codée en utf-8</li>
<li>on peut prendre le numéro Unicode/utf8 de chaque caractère et les sommer</li>
<li>il faut un chiffre donc comment passer d'un nombre à un chiffre ?</li>
<li>on peut sommer les chiffre du nombre pour obtenir un autre nombre strictement plus petit ($10.x + y &lt; x + y$) et recommencer la procédure si ce n'est pas un chiffre.</li>
</ol>
<p>Ajoutons nos réflexions à la todo list (fichier <code class="fichier">numerologie/todo/todos.md</code>) :</p>
<pre><code>* [X] associer un chiffre à un nom
  * [ ] numéro Unicode/utf8 d'un caractère
  * [ ] sommer des numéro des caractères d'une chaîne de caractères
  * [ ] sommer les chiffre d'un nombre
  * [ ] sommer itérativement jusqu'à convergence (car $10x + y &gt; x+y$ si $x &gt; 0$)
* [ ] créer un champ texte dans un fichier html
* [ ] récupérer en html le contenu d'un champ texte lorsque l'on appuie sur la touche entrée
* [ ] modifier l'arbre DOM avec du texte
* [ ] récupérer un info de l'url et la traiter
</code></pre>
<div class="quote relative  py-2 drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-cyan-500 bg-cyan-100">
<svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 text-cyan-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
  <path stroke-linecap="round" stroke-linejoin="round" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z" />
</svg>
<div class="pl-8 mr-8">
<p>Au passage, vous avez vu comment on a mis des maths dans du markdown ? Lorsque vous transformerez le markdown en html, <a href="https://www.mathjax.org/">Mathjax</a> rendra ces équations toutes jolies.</p>
</div></div>
<p>Quel est l'item le plus simple à résoudre ? A mon avis c'est lui :</p>
<ul>
<li>[X] associer un chiffre à un nom
<ul>
<li>[X] numéro Unicode/utf8 d'un caractère</li>
<li>[ ] sommer des numéro des caractères d'une chaîne de caractères</li>
<li>[ ] sommer les chiffre d'un nombre</li>
<li>[ ] sommer itérativement jusqu'à convergence (car $10x + y &gt; x+y$ si $x &gt; 0$)</li>
</ul>
</li>
<li>[ ] créer un champ texte dans un fichier html</li>
<li>[ ] récupérer en html le contenu d'un champ texte lorsque l'on appuie sur la touche entrée</li>
<li>[ ] modifier l'arbre DOM avec du texte</li>
<li>[ ] récupérer un info de l'url et la traiter</li>
</ul>
<p>On va aller plus vite dans ce cours ensuite. Mais l(idée est toujours la suivante : dans votre listes de todos vous devez avoir un item qui vous semble le plus <em>facile</em> à résoudre. Si ce n'est pas le cas, c'est que vous items sont trop gros et qu'il faut les décomposer en unité plus fine.</p>
<div class="quote relative drop-shadow  py-2 pr-2 rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-amber-800 bg-amber-100">
<svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 text-amber-800" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
  <path stroke-linecap="round" stroke-linejoin="round" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
</svg>
<div class="pl-8 mr-8">
<p>Que signifie <em>le plus facile à résoudre</em> ? C'est un item dont l'implémentation ne nécessite qu'une seule chose à faire, et que cette chose à faire est simple.</p>
</div></div>
<h2>Tache 1 : Unicode d'un caractère</h2>
<div class="quote relative drop-shadow  py-2 pr-2 rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-amber-800 bg-amber-100">
<svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 text-amber-800" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
  <path stroke-linecap="round" stroke-linejoin="round" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
</svg>
<div class="pl-8 mr-8">
<p>On utilise l'<a href="../../niveau-1/2-code_js#tache-1">implémentation du niveau 1</a> pour associer un nombre à un caractère Unicode.</p>
</div></div>
<h2>Tache 2 : caractères et nombre</h2>
<p>Ce qui nous permet de passer à l'item suivant :</p>
<ul>
<li>[X] associer un chiffre à un nom
<ul>
<li>[X] <s>numéro Unicode/utf8 d'un caractère</s></li>
<li>[X] sommer des numéro des caractères d'une chaîne de caractères</li>
<li>[ ] sommer les chiffre d'un nombre</li>
<li>[ ] sommer itérativement jusqu'à convergence (car $10x + y &gt; x+y$ si $x &gt; 0$)</li>
</ul>
</li>
<li>[ ] créer un champ texte dans un fichier html</li>
<li>[ ] récupérer en html le contenu d'un champ texte lorsque l'on appuie sur la touche entrée</li>
<li>[ ] modifier l'arbre DOM avec du texte</li>
<li>[ ] récupérer un info de l'url et la traiter</li>
</ul>
<div class="quote relative drop-shadow  py-2 pr-2 rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-amber-800 bg-amber-100">
<svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 text-amber-800" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
  <path stroke-linecap="round" stroke-linejoin="round" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
</svg>
<div class="pl-8 mr-8">
<p>Qu'on <a href="../../niveau-1/2-code_js#tache-2">implémente comme au niveau 1</a>. Nos todos deviennent :</p>
</div></div>
<ul>
<li>[X] associer un chiffre à un nom
<ul>
<li>[X] <s>numéro Unicode/utf8 d'un caractère</s></li>
<li>[X] <s>sommer des numéro des caractères d'une chaîne de caractères</s></li>
<li>[ ] sommer les chiffre d'un nombre</li>
<li>[ ] sommer itérativement jusqu'à convergence (car $10x + y &gt; x+y$ si $x &gt; 0$)</li>
</ul>
</li>
<li>[ ] créer un champ texte dans un fichier html</li>
<li>[ ] récupérer en html le contenu d'un champ texte lorsque l'on appuie sur la touche entrée</li>
<li>[ ] modifier l'arbre DOM avec du texte</li>
<li>[ ] récupérer un info de l'url et la traiter</li>
</ul>
<p>On a bien progressé. La tâche qui semble la plus simple maintenant est de finaliser la partie consacrée à l'association d'un chiffre à un nom.</p>
<h2>Tache 3 : chiffres et nombre</h2>
<p>Je choisis de faire :</p>
<ul>
<li>[X] associer un chiffre à un nom
<ul>
<li>[X] <s>numéro Unicode/utf8 d'un caractère</s></li>
<li>[X] <s>sommer des numéro des caractères d'une chaîne de caractères</s></li>
<li>[X] sommer les chiffre d'un nombre</li>
<li>[ ] sommer itérativement jusqu'à convergence (car $10x + y &gt; x+y$ si $x &gt; 0$)</li>
</ul>
</li>
<li>[ ] créer un champ texte dans un fichier html</li>
<li>[ ] récupérer en html le contenu d'un champ texte lorsque l'on appuie sur la touche entrée</li>
<li>[ ] modifier l'arbre DOM avec du texte</li>
<li>[ ] récupérer un info de l'url et la traiter</li>
</ul>
<div class="quote relative drop-shadow  py-2 pr-2 rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-amber-800 bg-amber-100">
<svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 text-amber-800" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
  <path stroke-linecap="round" stroke-linejoin="round" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
</svg>
<div class="pl-8 mr-8">
<p>Encore une fois on utilise l'<a href="../../niveau-1/2-code_js#tache-3">implémentation de niveau 1</a>. Nous allons cependant modifier la façon dont on teste nos méthodes.</p>
</div></div>
<h2>Test du code</h2>
<p>La gestion des tests du niveau 1 n'est pas satisfaisante car elle mélange code et tests. Nous n'allons pas encore utiliser des bibliothèques dédiées aux tests (c'est le boulot des niveaux suivants), mais nous allons faire en sorte de pouvoir effectuer des tests :</p>
<ul>
<li>sans modifier le code,</li>
<li>sans avoir à supprimer/commenter les tests ensuite.</li>
</ul>
<p>Ceci nous permettra déjà de pouvoir ajouter ds tests sans y réfléchir de façon fluide et sans modifier le code. Ce qui sera utile lorsque le code sera déjà en production (ce qui est le but de tout code) ou si nous sommes plusieurs à coder sur le même projet (ce qui est la norme).</p>
<h3>Méthode</h3>
<p>On va procéder comme si l'on importait du javascript dans une page web : on va lire le fichier de code sous la forme d'une longue chaîne de caractères et l'évaluer dans l'interpréteur. On pourra ensuite utiliser les fonctions comme si on venait de les taper.</p>
<div class="quote relative  py-2 drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-cyan-500 bg-cyan-100">
<svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 text-cyan-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
  <path stroke-linecap="round" stroke-linejoin="round" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z" />
</svg>
<div class="pl-8 mr-8">
<p>On ne peut pas utiliser d'import classique de fichiers ici, car il faut que le fichier de code soit dans un format spécial, ce qui n'est pas le cas ici.</p>
</div></div>
<h4><span id="node-fichier"></span> Lecture d'un fichier texte</h4>
<p>La lecture de fichiers se fait de façon aisé avec node en utilisant la bibliothèque <a href="https://nodejs.org/api/fs.html#fs_file_system"><code class="language-">fs</code></a>. On va utiliser : <a href="https://nodejs.org/api/fs.html#fs_fs_readfilesync_path_options"><code class="language-">fs.readFileSync()</code></a>.</p>
<div class="quote relative drop-shadow  py-2 pr-2 rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-amber-800 bg-amber-100">
<svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 text-amber-800" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
  <path stroke-linecap="round" stroke-linejoin="round" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
</svg>
<div class="pl-8 mr-8">
<p>La plupart des méthodes et fonctions de node sont asynchrones, c'est à dire que l'on attend pas que la méthode soit fini pour continuer l'exécution de notre code. Nous n'allons pas faire ça ici car ça complique (même si c'est mieux) le fonctionnement.</p>
</div></div>
<p>Testons ça dans un node :</p>
<pre class="language-javascript " style="counter-reset: linenumber 0"><code class="language-javascript"><span class="token operator">></span> contenu_du_fichier <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span><span class="token string">"./numerologie.js"</span><span class="token punctuation">)</span>
<span class="token operator">&lt;</span>Buffer 6e 6f 6d <span class="token number">20</span> 3d <span class="token number">20</span> <span class="token number">22</span> 6d 6f 6e <span class="token number">64</span> <span class="token number">65</span> <span class="token number">22</span> 0a 0a <span class="token number">63</span> 6f 6e <span class="token number">73</span> 6f 6c <span class="token number">65</span> 2e 6c 6f <span class="token number">67</span> <span class="token number">28</span> <span class="token number">22</span> <span class="token number">62</span> 6f 6e 6a 6f <span class="token number">75</span> <span class="token number">72</span> <span class="token number">20</span> <span class="token number">22</span> <span class="token number">20</span> 2b <span class="token number">20</span> 6e 6f 6d <span class="token number">20</span> 2b <span class="token number">20</span> <span class="token number">22</span> <span class="token number">20</span> <span class="token number">21</span> <span class="token number">22</span> <span class="token operator">...</span> <span class="token number">1</span> more byte<span class="token operator">></span>
<span class="token operator">></span>
</code></pre>
<p>Bon ben c'est pas ce qu'on voulait. Un fichier est évalué comme un <a href="https://fr.wikipedia.org/wiki/Fichier_binaire">fichier binaire</a> par défaut... On recommence en précisant qu'on veut du texte :</p>
<pre class="language-javascript " style="counter-reset: linenumber 0"><code class="language-javascript"><span class="token operator">></span> contenu_du_fichier <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span><span class="token string">"./numerologie.js"</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token literal-property property">encoding</span><span class="token operator">:</span><span class="token string">'utf8'</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">[</span><span class="token operator">...</span> snip <span class="token operator">...</span><span class="token punctuation">]</span>
<span class="token operator">></span>
</code></pre>
<div class="quote relative  py-2 drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-cyan-500 bg-cyan-100">
<svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 text-cyan-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
  <path stroke-linecap="round" stroke-linejoin="round" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z" />
</svg>
<div class="pl-8 mr-8">
<p>A la place de <code>[... snip ...]</code> vous devriez voir le contenu de votre fichier.</p>
</div></div>
<p>C'est une pratique courante en javascript de déclarer tous les paramètres en 1 fois, ici l'encodage du fichier, avec un <a href="https://developer.mozilla.org/fr/docs/Learn/JavaScript/Objects/Basics">objet</a> (qui ressemble furieusement à un dictionnaire si vous venez de python).</p>
<div class="quote relative  py-2 drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-cyan-500 bg-cyan-100">
<svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 text-cyan-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
  <path stroke-linecap="round" stroke-linejoin="round" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z" />
</svg>
<div class="pl-8 mr-8">
<p>Il n'y a pas de différence fondamentale entre fichier binaire et texte, ce n'est que l'interprétation qui change. Dans un cas, les bits sont des nombres, de l'autre on associe ces nombres au caractères utf-8.</p>
</div></div>
<h4>Evaluation d'un fichier</h4>
<div class="quote relative  py-2 drop-shadow rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-yellow-500 bg-yellow-100">
<svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 text-yellow-500" xmlns="http://www.w3.org/2000/svg"  fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
  <path stroke-linecap="round" stroke-linejoin="round" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z" />
  <path stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
</svg>
<div class="pl-8 mr-8">
<p>Commentez nos précédents tests pour qu'ils ne soient pas évalués.</p>
</div></div>
<p>Puis on peut utiliser <a href="https://developer.mozilla.org/fr/docs/Web/JavaScript/Reference/Global_Objects/eval"><code class="language-">eval</code></a> :</p>
<p>Dans un nouveau node :</p>
<pre class="language-javascript " style="counter-reset: linenumber 0"><code class="language-javascript"><span class="token operator">></span> contenu_du_fichier <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span><span class="token string">"./numerologie.js"</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token literal-property property">encoding</span><span class="token operator">:</span><span class="token string">'utf8'</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">[</span><span class="token operator">...</span> snip <span class="token operator">...</span><span class="token punctuation">]</span>
<span class="token operator">></span> <span class="token function">eval</span><span class="token punctuation">(</span>contenu_du_fichier<span class="token punctuation">)</span>
<span class="token keyword">undefined</span>
<span class="token operator">></span> <span class="token function">somme</span><span class="token punctuation">(</span><span class="token string">"123"</span><span class="token punctuation">)</span>
<span class="token number">6</span>
<span class="token operator">></span> 
</code></pre>
<h3>Un fichier de test</h3>
<p>On va déporter les tests du fichier de code à un fichier de test :</p>
<ul>
<li>créez un nouveau dossier <code class="fichier">numerologie/tests/</code></li>
<li>créez un fichier <code class="fichier">numerologie/tests/tests_numerologie.js</code> où l'on pourra recopier nos tests.</li>
</ul>
<p>Le fichier <code class="fichier">numerologie/tests/tests_numerologie.js</code> :</p>
<pre class="language-javascript " style="counter-reset: linenumber 0"><code class="language-javascript">fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span>

<span class="token function">eval</span><span class="token punctuation">(</span>fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span><span class="token string">"../numerologie.js"</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token literal-property property">encoding</span><span class="token operator">:</span><span class="token string">'utf8'</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">// test de somme(nombre)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">somme</span><span class="token punctuation">(</span><span class="token number">132</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">// avec un chiffre : charAt != charCodeAt</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">somme</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"4"</span><span class="token punctuation">.</span><span class="token function">charCodeAt</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"4"</span><span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">// conversion chaîne de caractères et nombre</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> <span class="token string">"4"</span><span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">parseInt</span><span class="token punctuation">(</span><span class="token string">"4"</span><span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> <span class="token function">parseInt</span><span class="token punctuation">(</span><span class="token string">"4"</span><span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">// fin de test de somme(nombre)</span>
</code></pre>
<p>On peut maintenant supprimer vos tests de <em>&quot;numerologie/numerologie.js</em>. On pourra exécuter nos tests facilement dans terminal en se plaçant dans le dossier <em>&quot;numerologie/tests&quot;</em> puis en exécutant la commande : <code class="fichier">node test_numerologie.js</code>.</p>
<p>Plusieurs remarques :</p>
<ul>
<li>on a été obligé d'importer la bibliothèque <code class="language-">fs</code>. Dans un interpréteur node elle est importée par défaut, pas lorsque l'on exécute le fichier. Retenez d'un import node que l'on utilise <a href="https://nodejs.org/en/knowledge/getting-started/what-is-require/"><code class="language-">require</code></a> et que l'<strong>on importe quelque chose</strong> : le résultat de l'import doit être placé dans une variable</li>
<li>on importe depuis un fichier dans le dossier <code class="fichier">tests</code>. Le fichier <code class="fichier">numerologie/numerologie.js</code> étant dans le dossier parent, on utilise la <a href="/cours_informatique/tutoriels/fichiers-navigation/#block-.-..">notation <em>&quot;../</em>&quot;</a>.</li>
<li>on a combiné la lecture et l'eval en une seule ligne.</li>
</ul>
<h2>Tache 4 : somme itérative</h2>
<p>On peut terminer cette partie en faisant l'item :</p>
<ul>
<li>[X] associer un chiffre à un nom
<ul>
<li>[X] <s>numéro Unicode/utf8 d'un caractère</s></li>
<li>[X] <s>sommer des numéro des caractères d'une chaîne de caractères</s></li>
<li>[X] <s>sommer les chiffre d'un nombre</s></li>
<li>[X] sommer itérativement jusqu'à convergence (car $10x + y &gt; x+y$ si $x &gt; 0$)</li>
</ul>
</li>
<li>[ ] créer un champ texte dans un fichier html</li>
<li>[ ] récupérer en html le contenu d'un champ texte lorsque l'on appuie sur la touche entrée</li>
<li>[ ] modifier l'arbre DOM avec du texte</li>
<li>[ ] récupérer un info de l'url et la traiter</li>
</ul>
<div class="quote relative drop-shadow  py-2 pr-2 rounded rounded-tl-none rounded-bl-none border-solid border-l-8 border-amber-800 bg-amber-100">
<svg class="absolute w-7 h-7 pl-1 pt-0.5 pb-0.5 text-amber-800" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
  <path stroke-linecap="round" stroke-linejoin="round" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
</svg>
<div class="pl-8 mr-8">
<p>On procède <a href="../../niveau-1/2-code_js#tache-4">comme au niveau 1</a>, en ajoutant les tests à notre tout nouveau fichier <code class="fichier">numerologie/tests/tests_numerologie.js</code>.</p>
</div></div>
<h2>Todos finaux</h2>
<ul>
<li>[X] associer un chiffre à un nom
<ul>
<li>[X] <s>numéro Unicode/utf8 d'un caractère</s></li>
<li>[X] <s>sommer des numéro des caractères d'une chaîne de caractères</s></li>
<li>[X] <s>sommer les chiffre d'un nombre</s></li>
<li>[X] <s>sommer itérativement jusqu'à convergence (car $10x + y &gt; x+y$ si $x &gt; 0$)</s></li>
</ul>
</li>
<li>[ ] créer un champ texte dans un fichier html</li>
<li>[ ] récupérer en html le contenu d'un champ texte lorsque l'on appuie sur la touche entrée</li>
<li>[ ] modifier l'arbre DOM avec du texte</li>
<li>[ ] récupérer un info de l'url et la traiter</li>
</ul>
<p>La partie javascript semble terminée pour l'instant. On peut s'attaquer à ce qui semble le plus simple, la page web.</p>


</article>
    </main>

    <footer class="min-h-[50px] border-t-2 border-gray-200 mt-4">
      <div class="max-w-[1000px] mx-auto px-4">
        <div class="min-h-[50px] flex justify-center items-center">
          <p>
            Cours d'informatique à l'école centrale Marseille
          </p>
        </div>
      </div>
    </footer>

  <script>
    MathJax.startup.document.getMathItemsWithin(document.body);
  </script>

  </body>
</html>