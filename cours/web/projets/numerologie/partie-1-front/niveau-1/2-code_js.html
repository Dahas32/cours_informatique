<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.7.1 -->
<title>Projet numérologie : niveau 1/partie 1/code js | cours d’informatique</title>
<meta name="generator" content="Jekyll v4.2.0" />
<meta property="og:title" content="Projet numérologie : niveau 1/partie 1/code js" />
<meta name="author" content="François Brucker" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Support de cours/td d’informatique à l’école centrale marseille." />
<meta property="og:description" content="Support de cours/td d’informatique à l’école centrale marseille." />
<link rel="canonical" href="/cours_informatique/cours/web/projets/numerologie/partie-1-front/niveau-1/2-code_js.html" />
<meta property="og:url" content="/cours_informatique/cours/web/projets/numerologie/partie-1-front/niveau-1/2-code_js.html" />
<meta property="og:site_name" content="cours d’informatique" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Projet numérologie : niveau 1/partie 1/code js" />
<script type="application/ld+json">
{"headline":"Projet numérologie : niveau 1/partie 1/code js","description":"Support de cours/td d’informatique à l’école centrale marseille.","@type":"WebPage","url":"/cours_informatique/cours/web/projets/numerologie/partie-1-front/niveau-1/2-code_js.html","author":{"@type":"Person","name":"François Brucker"},"@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/cours_informatique/assets/main.css">

  <link rel="stylesheet" href="/cours_informatique/assets/custom.css"><link type="application/atom+xml" rel="alternate" href="/cours_informatique/feed.xml" title="cours d'informatique" /><!-- Mathjax Support -->
  <script>
    MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']],
      },
      svg: {
        fontCache: 'global'
      }
    };
    </script>
    <script type="text/javascript" id="MathJax-script" async
      src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js">
    </script>
</head>

<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/cours_informatique/">cours d&#39;informatique</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger">
            <a class="page-link" href="/cours_informatique/about"> about </a>
        </div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post">

  <header class="post-header">
    <h1 class="post-title">Projet numérologie : niveau 1/partie 1/code js</h1></p>Auteur : <span itemprop="author" itemscope itemtype="http://schema.org/Person"><span class="p-author h-card" itemprop="name">François Brucker</span></span></p>
  </header>

  <div class="post-content">
    <blockquote class="chemin">
  <p><a href="/cours_informatique/cours/web/projets/numerologie/">numérologie</a> / <a href="/cours_informatique/cours/web/projets/numerologie/partie-1-front/">partie 1</a> / <a href="/cours_informatique/cours/web/projets/numerologie/partie-1-front/niveau-1/">niveau 1</a> / <a href="/cours_informatique/cours/web/projets/numerologie/partie-1-front/niveau-1/2-code_js.html">code js</a></p>
</blockquote>

<p>Code de la <em>logique métier</em> du projet.</p>

<h2 id="tache-1">Tâche 1 : unicode d’un caractère</h2>

<p>Chaque caractère est associé à un nombre (les ordinateurs ne comprennent que les entiers). Le codage de caractère utilisé est <a href="https://fr.wikipedia.org/wiki/Unicode">unicode</a>. Il est fait pour pouvoir écrire toutes les langues du monde.</p>

<blockquote>
  <p>l’<a href="https://unicode-table.com/fr/">ensemble des caractères unicode</a></p>
</blockquote>

<p>Comme cela fait beaucoup de caractères, on utilise des encodages à tailles variables pour que le moindre bout de texte ne fasse des mégaoctets. Le standard est l’encodage <a href="https://fr.wikipedia.org/wiki/UTF-8">UTF-8</a> (on peut aussi le noter “utf8”) : tous vos textes doivent être encodés en utf-8 (sinon c’est <em>bad karma</em>).</p>

<blockquote>
  <p>Ne confondez pas utf8 et unicode. Même s’ils sont liés ce n’est pas la même chose. En particulier il existe d’autres façon d’encoder l’unicode comme l’<a href="https://fr.wikipedia.org/wiki/UTF-16">utf-16</a> par exemple.</p>
</blockquote>

<p>Notez que l’usage veut que les nombre associé à chaque caractères soient écrit en <a href="(https://fr.wikipedia.org/wiki/Syst%C3%A8me_hexad%C3%A9cimal)">hexadécimal</a> sur 4 digit précédé de <code class="language-plaintext highlighter-rouge">U+</code> pour indiquer que c’est un code unicode : <a href="https://unicode-table.com/fr/00E9/">U+00E9</a> correspond ainsi à ‘é’ et au nombre décimal 233.</p>

<p>On utilise la méthode <a href="https://developer.mozilla.org/fr/docs/Web/JavaScript/Reference/Global_Objects/String/charCodeAt"><code class="language-plaintext highlighter-rouge">charCodeAt</code></a>.</p>

<p>On va commencer par faire des petits tests en js pour voir comment on peut résoudre notre tâche (trouver les bonnes méthodes à utiliser), puis un codera la fonction proprement dite.</p>

<p>On peut faire les tests dans un interpréteur node s’ils sont tout petit (on peut utiliser le node dans un terminal vscode par exemple), ou bien exécuter un programme de test, le fichier <em>“mes_tests.js”</em> est là pour ça.</p>

<p>On va préférer ici la première option. Ouvrez un terminal (dans vscode par exemple) :</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">fbrucker</span><span class="p">@</span><span class="nd">emma</span> <span class="nx">cours</span><span class="o">/</span><span class="nx">numerologie</span><span class="o">-</span><span class="nx">niveau</span><span class="o">-</span><span class="mi">1</span> <span class="err">»</span> <span class="nx">node</span>             
<span class="nx">Welcome</span> <span class="nx">to</span> <span class="nx">Node</span><span class="p">.</span><span class="nx">js</span> <span class="nx">v16</span><span class="p">.</span><span class="mf">9.0</span><span class="p">.</span>
<span class="nx">Type</span> <span class="dl">"</span><span class="s2">.help</span><span class="dl">"</span> <span class="k">for</span> <span class="nx">more</span> <span class="nx">information</span><span class="p">.</span>
<span class="o">&gt;</span> <span class="p">(</span><span class="dl">'</span><span class="s1">coucou</span><span class="dl">'</span><span class="p">).</span><span class="nx">charCodeAt</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="mi">111</span>
<span class="o">&gt;</span> <span class="p">(</span><span class="dl">'</span><span class="s1">你好</span><span class="dl">'</span><span class="p">).</span><span class="nx">charCodeAt</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="mi">20320</span>
</code></pre></div></div>

<p>Le programme ci-dessus cherche le code unicode de ‘o’ et de ‘你’. Est-ce correct ?</p>

<p>Pour cela il faut encore convertir notre nombre décimal en nombre <a href="https://fr.wikipedia.org/wiki/Syst%C3%A8me_hexad%C3%A9cimal">hexadécmal</a>.</p>

<blockquote class="note">
  <p>Testez la fonction <a href="https://developer.mozilla.org/fr/docs/Web/JavaScript/Reference/Global_Objects/parseInt"><code class="language-plaintext highlighter-rouge">parseInt</code></a> pour convertir une chaine de caractères en nombre (<code class="language-plaintext highlighter-rouge">parseInt("4F60", 16)</code> par exemple) et la méthode des nombres <a href="https://developer.mozilla.org/fr/docs/Web/JavaScript/Reference/Global_Objects/Number/toString"><code class="language-plaintext highlighter-rouge">toString</code></a> qui fait le contraire (<code class="language-plaintext highlighter-rouge">(20320).toString(16)</code> par exemple).</p>
</blockquote>

<h2 id="tache-2">Tâche 2 : nombre associé à une chaine de caractères</h2>

<h3 id="code-js-de-nombrechaine">code js de <code class="language-plaintext highlighter-rouge">nombre(chaine)</code></h3>

<p>Fort de nos expérimentations, on peut maintenant écrire un fichier <em>“numerologie/numerologie.js”</em> qui va rendre la somme de tous les code unicode de ses caractères le constituant.</p>

<blockquote>
  <p>Je jette ici un voile pudique sur ce qu’est un “caractère” dans une chaine unicode. Cela peut vite être <a href="https://fr.wikipedia.org/wiki/%C3%89quivalence_Unicode">très compliqué</a>.</p>
</blockquote>

<p>Fichier <em>“numerologie/numerologie.js”</em> :</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">function</span> <span class="nx">nombre</span><span class="p">(</span><span class="nx">chaine</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">somme</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">chaine</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">somme</span> <span class="o">+=</span> <span class="nx">chaine</span><span class="p">.</span><span class="nx">charCodeAt</span><span class="p">(</span><span class="nx">i</span><span class="p">)</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nx">somme</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="test-js-de-nombrechaine">test js de <code class="language-plaintext highlighter-rouge">nombre(chaine)</code></h3>

<p>Pour l’instant, on va tester cette fonction <em>à la sauvage</em>, c’est à dire en ajoutant du code à la fin de <em>“numerologie.js”</em> et en affichant le résultat à l’écran grâce à la fonction <a href="https://nodejs.org/api/console.html#console_console_log_data_args"><code class="language-plaintext highlighter-rouge">console.log</code></a>.</p>

<p>On peut alors ajouter le code suivant (que l’on commentera pour le conserver) à la fin de  <em>“numerologie/numerologie.js”</em>:</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// test de nombre(chaine)</span>

<span class="c1">// est-ce 2x plus ?</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">nombre</span><span class="p">(</span><span class="dl">"</span><span class="s2">cou</span><span class="dl">"</span><span class="p">))</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">nombre</span><span class="p">(</span><span class="dl">"</span><span class="s2">coucou</span><span class="dl">"</span><span class="p">))</span>

<span class="c1">// chaque caractère :la somme est-elle correcte ?</span>
<span class="k">for</span> <span class="p">(</span><span class="nx">c</span> <span class="k">of</span> <span class="dl">"</span><span class="s2">cou</span><span class="dl">"</span><span class="p">)</span> <span class="p">{</span> 
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">c</span> <span class="o">+</span> <span class="dl">"</span><span class="s2"> : </span><span class="dl">"</span> <span class="o">+</span> <span class="nx">nombre</span><span class="p">(</span><span class="nx">c</span><span class="p">))</span>
<span class="p">}</span>
<span class="c1">// fin de test de nombre(chaine)</span>
</code></pre></div></div>

<p>Les commentaires en javascript se font en mettant des <code class="language-plaintext highlighter-rouge">//</code> : le reste la ligne n’est pas évaluée. C’est tellement pratique qu’il y a des raccourcis pour cela en vscode : <em>menu Edition &gt; Afficher/masquer les commentaires de lignes</em>.</p>

<blockquote>
  <p>Pour trouver ce raccourci, je suis allé dans la palette de commande et j’ai tapé <em>comment</em> pour voir mes possibilités.</p>
</blockquote>

<p>Il existe en javascript <a href="https://www.w3schools.com/js/js_comments.asp">deux façons de commenter du code</a>, le commentaire de bloc et le commentaire de lignes. Je préfère toutjours utiliser le commentaire de ligne car c’est d’une part plus visible (chaque leique est commentée) et on peut plus facilement dé-commenter un bout du commentaire. Comme en plus c’est faisable avec un unique raccourci clavier, c’est efficace.</p>

<blockquote>
  <p>Plutôt qu’utiliser la <a href="https://www.w3schools.com/js/js_loop_for.asp">façon standard de faire des boucles en javascript</a> qui me rappelle trop le C et que j’ai envie d’oublier, j’ai utilisé <a href="https://www.w3schools.com/js/js_loop_forof.asp">une façon de faire des boucle qui ressemble au python</a> que je préfère.</p>
</blockquote>

<h2 id="tache-3">Tâche 3 : somme des chiffres d’un nombre</h2>

<p>Maintenant qu’on a un nombre associé à une chaine de caractère, il nous reste à réduire ce nombre à un chiffre. Plusieurs méthodes sont possibles. On va choisir ici de sommer les chiffres du nombre.</p>

<p>Pour faire ça, expérience prouve que les élèves choisissent (presque) toujours la méthode la plus compliquée en se la jouant matheuse :  diviser le nombre par 10 autant de fois que nécessaire et en prenant les parties entières.</p>

<p>Nous allons plutôt faire de la magie avec les conversions de types.</p>

<blockquote>
  <p>Cette somme n’est peut-être pas un chiffre, on règlera ce problème dans la partie suivante.</p>
</blockquote>

<h3 id="code-js-de-sommenombre">code js de <code class="language-plaintext highlighter-rouge">somme(nombre)</code></h3>

<p>Ajouter le code ci-après après la déclaration de la fonction <code class="language-plaintext highlighter-rouge">nombre(chaine)</code> <em>“numerologie/numerologie.js”</em> :</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// ...</span>

<span class="kd">function</span> <span class="nx">somme</span><span class="p">(</span><span class="nx">nombre</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">somme</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="nx">chaine</span> <span class="o">=</span> <span class="nb">String</span><span class="p">(</span><span class="nx">nombre</span><span class="p">)</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">chaine</span><span class="p">.</span><span class="nx">length</span> <span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">somme</span> <span class="o">+=</span> <span class="nb">parseInt</span><span class="p">(</span><span class="nx">chaine</span><span class="p">.</span><span class="nx">charAt</span><span class="p">(</span><span class="nx">i</span><span class="p">))</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nx">somme</span>
<span class="p">}</span>

<span class="c1">// ...</span>
</code></pre></div></div>

<blockquote>
  <p>On a coutume de mettre des <code class="language-plaintext highlighter-rouge">// ...</code> pour dire que le reste du code du fichier n’est pas changé. Ce n’est pas la peine de les copier/coller.</p>
</blockquote>

<h3 id="test-de-sommenombre">test de <code class="language-plaintext highlighter-rouge">somme(nombre)</code></h3>

<blockquote class="note">
  <p>Comment marche le code de <code class="language-plaintext highlighter-rouge">somme(nombre)</code> ?</p>
</blockquote>

<p>Plutôt que de réfléchir des heures pour tenter de comprendre, rien de tel qu’utiliser le code pour voir. Ca va bien plus vite et au moins on est sur du résultat.</p>

<p>Pour l’instant, on va utiliser ce code <em>à la sauvage</em>, c’est à dire en ajoutant du code à la fin de <em>“numerologie.js”</em> et en affichant le résultat à l’écran grâce à la fonction <a href="https://nodejs.org/api/console.html#console_console_log_data_args"><code class="language-plaintext highlighter-rouge">console.log</code></a>.</p>

<p>On peut alors ajouter le code suivant (qu’on enlèvera ensuite ou que l’on commentera pour le conserver) à la fin de <em>“numerologie/numerologie.js”</em> :</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// ...</span>

<span class="c1">// test de somme(nombre)</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">somme</span><span class="p">(</span><span class="mi">132</span><span class="p">))</span>

<span class="c1">// avec un chiffre : charAt != charCodeAt</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">somme</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">4</span><span class="dl">"</span><span class="p">.</span><span class="nx">charCodeAt</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">4</span><span class="dl">"</span><span class="p">.</span><span class="nx">charAt</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>

<span class="c1">// conversion chaine de caracteres et nombre</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">typeof</span> <span class="dl">"</span><span class="s2">4</span><span class="dl">"</span><span class="p">.</span><span class="nx">charAt</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nb">parseInt</span><span class="p">(</span><span class="dl">"</span><span class="s2">4</span><span class="dl">"</span><span class="p">.</span><span class="nx">charAt</span><span class="p">(</span><span class="mi">0</span><span class="p">)))</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">typeof</span> <span class="nb">parseInt</span><span class="p">(</span><span class="dl">"</span><span class="s2">4</span><span class="dl">"</span><span class="p">.</span><span class="nx">charAt</span><span class="p">(</span><span class="mi">0</span><span class="p">)))</span>
<span class="c1">// fin de test de somme(nombre)</span>
</code></pre></div></div>

<h2 id="tache-4">Tâche 4 : somme itérative</h2>

<p>Si la somme des chiffre d’un nombre n’est pas un nombre, il faut recommencer l’opération jusqu’à obtenir un chiffre (la convergence est assurée car la somme des chiffre n’un nombre est strictement plus petite que lui s’il n’est pas lui même un chiffre).</p>

<h3 id="code-js-de-chiffreassociechaine">code js de <code class="language-plaintext highlighter-rouge">chiffreAssocie(chaine)</code></h3>

<p>Dans le fichier <em>“numerologie/numerologie.js”</em>, on ajoute la fonction <code class="language-plaintext highlighter-rouge">chiffreAssocie(chaine)</code> :</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// ...</span>

<span class="kd">function</span> <span class="nx">chiffreAssocie</span><span class="p">(</span><span class="nx">chaine</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">valeur</span> <span class="o">=</span> <span class="nx">nombre</span><span class="p">(</span><span class="nx">chaine</span><span class="p">)</span>

    <span class="k">while</span> <span class="p">(</span><span class="nx">valeur</span> <span class="o">&gt;</span> <span class="mi">9</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">valeur</span> <span class="o">=</span> <span class="nx">somme</span><span class="p">(</span><span class="nx">valeur</span><span class="p">)</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nx">valeur</span>
<span class="p">}</span>

<span class="c1">// ...</span>
</code></pre></div></div>

<h3 id="test-js-de-chiffreassociechaine">test js de <code class="language-plaintext highlighter-rouge">chiffreAssocie(chaine)</code></h3>

<p>On peut alors ajouter le code suivant (qu’on enlèvera ensuite ou que l’on commentera pour le conserver) dans <em>“numerologie/numerologie.js”</em> :</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// test de chiffreAssocie(chaine)</span>

<span class="c1">//test valeur somme des chiffres</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">nombre</span><span class="p">(</span><span class="dl">"</span><span class="s2">coucou</span><span class="dl">"</span><span class="p">))</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">chiffreAssocie</span><span class="p">(</span><span class="dl">"</span><span class="s2">coucou</span><span class="dl">"</span><span class="p">))</span>
<span class="c1">// fin de test de chiffreAssocie(chaine)</span>
</code></pre></div></div>

  </div>

</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/cours_informatique/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">cours d&#39;informatique</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">cours d&#39;informatique</li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/FrancoisBrucker"><svg class="svg-icon"><use xlink:href="/cours_informatique/assets/minima-social-icons.svg#github"></use></svg> <span class="username">FrancoisBrucker</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>Support de cours/td d&#39;informatique à l&#39;école centrale marseille.</p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
