---
layout: layout/post.njk

title: Système d'exploitation Linux

eleventyComputed:
  eleventyNavigation:
    key: "{{ page.url }}"
    title: "{{ title | safe }}"
    parent: "{{ '../' | siteUrl(page.url) }}"
---

> TBD séparer entre ce qui est la base et ce qui est Linux.
> TBD : parler du role et donc des problèmes de :
> 
> 
>  * multi process
>  * sécruité
>  * matériel
> hiérarchie des dossiers d'une distribution linux
> dossier spéciaux : /proc, /dev <https://linuxjourney.com/lesson/udev> (remplacé par devd)
> TBD : système d'exploitation et distribution linux
> TBD parler des file system : FAT, ext, zfs. ... read on write.
> protection ring avec linux : <https://www.youtube.com/watch?v=BGA019kHhwU>
> noyau : exécuté que par des interruptions.
> scheduling, driver
> le reste de l'OS est en user mode.

## Boot

<https://wiki.archlinux.org/title/Arch_boot_process>

[Ubntu boot](https://doc.ubuntu-fr.org/efibootmgr)

```
$ efibootmgr -v
BootCurrent: 0006
Timeout: 0 seconds
BootOrder: 0006,0002,0001,0004,0005,0000,0003
Boot0000* UiApp	FvVol(45801e53-5502-4463-929a-9bafaf424a72)/FvFile(462caa21-7614-4503-836e-8ab6f4662331)
Boot0001* UEFI Virtual DVD-ROM 	VenHw(0d51905b-b77e-452a-a2c0-eca0cc8d514a,000014020000000000)/Sata(1,65535,0)N.....YM....R,Y.
Boot0002* UEFI Ubuntu Linux-0 SSD NXHA6X9YF73M107S1H1G	VenHw(0d51905b-b77e-452a-a2c0-eca0cc8d514a,000014020000000000)/Sata(0,65535,0)N.....YM....R,Y.
Boot0003* UEFI PXEv4 (MAC:001C42D9009F)	PciRoot(0x0)/Pci(0x5,0x0)/MAC(001c42d9009f,1)N.....YM....R,Y.
Boot0004* No OS found	FvVol(45801e53-5502-4463-929a-9bafaf424a72)/FvFile(343e8cc7-cbc7-4d2f-af94-e783b827053b)
Boot0005* UEFI Shell	FvVol(45801e53-5502-4463-929a-9bafaf424a72)/FvFile(7c04a583-9e3e-4f1c-ad65-e05268d0b4d1)
Boot0006* ubuntu	HD(1,GPT,bd044e84-32c0-428f-8e3a-f5f464891a18,0x800,0x100000)/File(\EFI\ubuntu\grubaa64.efi)
```

1. EFI
2. [grub2](https://fr.wikipedia.org/wiki/GNU_GRUB)
3. [noyau](https://en.wikipedia.org/wiki/Vmlinux) (kernel space) `/boot/vmlinuz`
   1. cpu inspection
   2. mémoire inspection
   3. devices discovrey
   4. sous-systèmes : réseau, ...
4. root filesystem mount
5. [systemd](https://wiki.archlinux.org/title/Systemd) (user space) `systemctl list-units`, `journaltcl`
6. login

## Noyau

doit être tout petit. Si ça casse là, tout est cassé.
Le plus de choses possible doivent être lancé en user mode.

### Mémoire

* de 0 à $2^48-1$ : user space
* de $2^48$ à $2^64 -1$ : kernel space

pile et tas.

### disque dur

file system.
fat, ext, zfs (read on write)

cache fichiers (flush)

tout est fichier.
swap

### rôle

Met à disposition :

* les différents matériel :clavier, souris, carte réseau, disques dur, etc
* les fichiers : ouverture, exécution
* la mémoire : accès et allocation mémoire

Ordonne les différents [processus](https://fr.wikipedia.org/wiki/Processus_(informatique)) lancés.

<https://linux.goffinet.org/administration/processus-et-demarrage/processus-linux/>

### devices

dev monte et démonte de façon dynamique les devices (démon devd de systemd le montrer)

<https://linuxjourney.com/lesson/dev-directory>

* `/dev` : utilise les devices
* `/sys` : manage les devices

### ordonnancement

à chaque instant un unique process en route. Tous les x cycles, le noyau est rappelé par le cpu. Le noyau choisi un autre process à exécuter

[context switching](https://fr.wikipedia.org/wiki/Commutation_de_contexte)g.

## Configuration

`/etc`

`/ec/fstab`

> hiérarchies des répertoires

## Utilisateurs

`cat /etc/passwd`

L'administrateur est `root`.

et des groups (`groups`) (ex groupe des gens qui peuvent utiliser sudo)

<https://doc.ubuntu-fr.org/permissions>


Droits lire/écrire/exécuter

## Process

utilisation, qui

context switching.

## tbd

proc dev

`sudo apt install htop`

htop et tree pour voir les process
<https://unix.stackexchange.com/questions/6301/how-do-i-read-from-proc-pid-mem-under-linux>

## démon et interfaces

<https://wiki.archlinux.org/title/Systemd>
<https://en.wikipedia.org/wiki/Systemd>

## cache

<https://www.baeldung.com/linux/check-cache-size-l1-l2-l3>

## process layout

<https://simonis.github.io/Memory/>
<https://xerocrypt.github.io/articles/linux-process-analysis.html>
<https://unix.stackexchange.com/questions/113585/how-to-find-the-page-size-associativity-and-tlb-size-and-number-of-entries>
`sudo apt-get install cpuid` (pour x86)

## appels systèmes

strace : <https://www.youtube.com/playlist?list=PLn6POgpklwWq1YUQsMHzddjoiwJzPiqcf>


## process info

<https://linux-kernel-labs.github.io/refs/heads/master/so2/lec3-processes.html>

`ps -ef` pour voir les thread du kernel (entre crochet)

fork/clone : avec strace : <https://www.youtube.com/watch?v=uRYyj8tcDTE&list=PLhy9gU5W1fvUND_5mdpbNVHC1WCIaABbP&index=17>

## signaux

<https://www.tutorialspoint.com/unix/unix-signals-traps.htm>
`kill -l`


groupes de signaux ex de chris le pipe. (`yes | rm *`) un ctrl+c va tuer les deux process et pas que un suel.
chaque process ne peut appartenir qu1a un groupe. `setpgid`

<http://books.gigatux.nl/mirror/kerneldevelopment/0672327201/ch14lev1sec2.html>
<https://elinux.org/images/b/b0/Introduction_to_Memory_Management_in_Linux.pdf>

<https://gist.github.com/CMCDragonkai/10ab53654b2aa6ce55c11cfc5b2432a4>

keynel layout :

<https://www.kernel.org/doc/html/v6.5/arch/arm64/memory.html>
<https://www.kernel.org/doc/html/v6.5/arch/index.html>

readelf : <https://stackoverflow.com/questions/50653102/analyzing-elf-memory-layout>
<https://simonis.github.io/Memory/>
<https://lwn.net/Articles/631631/>

<https://gitlab.com/x86-psABIs/x86-64-ABI>
<https://stackoverflow.com/questions/60984268/virtual-address-of-process-in-linux64-x86-64-machine>

<https://0xax.gitbooks.io/linux-insides/content/Timers/linux-timers-6.html>

fork et cow :<https://www.youtube.com/watch?v=ViUwLytKzTY>
